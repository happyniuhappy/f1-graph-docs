(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{1240:function(t,e,n){},1245:function(t,e,n){"use strict";n(703)},1254:function(t,e,n){"use strict";n(709)},1256:function(t,e,n){"use strict";n(710)},1257:function(t,e,n){"use strict";n(711)},1258:function(t,e,n){"use strict";n(712)},1260:function(t,e,n){"use strict";n(713)},1263:function(t,e,n){"use strict";n(714)},1271:function(t,e,n){"use strict";n(715)},1278:function(t,e,n){"use strict";n(717)},1279:function(t,e,n){"use strict";n(718)},1281:function(t,e,n){"use strict";n(719)},1283:function(t,e,n){"use strict";n(720)},1284:function(t,e,n){"use strict";n(721)},1302:function(t,e,n){"use strict";n.r(e),n.d(e,"OLMap",(function(){return zt})),n.d(e,"OLTileLayer",(function(){return le})),n.d(e,"GoogleTileLayer",(function(){return Kt})),n.d(e,"AMapTileLayer",(function(){return Qt})),n.d(e,"BMapTileLayer",(function(){return se})),n.d(e,"OLVectorLayer",(function(){return ve})),n.d(e,"OLHeatmapLayer",(function(){return _e})),n.d(e,"OLVectorSource",(function(){return Pe})),n.d(e,"OLGeoJsonSource",(function(){return Fe})),n.d(e,"OLFeature",(function(){return $e})),n.d(e,"OLSearchFeature",(function(){return dn})),n.d(e,"OLButton",(function(){return gn})),n.d(e,"OLTextButton",(function(){return vn})),n.d(e,"OLToggle",(function(){return wn})),n.d(e,"OLToggleSnap",(function(){return Ln})),n.d(e,"OLBar",(function(){return kn})),n.d(e,"OLLayerSwitcher",(function(){return An})),n.d(e,"OLLegend",(function(){return Pn})),n.d(e,"OLLegendItem",(function(){return Dn})),n.d(e,"OLOverview",(function(){return zn})),n.d(e,"OLOverlay",(function(){return Rn})),n.d(e,"OLBarUndoRedo",(function(){return or})),n.d(e,"OLToggleFillAttribute",(function(){return lr})),n.d(e,"OLButtonSave",(function(){return ur})),n.d(e,"OLButtonExport",(function(){return vr})),n.d(e,"OLButtonStartOrStopEdit",(function(){return Cr})),n.d(e,"OLButtonImport",(function(){return Ir})),n.d(e,"OLButtonCreateLayer",(function(){return Br})),n.d(e,"OLButtonOpenLayers",(function(){return Zr})),n.d(e,"OLZoomLevel",(function(){return Jr})),n.d(e,"OLContextMenu",(function(){return Xr})),n.d(e,"OLStencil",(function(){return Qr})),n.d(e,"OLButtonZoomEdit",(function(){return aa})),n.d(e,"OLTopoAnaly",(function(){return sa})),n.d(e,"OLSelect",(function(){return Xn})),n.d(e,"OLMeasure",(function(){return ti})),n.d(e,"OLDraw",(function(){return vi})),n.d(e,"OLModify",(function(){return _i})),n.d(e,"OLTranslate",(function(){return Li})),n.d(e,"OLSnap",(function(){return Ci})),n.d(e,"OLOffset",(function(){return Ti})),n.d(e,"OLTransform",(function(){return Fi})),n.d(e,"OLCopyPaste",(function(){return Di})),n.d(e,"OLFocusMap",(function(){return zi})),n.d(e,"OLDistanceSearch",(function(){return Yi})),n.d(e,"OLUndoRedo",(function(){return qi})),n.d(e,"OLFillAttribute",(function(){return er})),n.d(e,"OLDelete",(function(){return rr})),n.d(e,"OLPopup",(function(){return pa})),n.d(e,"OLPopupFeature",(function(){return fa})),n.d(e,"OLPlacemark",(function(){return ya})),n.d(e,"OLMapShowView",(function(){return va})),n.d(e,"OLMapEditView",(function(){return Ta})),n.d(e,"OLReadFile",(function(){return tn})),n.d(e,"FontSymbol",(function(){return bt})),n.d(e,"SvgSymbol",(function(){return gt})),n.d(e,"Read",(function(){return Ke})),n.d(e,"svg2base64",(function(){return y})),n.d(e,"GeoJSON2Svg",(function(){return ln}));n(117),n(119),n(118);var i=n(401),r=(n(52),n(409),n(592)),a=n(594),o=n(1243),s=n(1244),l=n(1299),c=n(1300),u=n(1301),p=n(440),h=n(416),d=n(1242),f=n(1288);f.a.defs("EPSG:4490","+proj=longlat +ellps=GRS80 +no_defs"),f.a.defs("EPSG:4544","+proj=tmerc +lat_0=0 +lon_0=105 +k=1 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"),f.a.defs("EPSG:4507","+proj=tmerc +lat_0=0 +lon_0=105 +k=1 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs");var m=f.a,g=(n(475),n(138),n(120),n(36),n(33),n(81),n(214),n(730)),y=function(t,e){e=e||{};var n=document.createElement("canvas"),i=n.getContext("2d");return e.width&&n.setAttribute("width",e.width+""),e.height&&n.setAttribute("height",e.width),g.a.fromString(i,t).start(),n.toDataURL()},b=function(t,e){if(e=e||"ConfigurationEditor",t&&t.$options.componentName===e)return t;for(var n=t.$parent,i=n.$options.componentName;n&&(!i||i!==e);)(n=n.$parent)&&(i=n.$options.componentName);return n},O=function(t,e,n){for(var i,r=Array.isArray(e)?e:e.split(n||"/"),a=0,o=r.length;a<o;){if(i=r[a++],Object(t)!==t||!(i in t))return;t=t[i]}return t},w=function(t,e,n,i){for(var r=Array.isArray(e)?e:e.split(i||"/"),a=t,o=0,s=r.length;o<s-1;o++)a=a[r[o]]||(a[r[o]]={});return a[r[s-1]]=n,t},x=function(t){var e=/<%= ([^ ]+) %>|\$\{ ?([^{} ]+) ?\}|\{\{([^{} ]+)\}\}/g;return function(n){return n=n||{},t.replace(e,(function(t){for(var e=Array.from(arguments),i=e.slice(1,4).find((function(t){return!!t})),r=i.split("."),a=n[r.shift()];void 0!==a&&r.length;)a=a[r.shift()];return void 0!==a?a:""}))}},S=(n(51),n(57),n(137),n(12),n(549),n(212),Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}()),L=function(t,e,n,i){var r=function(i){var r,a="set"+((r=i)&&"function"==typeof r.charAt?r.charAt(0).toUpperCase()+r.slice(1):r),o=n[i].type===Object||n[i].type===Array||Array.isArray(n[i].type);n[i].custom&&t[a]?t.$watch(i,(function(e,n){t[a](e,n)}),{deep:o}):"setOptions"===a?t.$watch(i,(function(t,e){!function(t,e){for(var n in t.hasOwnProperty("options")||(t.options=t.options?S(t.options):{}),e)t.options[n]=e[n];t.options}(leafletElement,t)}),{deep:o}):e[a]&&t.$watch(i,(function(t,n){e[a](t)}),{deep:o})};for(var a in n)r(a)},j=function(t){var e={};for(var n in t){var i=t[n];null!=i&&(e[n]=i)}return e},C=function(t,e){var n=e.options&&e.options.constructor===Object?e.options:{};t=t&&t.constructor===Object?t:{};var i=j(n);t=j(t);var r=e.$options.props;for(var a in t){var o=r[a]?r[a].default:Symbol("unique");i[a]&&o!==t[a]?(console.warn("".concat(a," props is overriding the value passed in the options props")),i[a]=t[a]):i[a]||(i[a]=t[a])}return i},k=function(t){for(var e=!1;t&&!e;)void 0===t.mapObject?t=t.$parent:e=!0;return t},I=function(t,e){Object.keys(e).forEach((function(n){t.on&&t.on(n,e[n])}))},M=function(t,e){var n=6378245,i=.006693421622965943;if(F(t,e))return t,e,[t,e];var r=A(t-105,e-35),a=E(t-105,e-35),o=e/180*Math.PI,s=Math.sin(o);s=1-i*s*s;var l=Math.sqrt(s);return r=180*r/(n*(1-i)/(s*l)*Math.PI),[t+(a=180*a/(n/l*Math.cos(o)*Math.PI)),e+r]},T=function(t,e){if(F(t,e))return[t,e];var n=6378245,i=.006693421622965943,r=A(t-105,e-35),a=E(t-105,e-35),o=e/180*Math.PI,s=Math.sin(o);s=1-i*s*s;var l=Math.sqrt(s);return r=180*r/(n*(1-i)/(s*l)*Math.PI),[2*t-(t+(a=180*a/(n/l*Math.cos(o)*Math.PI))),2*e-(e+r)]},A=function(t,e){var n=2*t-100+3*e+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));return n+=2*(20*Math.sin(6*t*Math.PI)+20*Math.sin(2*t*Math.PI))/3,n+=2*(20*Math.sin(e*Math.PI)+40*Math.sin(e/3*Math.PI))/3,n+=2*(160*Math.sin(e/12*Math.PI)+320*Math.sin(e*Math.PI/30))/3},E=function(t,e){var n=300+t+2*e+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));return n+=2*(20*Math.sin(6*t*Math.PI)+20*Math.sin(2*t*Math.PI))/3,n+=2*(20*Math.sin(t*Math.PI)+40*Math.sin(t/3*Math.PI))/3,n+=2*(150*Math.sin(t/12*Math.PI)+300*Math.sin(t/30*Math.PI))/3},F=function(t,e){return t<72.004||t>137.8347||(e<.8293||e>55.8271)},P=(Math.PI,n(24),n(514),n(410),n(508)),B=n(731),D=n(427),$=n(425),N=n(432),z=n(533),G=(n(121),n(670),n(123),n(80),n(509),n(124),n(490),n(671),n(56)),Z=(n(122),n(53)),R=n(1211),V=n.n(R),W=n(1228),H=n.n(W);n(79);V.a.interceptors.request.use((function(t){return t}),(function(t){return Promise.reject(t)})),V.a.interceptors.response.use((function(t){return t}),(function(t){return Promise.reject(t)}));var U={get:function(t,e){return e=J(e),V()({method:"get",url:this.getRoot()+t+"?"+H.a.stringify(e)})},post:function(t,e,n){return e=J(e),n=n||{},V()({method:"post",headers:n,url:this.getRoot()+t,data:H.a.stringify(e)})}};U.postAsync=function(){var t=Object(Z.a)(regeneratorRuntime.mark((function t(e,n,i){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=J(n),i=i||{},t.next=4,V()({method:"post",url:this.getRoot()+e,headers:i,data:H.a.stringify(n)});case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t,this)})));return function(e,n,i){return t.apply(this,arguments)}}(),U.nativeFormRequest=function(t,e){t=this.getRoot()+t,e=J(e);var n=document.createElement("form");if(n.setAttribute("style","display:none"),n.setAttribute("target","_blank"),n.setAttribute("method","post"),n.setAttribute("action",t),Array.isArray(e))for(var i=0;i<e.length;i++){var r=document.createElement("input");r.setAttribute("type","hidden"),r.setAttribute("name",e[i].name),r.setAttribute("value",e[i].value),n.appendChild(r)}else Object.keys(e).forEach((function(t){var i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name",t),i.setAttribute("value",e[t]),n.appendChild(i)}));document.body.append(n),n.submit(),n.remove()},U.getRoot=function(){var t,e;t=new RegExp("(^|&)"+"debug"+"=([^&]*)(&|$)"),null!=(e=window.location.search.substr(1).match(t))&&decodeURI(e[2]),"object"==("undefined"==typeof self?"undefined":Object(G.a)(self))&&self.self===self&&self||"object"==("undefined"==typeof global?"undefined":Object(G.a)(global))&&global.global===global&&global;return window.location.protocol+"//"+window.location.host+"/zuul/giscore/"};var J=function(t){if(t&&t.MenuID||((t=t||{}).MenuID="0000"),!t||!t.nonce){t=t||{};var e=(new Date).valueOf();t.nonce=Math.random().toString(36).slice(-6)+""+e}return t},Y=U,X=function(t){return Y.post("joint/graph/load.do",t)},K=function(t){return Y.post("joint/graph/save.do",t)},q=function(t,e){var n={sql:"select LayerID from us_gis.tb_gis_layer where LayerName='".concat(t,"'")};e=e||{};var i=Object.assign(n,e);return Y.post("joint/graph/getCount.do",i)},Q=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Y.post("layer/getLayers.do",t)},tt=function(){return Y.get("symbol/getSymbolsDefine.do")},et=function(t){return Y.get("symbol/getSymbolsConfig.do",t)},nt=n(447),it=n(521),rt=n(487),at=n(488),ot=n(1235),st=n(729),lt=n(574),ct=n(442),ut=n(516),pt=(n(518),n(213),n(406)),ht=n(424),dt=n(517),ft=function(t){this.originSize_=t.originSize||this.getOriginSize()||[30,30];var e=t.size||{width:this.originSize_,height:this.originSize_};this.stroke_=t.stroke,this.fill_=t.fill,this.symbolType_=t.symbolType,this.svg_=this.getSvgContent(t.symbolType)||t.svg||"",this.silent_=t.silent;var n=this.silent_?this.defs[this.symbolType_].canvas:this.svg2canvas_(e,t.height);if(!0===this.silent_){var i=Object(ht.a)(e.width,e.height);i.drawImage(n,0,0,e.width,e.height),n=i.canvas}st.a.call(this,{img:n,imgSize:[e.width,e.height],rotation:t.rotation||0})};Object(pt.d)(ft,st.a),ft.prototype.defs={defaultSymbol:{originSize:[10,10],svg:'<g><circle r="5" cx="5" cy="5" fill-opacity="0.5"/></g>',canvas:null}},ft.prototype.getSvgContent=function(t){return(t=t||this.symbolType_)?(ft.prototype.defs[t]||{}).svg:this.symbolType_},ft.prototype.getOriginSize=function(){return(ft.prototype.defs[this.symbolType_]||{}).originSize},ft.prototype.svg2canvas_=function(t,e,n,i,r){var a=Object(ht.a)(t.width,t.height),o=this.originSize_,s=t.width/(o[0]||1),l=t.height/(o[1]||1);return a.scale(s,l),this.stroke_&&(a.lineWidth=this.stroke_.getWidth(),a.strokeStyle=Object(dt.a)(this.stroke_.getColor())),this.fill_&&(a.fillStyle=Object(dt.a)(this.fill_.getColor())),g.a.fromString(a,this.svg_).start(),a.canvas},ft.prototype.portSelector="",ft.getPortSelector=function(){if(ft.prototype.portSelector)return ft.prototype.portSelector;for(var t=[],e=0;e<5;e++)t.push("circle[id='terminal_".concat(e,"']")),t.push("circle[class='terminal_".concat(e,"']"));return ft.prototype.portSelector=t.join(","),ft.prototype.portSelector},ft.addDefs=function(t){var e=this,n=null;void 0!==("undefined"==typeof DOMParser?"undefined":Object(G.a)(DOMParser))&&(n=new DOMParser);var i=new RegExp(/<svg[^>]*>([\s\S]*)<\/svg>/);if(Object.keys(t).forEach((function(r){var a=t[r].originSize&&t[r].originSize.length>=2?t[r].originSize:[30,30];!t[r].originSize&&(t[r].originSize=a);var o=t[r].svg.match(i);if(o&&o.length>=2&&(t[r].svg='<g stroke="param(outline)" fill-opacity="0">'.concat(o[1],'<rect x="0" y="0" width="').concat(a[0],'" height="').concat(a[1],'" fill="#FFFFFF" fill-opacity="0" stroke-opacity="0"/></g>')),n){var s=null;try{s=e.checkDocument(n.parseFromString(t[r].svg,"image/svg+xml"))}catch(i){s=e.checkDocument(n.parseFromString(t[r].svg,"text/xml"))}if(s){var l=[];s.querySelectorAll(ft.getPortSelector()).forEach((function(t){var e={group:"terminal_",args:{x:"",y:""}},n=t.getAttribute("id")||t.getAttribute("class");n&&(e.group=n,e.args.x=Number(t.getAttribute("cx"))/a[0]*100+"%",e.args.y=Number(t.getAttribute("cy"))/a[1]*100+"%",l.push(e))})),t[r].ports={items:l};var c=Object(ht.a)(t[r].originSize[0],t[r].originSize[1]);g.a.fromString(c,t[r].svg).start(),t[r].canvas=c.canvas}}})),Object.assign(ft.prototype.defs,t),!ft.prototype.defs.defaultSymbol.canvas){var r=ft.prototype.defs.defaultSymbol.originSize,a=Object(ht.a)(r[0],r[1]);g.a.fromString(a,ft.prototype.defs.defaultSymbol.svg).start(),ft.prototype.defs.defaultSymbol.canvas=a.canvas}},ft.checkDocument=function(t){var e=t.getElementsByTagName("parsererror")[0];if(e)throw new Error(e.textContent);return t},ft.getSymbolDef=function(t){return ft.prototype.defs[t]};var mt,gt=ft,yt=(n(1232),n(1233),n(1234),{"01010010":{char:"",type:"electricity.ShuiDianChang",name:"运行水电厂"},"01010011":{char:"",type:"electricity.GuiHuaShuiDianChang",name:"规划水电厂"},"01010020":{char:"",type:"electricity.HuoDianChang",name:"火电厂"},"01010021":{char:"",type:"electricity.GuiHuaHuoDianChang",name:"规划火电厂"},"01010030":{char:"",type:"FengLiFaDianZhan",name:"风力发电站"},"01010031":{char:"",type:"electricity.GuiHuaFengLiFaDianZhan",name:"规划风力发电站"},"01010040":{char:"",type:"electricity.ChouShuiXvNengChang",name:"抽水蓄能电厂"},"01010041":{char:"",type:"electricity.GuiHuaChouShuiXvNengChang",name:"规划抽水蓄能电厂"},"01010050":{char:"",type:"electricity.HeDianChang",name:"核电站"},"01010051":{char:"",type:"electricity.GuiHuaHeDianChang",name:"规划核电站"},"01010060":{char:""},"01010061":{char:""},"01010070":{char:""},"01010071":{char:""},"01010080":{char:""},"01010081":{char:""},"01010090":{char:""},"01010091":{char:""},"01010100":{char:""},"01010101":{char:""},"01010110":{char:""},"01010111":{char:""},"01010120":{char:""},"01020010":{char:"",type:"electricity.BianDianZhan",name:"变电站"},"01020011":{char:""},"01020020":{char:""},"01020030":{char:""},"01020031":{char:""},"01020040":{char:"",type:"electricity.HuanLiuZhan",name:"运行换流站"},"01020041":{char:""},"01020050":{char:""},"01020060":{char:""},"01020061":{char:""},"01030010":{char:"",type:"electricity.KaiGuanZhan",name:"开关站"},"01030020":{char:"",type:"electricity.PeiDianShi",name:"配电室"},"01030030":{char:""},"01030040":{char:""},"01030050":{char:"",type:"electricity.XiangShiBian",name:"箱式变"},"01030060":{char:"",type:"electricity.DianLanFenZhiXiang",name:"电缆分支箱"},"01030070":{char:"",type:"electricity.HuanWangGui",name:"环网柜"},"01030080":{char:"",type:"electricity.DiYaPeiDianXiang",name:"低压配电箱"},"01030090":{char:""},"01030100":{char:""},"01030110":{char:""},"01030120":{char:""},"01030130":{char:""},"01030140":{char:""},"01030150":{char:""},"02010010":{char:""},"02020010":{char:""},"02020020":{char:""},"02020030":{char:""},"02020040":{char:""},"02020050":{char:""},"02020060":{char:""},"02020070":{char:""},"02030020":{char:""},"02040011":{char:""},"02050010":{char:""},"02050011":{char:""},"02060010":{char:""},"02060011":{char:""},"02070010":{char:""},"02070011":{char:""},"02080010":{char:""},"02080011":{char:""},"02090010":{char:""},"02090011":{char:""},"02100010":{char:""},"02100011":{char:""},"02110010":{char:""},"02110011":{char:""},"02120010":{char:""},"02130010":{char:""},"02140010":{char:""},"02150010":{char:""},"02150011":{char:""},"02160010":{char:""},"02170010":{char:""},99010080:{char:"\f089"}});ut.a.addDefs({font:"icomoon",name:"icomoon",copyright:"zhbr txz",prefix:"electricity"},(mt={},Object.keys(yt).forEach((function(t){var e="icon-"+t;mt[e]={font:"icomoon",char:yt[t].char,name:yt[t].name||"none",GDWCode:t},yt[t].type&&(mt[yt[t].type]=mt[e])})),mt));var bt=ut.a,vt=function(t){var e=t.get("labels")||t.get("name"),n=[];if(!e)return null;if("string"==typeof e){var i=t.get("style");return new ot.a({overflow:!0,font:Ot(i),text:e||O(i,"text/text"),fill:new rt.a({color:O(i,"text/fill")||"#000000"}),stroke:new at.a({color:O(i,"text/stroke/color")||"rgb(255,0,0)",width:O(i,"text/stroke/width")||1}),placement:"line",offsetX:O(i,"text/offsetX")||1,offsetY:O(i,"text/offsetY")||1})}for(var r=0;r<e.length;r++){var a=20*r,o=20*r;O(e[r],"position/offset")&&(a=O(e[r],"position/offset/x"),o=O(e[r],"position/offset/y"));var s=e[r].attrs;if(s&&O(s,"text/text")){var l=O(s,"text/stroke")||"#FFFFFF",c=O(s,"text/stroke-width");void 0!==c&&null!=c||(c=3),0!=c&&"0"!=c||(l=null);var u=new ot.a({overflow:!0,font:Ot(i),text:O(s,"text/text"),fill:new rt.a({color:O(s,"text/fill")||"#000000"}),stroke:new at.a({color:l,width:c}),placement:"line",offsetX:a,offsetY:o});n.push(u)}}return n},Ot=function(t){var e="Bold 14px Arial";if(t&&O(t,"text/text")){var n=O(t,"text/font-size");n=n?(n+"").replace("px","")+"px":"14px";var i=O(t,"text/font-family");i||(i="Arial");var r="Bold";O(t,"text/font-weight")&&(r=O(t,"text/font-weight")),e=r+" "+n+" "+i}return e},wt=function(t,e,n,i){var r=[];return e.forEachSegment((function(e,i){var a=i[0]-e[0],o=i[1]-e[1],s=Math.atan2(o,a),l=(e[0],e[1],vt(t));if(l){Array.isArray(l)||(l=[l]);for(var c=0;c<l.length;c++){var u=l[c],p=new ct.a([e,i]).getLength();u&&p>=(t.get("labelShowLength")||200)*n&&(s=180*s/Math.PI>=-180&&180*s/Math.PI<=-90||180*s/Math.PI<=180&&180*s/Math.PI>=90?-s+1*Math.PI:-s,u.setRotation(s),r.push(new nt.c({geometry:new ct.a([e,i]),text:u})))}}})),r},_t=(n(1236),n(503)),xt=function(t,e){return(t=(e=e||!1)?t:t%360)*Math.PI/180},St=function(t,e,n){var i=[],r=(e=e||{})&&e.cableArrowDistance||17;r*=n;var a=t.getLength();if(a<3*r)return i;var o,s,l=t.getCoordinateAt(r/a),c=t.getCoordinateAt(1-r/a),u=[];if(t.forEachSegment((function(t,e){var n=[t[0],t[1]],i=[e[0],e[1]],r=e[0]-t[0],a=e[1]-t[1],o=Math.sqrt(r*r+a*a);u.push({p:n,p1:i,length:o})})),u.length<1)return i;for(var p=0,h=0;p<r;)p+=u[h].length,h++;for(o=u[(h=0==h?1:h)-1].p,p=0,h=0;p<a-r;)p+=u[h].length,h++;s=u[(h=0==h?1:h)-1].p1;var d=Math.atan2(l[1]-o[1],l[0]-o[0]),f=Math.atan2(c[1]-s[1],c[0]-s[0]),m=new nt.c({geometry:new _t.a([l]),image:new lt.a({fill:new rt.a({color:e.fillColor||e.fill||"#0000ff"}),stroke:new at.a({color:e.strokeColor||e.stroke||"#0000ff",width:e.strokeWidth||2}),points:3,radius:e.radius||4,rotateWithView:!0,rotation:-d,angle:xt(90)})}),g=new nt.c({geometry:new _t.a([c]),image:new lt.a({fill:new rt.a({color:e.fillColor||e.fill||"#0000ff"}),stroke:new at.a({color:e.strokeColor||e.stroke||"#0000ff",width:e.strokeWidth||2}),points:3,radius:e.radius||4,rotateWithView:!0,rotation:-f,angle:xt(90)})});return i.push(m),i.push(g),i},Lt=(n(689),n(431)),jt=new P.a({dataProjection:"EPSG:3857",featureProjection:"EPSG:3857"}),Ct=function(t,e){var n=e.getView();Array.isArray(t)||(t=[t]);for(var i=[],r=0;r<t.length;r++){var a=kt(t[r],n.getResolution());i=i.concat(a)}return i},kt=function(t,e,n,i,r){if("Point"!==(t instanceof N.a?t.getGeometry().getType():t.geometry.type))return[];var a={};if(t instanceof N.a)a=jt.writeFeatureObject(t);else if(a=JSON.parse(JSON.stringify(t)),n.mapComp&&n.mapComp.transformFn){var o=n.mapComp.transformFn(a.geometry.type,a.geometry.coordinates);a.geometry.coordinates=o,a.geometry.coordinates=Object(h.g)(o)}var s=[],l=a.geometry.coordinates,c=a.properties.ports,u=a.properties.id,p=a.properties.style||{},d=O(p,"image/svg-symbol/size")||a.properties.size;if(Array.isArray(d)&&(d={width:d[0],height:d[1]}),d||(d={width:30,height:30}),!c||c.items.length<=0){var f=new Lt.a(l.slice());return(b=new N.a({geometry:f})).setProperties({id:u}),b.setId(u),s.push(b),s}for(var m=l[0]-d.width*e/2,g=l[1]+d.height*e/2,y=0;y<c.items.length;y++){var b,v=c.items[y],w=m+parseFloat(v.args.x)/100*(d.width*e),_=g-parseFloat(v.args.y)/100*(d.height*e);f=new Lt.a([w,_]);(b=new N.a({geometry:f})).setProperties({id:u,port:v.id}),b.setId(v.id),s.push(b)}return s},It=function(t,e,n){var i=null;if(i=function(t,e,n){return{Point:new nt.c({image:new it.a({radius:5,fill:new rt.a({color:"select"===n.type?n.color||"blue":"#000"}),stroke:new at.a({color:"select"===n.type?n.color||"blue":"red",width:1})}),text:new ot.a({textAlign:"left",textBaseline:"middle",font:"bold 12px 宋体",text:"",fill:new rt.a({color:"#aa3300"}),stroke:new at.a({color:"#ffffff",width:2}),offsetX:10,offsetY:0,rotation:0})}),LineString:new nt.c({stroke:new at.a({color:"select"===n.type?n.color||"blue":"green",width:1}),text:new ot.a({textAlign:"middle",textBaseline:"middle",font:"bolder 12px 宋体",text:"",fill:new rt.a({color:"#000"}),stroke:new at.a({color:"#ffffff",width:2}),offsetX:10,offsetY:0,placement:"line",overflow:!0})}),Polygon:new nt.c({stroke:new at.a({color:"select"===n.type&&n.color||"blue",lineDash:[4],width:3}),fill:new rt.a({color:"select"===n.type?n.color||"blue":"rgba(0, 0, 255, 0.1)"}),text:new ot.a({textAlign:"middle",textBaseline:"middle",font:"normal 12px Arial",text:"",fill:new rt.a({color:"#aa3300"}),stroke:new at.a({color:"#ffffff",width:3}),offsetX:10,offsetY:0,rotation:0})}),Circle:new nt.c({stroke:new at.a({color:"red",width:2}),fill:new rt.a({color:"rgba(255,0,0,0.2)"})})}}(0,0,n)[t.getGeometry().getType()],t.get("name")){var r=i.getText();r&&r.setText(t.get("name")||"")}return i},Mt=function(t,e,n){var i=null;switch(t.getGeometry().getType()){case"Point":i=function(t,e,n){var i=t.get("minZoomLevel")||n.mapMinZoomLevel,r=t.get("maxZoomLevel")||n.mapMaxZoomLevel;if(!(n.zoomLevel>=i&&n.zoomLevel<=r))return null;var a=t.get("style");if(!a&&t.get("features")){var o=t.get("features")[0];o&&(a=o.get("style"),t=o)}if(!a)return It(t,0,n);var s=null,l=null,c=O(a,"image/font-symbol"),u=O(a,"image/svg-symbol"),p=O(a,"image/icon"),h=O(a,"image/font-symbol/radius")||15;if(c)l=new ut.a({form:O(a,"image/font-symbol/form")||"square",gradient:O(a,"image/font-symbol/gradient")||!1,glyph:O(a,"image/font-symbol/glyph")||t.get("type")||"",fontSize:O(a,"image/font-symbol/fontSize")||1,fontStyle:O(a,"image/font-symbol/fontStyle")||"bolder",radius:h,offsetX:O(a,"image/font-symbol/offsetX")||0,rotation:O(a,"image/font-symbol/rotation")*Math.PI/180||0,rotateWithView:O(a,"image/font-symbol/rotateWithView"),offsetY:O(a,"image/font-symbol/offsetY")||0,color:"select"===n.type?n.color||"blue":O(a,"image/font-symbol/color")||"#000",fill:new rt.a({color:O(a,"image/font-symbol/fill/color")||[255,136,0,0]}),stroke:new at.a({color:O(a,"image/font-symbol/stroke/color")||[0,0,0,0],width:O(a,"image/font-symbol/stroke/width")||2})});else if(p){var d=Object.assign({},a.image.icon||{});l=new st.a(d)}else if(u){var f=O(a,"image/svg-symbol/symbolType"),m=gt.getSymbolDef(f)||gt.getSymbolDef("defaultSymbol");l=new gt({symbolType:gt.getSymbolDef(f)?f:"defaultSymbol",size:O(a,"image/svg-symbol/size")||t.get("size")||{width:m.originSize[0],height:m.originSize[1]},svg:O(a,"image/svg-symbol/svg"),radius:O(a,"image/svg-symbol/radius"),offsetX:O(a,"image/svg-symbol/offsetX")||0,offsetY:O(a,"image/svg-symbol/offsetY")||0,rotation:O(a,"image/svg-symbol/rotation")*Math.PI/180||0,rotateWithView:O(a,"image/svg-symbol/rotateWithView"),fill:new rt.a({color:O(a,"image/svg-symbol/fill")||[0,0,0,0]}),stroke:new at.a({color:"select"===n.type?n.color||"blue":O(a,"image/svg-symbol/stroke/color")||[255,0,0,0],width:"select"===n.type?n.strokeWidth||3:O(a,"image/svg-symbol/stroke/width")||1}),silent:void 0!==O(a,"image/svg-symbol/silentSvg")?O(a,"image/svg-symbol/silentSvg"):n.silentSvg})}else O(a,"image/shape")?l=new lt.a({fill:new rt.a({color:"select"===n.type?n.color||"blue":O(a,"image/shape/fill")||O(a,"image/shape/fill/color")||"rgb(255,0,0)"}),stroke:new at.a({color:"select"===n.type?"blue":O(a,"image/shape/stroke/color")||"rgb(0,0,0)",width:"select"===n.type?4:O(a,"image/shape/stroke/width")||2}),points:O(a,"image/shape/points"),radius:O(a,"image/shape/radius")||15,radius1:O(a,"image/shape/radius1"),radius2:O(a,"image/shape/radius2"),rotation:O(a,"image/shape/rotation"),angle:O(a,"image/shape/angle")}):(h=O(a,"image/circle/radius")||5,l=new it.a({radius:h,fill:new rt.a({color:"select"===n.type?n.color||"blue":O(a,"image/circle/fill")||"#000"}),stroke:new at.a({color:"select"===n.type?"blue":O(a,"image/circle/stroke/color")||"#FF0000",lineCap:O(a,"image/circle/stroke/lineCap")||"round",lineJoin:O(a,"image/circle/stroke/lineJoin")||"round",lineDash:O(a,"image/circle/stroke/lineDash")||void 0,lineDashOffset:O(a,"image/circle/stroke/lineDashOffset")||0,width:"select"===n.type?4:O(a,"image/circle/stroke/width")||1})}));s=new nt.c({image:l});var g=t.get("textMinZoomLevel")||n.mapMinZoomLevel,y=t.get("textMaxZoomLevel")||n.mapMaxZoomLevel;return t.get("name")&&n.zoomLevel>=g&&n.zoomLevel<=y&&s.setText(new ot.a({textAlign:O(a,"text/textAlign")||"left",textBaseline:O(a,"text/textBaseline")||"middle",font:O(a,"text/font")||"normal 12px 宋体",text:t.get("name"),fill:new rt.a({color:O(a,"text/fill")||"#aa3300"}),stroke:new at.a({color:O(a,"text/stroke/color")||"#ffffff",width:O(a,"text/stroke/width")||1}),offsetX:O(a,"text/offsetX")||h,offsetY:O(a,"text/offsetY")||0,rotation:O(a,"text/rotation")||0,overflow:!0})),s}(t,0,n);break;case"LineString":i=function(t,e,n){var i=t.get("minZoomLevel")||n.mapMinZoomLevel,r=t.get("maxZoomLevel")||n.mapMaxZoomLevel;if(!(n.zoomLevel>=i&&n.zoomLevel<=r))return null;var a=t.get("style"),o=[];a&&a.stroke instanceof Array?a.stroke.forEach((function(t){var e=new nt.c({stroke:new at.a({color:"select"===n.type?n.color||"blue":O(t,"color")||"#FF0000",lineCap:O(t,"lineCap")||"round",lineJoin:O(t,"lineJoin")||"round",lineDash:O(t,"lineDash")||void 0,lineDashOffset:O(t,"lineDashOffset")||0,width:"select"===n.type?4:O(t,"width")||1})});o.push(e)})):o=new nt.c({stroke:new at.a({color:"select"===n.type?n.color||"blue":O(a,"stroke/color")||"#FF0000",lineCap:O(a,"stroke/lineCap")||"round",lineJoin:O(a,"stroke/lineJoin")||"round",lineDash:O(a,"stroke/lineDash")||void 0,lineDashOffset:O(a,"stroke/lineDashOffset")||0,width:"select"===n.type?4:O(a,"stroke/width")||1})});var s=t.getGeometry().getCoordinates(),l=(t.get("source"),t.get("target"),new ct.a(s));o instanceof Array?o.forEach((function(t){t.setGeometry(l)})):o.setGeometry(l);var c=wt(t,l,e,n);if(c&&c.length&&([].concat(c).concat([o]),o instanceof Array&&o.forEach((function(t){t.text=c[0].text}))),t.get("cable")||"electricity.DianLan"==t.get("symbolType")){var u=t.get("complex")||{min:0,max:9999},p=n.zoomLevel;if(p>=u.min&&p<=u.max){var h=St(l,{},e);o=[o].concat(h)}}return o}(t,e,n);break;case"Circle":case"Polygon":i=function(t,e,n){var i=t.get("style");return new nt.c({fill:new rt.a({color:"select"===n.type?n.color||"blue":O(i,"fill/color")||O(i,"fill")||"rgba(0,0,0,0.4)"}),stroke:new at.a({color:"select"===n.type?n.color||"blue":O(i,"stroke/color")||"#FF0000",lineCap:O(i,"stroke/lineCap")||"round",lineJoin:O(i,"stroke/lineJoin")||"round",lineDash:O(i,"stroke/lineDash")||void 0,lineDashOffset:O(i,"stroke/lineDashOffset")||0,width:"select"===n.type?4:O(i,"stroke/width")||1})})}(t,0,n)}return i},Tt={mounted:function(){var t=b(this,"OLMap");t&&(this.transformFn=t.transformFn,this.unTransformFn=t.unTransformFn||function(t,e){return e},this.mapComp=t),this.format=new P.a({dataProjection:"EPSG:4326"}),this.formatWkT=new B.a({dataProjection:"EPSG:4326"})},methods:{getGeoJsonBySource:function(t){var e=this,n=this,i=null;if(t){var r=[];t.getFeatures().forEach((function(t){var i=t.clone();n.transfromToWGS84Coordinates(i);var a=i.get("sourceElement");if(a instanceof N.a){var o=a.clone();n.transfromToWGS84Coordinates(o);var s=n.format.writeFeatureObject(o);i.set("sourceElement",s)}var l=i.get("targetElement");if(l instanceof N.a){var c=l.clone();n.transfromToWGS84Coordinates(c);var u=n.format.writeFeatureObject(c);i.set("targetElement",u)}var p=e.formatWkT.writeFeature(i);i.set("textWKT",p),r.push(i)})),i=this.format.writeFeaturesObject(r)}else console.error("请设置数据源");return i},transfromToWGS84Coordinates:function(t){if("function"==typeof this.unTransformFn){var e=t.getGeometry(),n=e.getType(),i=e.getCoordinates(),r=this.unTransformFn(n,i);e.setCoordinates(r)}},getSources:function(){var t=[];return this.mapComp.mapObject.getLayers().forEach((function(e){e instanceof D.a&&t.push(e.getSource())})),t}}},At={props:{excludeInteractions:{type:Array,default:function(){return["ol-measure","ol-offset","ol-modify","ol-basic-select","ol-select","ol-transform","ol-translate","ol-fillattribute","ol-draw-point","ol-draw-linestring","ol-draw-polygon","ol-distance-search","ol-delete"]}}},methods:{excludeIneractionActive:function(t){var e=this;this.mapObject&&this.mapObject.getMap&&this.mapObject.getMap().getInteractions().forEach((function(n){if(e.excludeInteractions.findIndex((function(t){return t===n.get("interactionType")}))>-1){var i=n.get("$parent");i&&i.$parent&&i.$parent.mapObject instanceof z.a?i.$parent.mapObject.setActive(t):n.setActive(t)}}))}}},Et={mounted:function(){var t=b(this,"OLMap");t&&(this.parentContainer=t)},methods:{createVectorLayer:function(t,e,n){var i=null;if(this.parentContainer){if(this.parentContainer.mapObject.getLayers().getArray().filter((function(e){return e.layerId==t.layerId||e.layerName==t.layerName})).length>0)return console.warn("图层已经存在，如果是新建图层，请修改图层名称"),i;(i=new D.a({source:new $.a,style:this.styleFunction.bind(this)})).setProperties(t),i.set("title",t.layerName),this.parentContainer.mapObject.addLayer(i),n&&n.length>0&&i.getSource().addFeatures(n),!1!==e&&this.saveLayerInfos(t)}return i},saveLayerInfos:function(t){var e,n;(e=[{layerId:t.layerId,layerName:t.layerName,layerType:t.layerType,isStationMap:0}],n={parms:JSON.stringify(e)},Y.post("layer/saveLayer.do",n)).then((function(t){console.log(t.data.resultHint)})).catch((function(t){console.log(t.massage)}))},styleFunction:function(t,e){var n=null;if(!1===t.get("isShow")||!1===t.get("visible"))n=null,this.parentContainer.removeOverlayById(t.get("id"));else{var i=this.parentContainer.mapObject.getView().getZoom(),r=this.parentContainer.$props.maxZoom,a=this.parentContainer.$props.minZoom;n=Mt(t,e,{mapObject:this.parentContainer.mapObject,mapComp:this.parentContainer,zoomLevel:i,mapMaxZoomLevel:r,mapMinZoomLevel:a,silentSvg:!0}),this.showScale&&this._setZoomScale(n,e,i)}return n}}},Ft={beforeDestroy:function(){if(this.mapObject){var t=this.mapObject.getMap();t&&t.removeControl(this.mapObject)}}},Pt=(n(1239),n(1240),n(1241),{name:"OLMap",componentName:"OLMap",mixins:[Tt],props:{fitp:{type:Boolean,default:!0},center:{custom:!0,type:Array,default:function(t){return[116.302778,40.050833]}},zoomLevel:{custom:!0,type:Number,default:13},maxZoom:{type:Number,default:18},minZoom:{type:Number,default:0},extent:{type:Array,default:function(t){return[]}},zoom:{type:Boolean,default:!1},zoomSlider:{type:Boolean,default:!1},rotate:{type:Boolean,default:!1},mousePosition:{type:Boolean,default:!1},scaleLine:{type:Boolean,default:!1}},data:function(){return{ready:!1}},mounted:function(){var t=this;Object(d.a)(m),!0===this.fitp&&function(t){for(var e=t.$parent;e;){if(e.$el&&e.$el.clientHeight>0){t.$el.style.height=e.$el.clientHeight+"px";break}e=e.$parent}}(this),this.mapObject=new r.a({target:this.$el,controls:this._getDefaultControls(),view:new a.a({center:Object(h.g)(this.center),zoom:this.zoomLevel,maxZoom:this.maxZoom,minZoom:this.minZoom})}),L(this,this.mapObject,this.$options.props),I(this.mapObject,this.$listeners),this.ready=!0,this.$nextTick((function(){t.$emit("ready",t.mapObject)}))},methods:{getMap:function(){return this.mapObject},getZoom:function(){return this.getMap().getView().getZoom()},addLayer:function(t,e){e||this.mapObject.addLayer(t.mapObject)},addControl:function(t){this.mapObject.addControl(t)},addInteraction:function(t){this.mapObject.addInteraction(t)},addOverlay:function(t){this.mapObject.addOverlay(t)},clearOverlays:function(){for(var t=this.getMap(),e=t.getOverlays().getArray(),n=e.length-1;n>=0;n--)t.removeOverlay(e[n])},removeOverlayById:function(t){for(var e=this.getMap(),n=e.getOverlays().getArray(),i=n.length-1;i>=0;i--)n[i].getId()===t&&e.removeOverlay(n[i])},setCenter:function(t,e){var n=t.slice();!1!==e&&"function"==typeof this.transformFn&&(n=this.transformFn("Point",t.slice())),this.mapObject.getView().animate({center:!1===e?n:Object(h.g)(n),duration:500})},setZoomLevel:function(t){this.mapObject.getView().animate({zoom:t,duration:500})},fit:function(t,e){var n=Object.assign({},e||{});this.mapObject.getView().fit(t,n)},isMapRoot:function(){return!0},_getDefaultControls:function(){var t=[],e=this.$props;return(void 0===e.zoom||e.zoom)&&(this.zoomCtrl_=new o.a(e.zoomOptions),t.push(this.zoomCtrl_)),(void 0===e.rotate||e.rotate)&&(this.rotateCtrl_=new s.a(e.rotateOptions),t.push(this.rotateCtrl_)),(void 0===e.zoomSlider||e.zoomSlider)&&(this.zoomSliderCtrl_=new l.a(e.zoomSliderOptions),t.push(this.zoomSliderCtrl_)),e.mousePosition&&(this.mousePositionCtrl_=new c.a(Object.assign({coordinateFormat:Object(p.d)(8),projection:"EPSG:4326",className:"jbgraph-map-mouse-position",undefinedHTML:"&nbsp;"},e.mousePositionOptions)),t.push(this.mousePositionCtrl_)),e.scaleLine&&(this.scaleLineCtrl_=new u.a(e.scaleLineOptions||{}),t.push(this.scaleLineCtrl_)),t},moveCenter:function(t){var e=Object.assign({},t||{}),n=e.center.slice();"function"==typeof this.transformFn&&(n=this.transformFn("Point",e.center.slice())),this.mapObject.getView().animate({center:Object(h.g)(n),zoom:e.zoom||this.zoomLevel,duration:e.duration||500})}}}),Bt=Pt,Dt=(n(1245),n(30)),$t=Object(Dt.a)(Bt,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"jbgraph-ol-map"},[this.ready?this._t("default"):this._e()],2)}),[],!1,null,"99122118",null),Nt=$t.exports,zt=Nt,Gt=n(587),Zt=n(1246),Rt={props:{title:{type:String,default:""},baseLayer:{type:Boolean,default:!1},url:{type:String,default:null},visible:{type:Boolean,default:!0},zIndex:{type:Number,default:0},options:{type:Object,default:function(){return{}}}},created:function(){this.tileUrl=this.url||this.defaultUrl},data:function(){return{tileUrl:null}},mounted:function(){var t=this;this.mapObject=new Gt.a({title:this.title,baseLayer:this.baseLayer,visible:this.visible||!1,source:this.tileUrl?new Zt.a({url:this.tileUrl,tileLoadFunction:this.options.tileLoadFunction,crossOrigin:"anonymous",wrapX:!1}):null});L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent),this.parentContainer.addLayer(this,!this.visible),this.$nextTick((function(){t.$emit("ready",t.mapObject)}))}},Vt={name:"OLTileLayer",mixins:[Rt]},Wt=Vt,Ht=Object(Dt.a)(Wt,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticStyle:{display:"none"}})}),[],!1,null,null,null),Ut=Ht.exports,Jt={name:"GoogleTileLayer",mixins:[Rt],props:{title:{type:String,default:"Google"},defaultUrl:{type:String,default:"http://mt2.google.cn/vt/lyrs=m@258000000&hl=zh-CN&gl=CN&src=app&s=Ga&x={x}&y={y}&z={z}"}},mounted:function(){var t=this.parentContainer.$props.center;if(Array.isArray(t)){var e=M(t[0],t[1]);this.parentContainer.setCenter(e)}this.parentContainer.transformFn=this.transformFn,this.parentContainer.unTransformFn=this.unTransformFn},methods:{transformFn:function(t,e){var n=e.slice();switch(t){case"Circle":case"Point":n=M(n[0],n[1]);break;case"LineString":n.forEach((function(t,e){n[e]=M(t[0],t[1])}));break;case"Polygon":n.forEach((function(t,e){t.forEach((function(e,n){t[n]=M(e[0],e[1])}))}))}return n},unTransformFn:function(t,e){var n=e.slice();switch(t){case"Circle":case"Point":var i=Object(h.m)([n[0],n[1]]);n=T(i[0],i[1]);break;case"LineString":n.forEach((function(t,e){var i=Object(h.m)([t[0],t[1]]);n[e]=T(i[0],i[1])}));break;case"Polygon":n.forEach((function(t,e){t.forEach((function(e,n){var i=Object(h.m)([e[0],e[1]]);t[n]=T(i[0],i[1])}))}))}return n}}},Yt=Jt,Xt=Object(Dt.a)(Yt,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticStyle:{display:"none"}})}),[],!1,null,null,null),Kt=Xt.exports,qt={mame:"AMapTileLayer",mixins:[Rt],props:{title:{type:String,default:"高德地图"},defaultUrl:{type:String,default:"http://webrd01.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=7&x={x}&y={y}&z={z}"}},mounted:function(){var t=this.parentContainer.$props.center;if(Array.isArray(t)){var e=M(t[0],t[1]);this.parentContainer.setCenter(e)}this.parentContainer.transformFn=this.transformFn,this.parentContainer.unTransformFn=this.unTransformFn},methods:{transformFn:function(t,e){var n=e;switch(t){case"Circle":case"Point":n=M(n[0],n[1]);break;case"LineString":n.forEach((function(t,e){n[e]=M(t[0],t[1])}));break;case"Polygon":n.forEach((function(t,e){t.forEach((function(e,n){t[n]=M(e[0],e[1])}))}))}return n},unTransformFn:function(t,e){var n=e.slice();switch(t){case"Circle":case"Point":var i=Object(h.m)([n[0],n[1]]);n=T(i[0],i[1]);break;case"LineString":n.forEach((function(t,e){var i=Object(h.m)([t[0],t[1]]);n[e]=T(i[0],i[1])}));break;case"Polygon":n.forEach((function(t,e){t.forEach((function(e,n){var i=Object(h.m)([e[0],e[1]]);t[n]=T(i[0],i[1])}))}))}return n}}},Qt=Object(Dt.a)(qt,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticStyle:{display:"none"}})}),[],!1,null,null,null).exports,te=(n(82),n(696)),ee=n(726),ne=n(705),ie=n(492),re=n(404),ae=n(1247),oe={mame:"BMapTileLayer",mixins:[Rt],props:{title:{type:String,default:"百度地图"},defaultUrl:{type:String,default:null}},mounted:function(){var t=function(t){t=t||{};var e,n=new te.a({html:'&copy; <a class="ol-attribution-baidumap" href="http://map.baidu.com/">百度地图</a>'});e=void 0!==t.attributions?option.attributions:[n];var i=[72.004,.8293,137.8347,55.8271],r=new ie.a({code:"baidu",extent:Object(re.a)(i,ae.ll2bmerc),units:"m"});Object(h.d)(r),Object(h.b)("EPSG:4326",r,ae.ll2bmerc,ae.bmerc2ll),Object(h.b)("EPSG:3857",r,ae.smerc2bmerc,ae.bmerc2smerc);for(var a=[],o=0;o<20;o++)a[o]=Math.pow(2,18-o);var s=new ne.a({origin:[0,0],resolutions:a,extent:Object(re.a)(i,ae.ll2bmerc),tileSize:[256,256]}),l=[0,1,2,3,4].map((function(t){return"http://shangetu"+t+".map.bdimg.com/it/u=x={x};y={y};z={z};v=009;type=sate&fm=46&udt=20150601"})),c=[0,1,2,3,4].map((function(t){return"http://online"+t+".map.bdimg.com/onlinelabel/qt=tile&x={x}&y={y}&z={z}&v=009&styles=pl&udt=20170301&scaler=2&p=1"}));return new ee.a({attributions:e,crossOrigin:"anonymous",cacheSize:t.cacheSize,projection:"baidu",tileGrid:s,tilePixelRatio:2,tileUrlFunction:function(e,n,i){if(!e)return"";var r=e[0],a=e[1],o=e[2];if(t.url)return t.url.replace("{x}",a).replace("{y}",o).replace("{z}",r);var s=((a<<r)+o)%c.length;return s=s<0?s+c.length:s,"sat"==t.mapType?l[s].replace("{x}",a).replace("{y}",o).replace("{z}",r):c[s].replace("{x}",a).replace("{y}",o).replace("{z}",r)},wrapX:void 0===t.wrapX||t.wrapX})}({url:this.url,wrapX:!1});this.mapObject.setSource(t),this.parentContainer.transformFn=null,this.parentContainer.unTransformFn=this.unTransformFn},methods:{unTransformFn:function(t,e){var n=e.slice();switch(t){case"Circle":case"Point":n=Object(h.m)([n[0],n[1]]);break;case"LineString":n.forEach((function(t,e){n[e]=Object(h.m)([t[0],t[1]])}));break;case"Polygon":n.forEach((function(t,e){t.forEach((function(e,n){t[n]=Object(h.m)([e[0],e[1]])}))}))}return n}}},se=Object(Dt.a)(oe,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticStyle:{display:"none"}})}),[],!1,null,null,null).exports,le=Ut,ce=function(){var t=new Date(1582,10,15,0,0,0,0),e=(new Date).getTime()-t.getTime(),n="-";return ue(e,0,31)+n+ue(e,32,47)+n+(ue(e,48,59)+"1")+n+ue(he(4095),0,7)+ue(he(4095),0,7)+n+(ue(he(8191),0,7)+ue(he(8191),8,15)+ue(he(8191),0,7)+ue(he(8191),8,15)+ue(he(8191),0,15))},ue=function(t,e,n){var i=pe(t,16),r=new Array,a="",o=0;for(o=0;o<i.length;o++)r.push(i.substring(o,o+1));for(o=Math.floor(e/4);o<=Math.floor(n/4);o++)r[o]&&""!=r[o]?a+=r[o]:a+="0";return a},pe=function t(e,n){var i=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];if(e<n)var r=i[e];else{var a=""+Math.floor(e/n),o=e-a*n;if(a>=n)r=t(a,n)+i[o];else r=i[a]+i[o]}return r},he=function(t){return Math.floor(Math.random()*t)},de=function(){return ce()},fe={props:{isSymbolsWithMapZoom:{type:Boolean,default:!1},initSymbolsZoomLevel:{type:Number,default:14}},methods:{_setZoomScale:function(t,e,n){if(t){var i=this.scaleArray.filter((function(t){return t.zoomLevel==n}));Array.isArray(t)?this.scaleArray instanceof Array&&this.scaleArray&&i.length>0?i.forEach((function(i){i.zoomLevel==n&&i.lineScale?t.forEach((function(t){if(t.getStroke()){var e=t.getStroke().getWidth();t.getStroke().setWidth(e*i.lineScale)}})):n>=me.scaleZoom?t.forEach((function(t){if(t.getStroke()){var e=t.getStroke().getWidth();t.getStroke().setWidth(1*e)}})):t.forEach((function(t){if(t.getStroke()){var n=t.getStroke().getWidth();t.getStroke().setWidth(2*n/Math.pow(e,1/3))}}))})):n>=this.scaleZoom?t.forEach((function(t){if(t.getStroke()){var e=t.getStroke().getWidth();t.getStroke().setWidth(1*e)}})):t.forEach((function(t){if(t.getStroke()){var n=t.getStroke().getWidth();t.getStroke().setWidth(2*n/Math.pow(e,1/3))}})):this.scaleArray instanceof Array&&this.scaleArray&&i.length>0?i.forEach((function(i){i.zoomLevel==n?t.getImage()&&t.getImage().setScale(i.pointScale):n>=me.scaleZoom?t.getImage()&&t.getImage().setScale(1):t.getImage()&&t.getImage().setScale(2/Math.pow(e,1/3))})):n>=this.scaleZoom?t.getImage()&&t.getImage().setScale(1):t.getImage()&&t.getImage().setScale(2/Math.pow(e,1/3))}},getScaleRatio:function(t,e){var n=1;return t&&!0===this.isSymbolsWithMapZoom&&(n=t.getView().getMaxResolution()/(e||t.getView().getResolution()),this.initSymbolsZoomLevel>=0&&(n*=1/Math.pow(2,this.initSymbolsZoomLevel))),n}}},ge=n(707),ye=n.n(ge),be={name:"OLVectorLayer",mixins:[fe],props:{properties:{custom:!0,type:Object,default:function(){return{}}},title:{type:String,default:""},visible:{type:Boolean,default:!0},zIndex:{type:Number,default:10},maxResolution:{type:Number,default:Number.MAX_VALUE},minResolution:{type:Number,default:0},opacity:{type:Number,default:1},renderBuffer:{type:Number,default:100},source:{custom:!0,type:Object,default:function(){return null}},declutter:{type:Boolean,default:!1},updateWhileAnimating:{type:Boolean,default:!1},layerId:{custom:!0,type:String,default:ce()},guid_:{custom:!0,type:String,default:ce()},layerName:{custom:!0,type:String,default:null},layerType:{custom:!0,type:String,default:null},scaleZoom:{type:Number,default:15},scaleArray:{type:Array,default:function(){return[]}},showScale:{type:Boolean,default:!1},silentSvg:{type:Boolean,default:!0}},data:function(){return{ready:!1}},mounted:function(){var t=this,e=C(this.$props,this);e.style=this.styleFunction.bind(this),this.mapObject=new D.a(e),L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent),this.parentContainer.addLayer(this,!this.visible),I(this.mapObject,this.$listeners),this.mapObject.set("isSymbolsWithMapZoom",this.isSymbolsWithMapZoom),this.mapObject.set("initSymbolsZoomLevel",this.initSymbolsZoomLevel),this.ready=!0,this.$nextTick((function(){t.$emit("ready",t.mapObject,t)}))},beforeDestroy:function(){this.parentContainer&&this.parentContainer.mapObject&&this.parentContainer.mapObject.removeLayer(this.mapObject)},methods:{setSource:function(t){this.mapObject.setSource(t)},setProperties:function(t){t&&this.mapObject.setProperties(t)},setLayerId:function(t){this.mapObject.set("layerId",t)},setGuid_:function(t){this.mapObject.set("guid_",t)},setLayerName:function(t){this.mapObject.set("layerName",t)},setLayerType:function(t){this.mapObject.set("layerType",t)},styleFunction:function(t,e){var n=null;if(!1===t.get("isShow")||!1===t.get("visible"))n=null,this.parentContainer.removeOverlayById(t.get("id"));else{var i=this.parentContainer.mapObject.getView().getZoom(),r=this.parentContainer.$props.maxZoom,a=this.parentContainer.$props.minZoom;if(n=Mt(t,e,{mapObject:this.parentContainer.mapObject,mapComp:this.parentContainer,zoomLevel:i,mapMaxZoomLevel:r,mapMinZoomLevel:a,silentSvg:this.silentSvg}),this.isSymbolsWithMapZoom)if("Point"===t.getGeometry().getType()){var o=this.getScaleRatio(this.parentContainer.mapObject,e);n.getImage()&&n.getImage().setScale(o)}}return n},getMap:function(){return this.parentContainer.mapObject},getExtent:function(){return this.mapObject.getSource().getExtent()},fit:function(t){t=t||{};var e=this.parentContainer.mapObject.getView();setTimeout(function(){var n=this.getExtent();e.fit(n,{duration:t.duration||500})}.bind(this),t.delay||250)},clear:function(){this.mapObject&&this.mapObject.getSource().clear()}}},ve=Object(Dt.a)(be,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticStyle:{display:"none"}},[this.ready?this._t("default"):this._e()],2)}),[],!1,null,null,null).exports,Oe=n(708),we={name:"OLHeatmapLayer",props:{className:{type:String,default:"ol-layer"},opacity:{type:Number,default:1},visible:{type:Boolean,default:!0},zIndex:{type:Number,default:10},minResolution:{type:Number,default:0},maxResolution:{type:Number,default:Number.MAX_VALUE},minZoom:{type:Number,default:0},maxZoom:{type:Number,default:18},gradient:{type:Array,default:function(){return["#0B8302","#FBFE41","#FF5B13","#FE1403"]}},radius:{type:Number,default:8},blur:{type:Number,default:15},shadow:{type:Number,default:250},weight:{type:String,default:"weight"},renderMode:{type:String|Function,default:"vector"},source:{custom:!0,type:Object,default:function(){return null}},title:{type:String,default:""}},data:function(){return{ready:!1}},mounted:function(){var t=this,e=C(this.$props,this);this.mapObject=new Oe.a(e),L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent),this.parentContainer.addLayer(this,!this.visible),I(this.mapObject,this.$listeners),this.ready=!0,this.$nextTick((function(){t.$emit("ready",t.mapObject,t)}))},beforeDestroy:function(){this.parentContainer&&this.parentContainer.mapObject&&this.parentContainer.mapObject.removeLayer(this.mapObject)},methods:{setSource:function(t){this.mapObject.setSource(t)},getBlur:function(t){this.mapObject.getBlur(t)},getGradient:function(t){this.mapObject.getGradient(t)},getRadius:function(t){this.mapObject.getRadius(t)},setBlur:function(t){this.mapObject.setBlur(t)},setGradient:function(t){this.mapObject.setGradient(t)},setRadius:function(t){this.mapObject.setRadius(t)},clear:function(){this.mapObject&&this.mapObject.getSource().clear()}}},_e=Object(Dt.a)(we,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticStyle:{display:"none"}},[this.ready?this._t("default"):this._e()],2)}),[],!1,null,null,null).exports,xe=ve,Se=n(1253),Le={methods:{getSource:function(){return this.mapObject},clear:function(){this.mapObject.clear()},getFeatureById:function(t){this.mapObject.getFeatureById(t)},hasFeature:function(t){return this.mapObject.hasFeature(t)},removeFeature:function(t){this.mapObject.removeFeature(t)},removeFeatures:function(t){Array.isArray(t)||(t=[t]);for(var e=t.length-1;e>=0;e--)this.removeFeature(t[e])},getFeatures:function(){return this.mapObject.getFeatures()},_addPorts:function(t){Array.isArray(t)||(t=[t]),t.forEach((function(t){!t.get("id")&&t.set("id",de());var e=t.get("style")||{},n=O(e,"image/svg-symbol/symbolType");if(n){var i=gt.getSymbolDef(n);if(i&&i.ports&&i.ports.items.length>0){var r=JSON.parse(JSON.stringify(i.ports));r.items.forEach((function(e){e.id=t.get("id")+"@"+e.group})),t.set("ports",r)}}}))}}},je={name:"VectorSource",mixins:[Le],props:{attributions:{type:Object,default:function(){return{}}},overlaps:{type:Boolean,default:!0},isCluster:{type:Boolean,default:!1},distance:{type:Number,default:1},wrapX:{type:Boolean,default:!1}},data:function(){return{ready:!1}},mounted:function(){var t=this,e=b(this,"OLMap");e&&(this.mapComp=e);var n={};this.isCluster?this.mapObject=new Se.a({distance:this.distance,source:new $.a(n),geometryFunction:function(t){var e=t.getGeometry();return"Point"==e.getType()?e:null}}):this.mapObject=new $.a(n),this.parentContainer=k(this.$parent),this.parentContainer.setSource(this.mapObject),L(this,this.mapObject,this.$options.props),I(this.mapObject,this.$listeners),this.mapObject.on("addfeature",function(t){this._addPorts(t.feature)}.bind(this)),this.ready=!0,this.$nextTick((function(){t.$emit("ready",t.mapObject)}))},methods:{addFeatures:function(t){!0===this.isCluster?this.mapObject.getSource().addFeatures(t):this.mapObject.addFeatures(t)},getPortFeatures:function(){var t=null;if(this.mapComp){var e=this.mapComp.mapObject;if(e){var n=this.mapObject.getFeatures();t=Ct(n,e)}}return t}}},Ce=Object(Dt.a)(je,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticStyle:{display:"none"}},[this.ready?this._t("default"):this._e()],2)}),[],!1,null,null,null).exports,ke=function(t){if(!Array.isArray(t))return t;var e={},n=[];return t.forEach((function(t){var i=t.properties.id||t.properties.graphId;switch(t.geometry.type){case"Point":i&&(e[i]=t);break;case"LineString":n.push(t)}})),n.forEach((function(t){var n=t.properties.source,i=t.properties.target;if(n&&i){var r=e[n.id],a=e[i.id];t.geometry.coordinates=t.geometry.coordinates||new Array(2);var o=t.geometry.coordinates.length;r&&a&&(t.geometry.coordinates[0]=r.geometry.coordinates.slice(),t.geometry.coordinates[o-1]=a.geometry.coordinates.slice())}})),t},Ie=n(435),Me=n(522),Te=n(476),Ae=function(t,e){var n=Object(Te.d)(t,e,0),i=new Lt.a(n).transform("EPSG:4326","EPSG:3857").getFirstCoordinate(),r=new Lt.a(t).transform("EPSG:4326","EPSG:3857").getFirstCoordinate(),a=new Me.a([NaN,NaN]),o=Object(p.i)(r,i);return a.setCenterAndRadius(r,Math.sqrt(o)),a},Ee={name:"GeoJsonSource",mixins:[Le],props:{features:{custom:!0,type:Array,default:function(){return[]}}},data:function(){return{ready:!1,geoJSON:{type:"FeatureCollection",features:[]}}},created:function(){this.geoJSON.features=this.features.slice(),ke(this.geoJSON.features)},mounted:function(){var t=this,e=b(this,"OLMap");e&&(this.transformFn=e.transformFn,this.mapComp=e),this.format=new P.a;var n=this._transform2geo();this._addPorts(n),this.mapObject=new $.a,this.mapObject.addFeatures(n),this.parentContainer=k(this.$parent),this.parentContainer.setSource(this.mapObject),L(this,this.mapObject,this.$options.props),I(this.mapObject,this.$listeners),this.mapObject.on("addfeature",function(t){this._addPorts(t.feature)}.bind(this)),this.ready=!0,this.$nextTick((function(){t.$emit("reay",t.mapObject),setTimeout(function(){this.parentContainer.mapObject.changed()}.bind(t),1e3)}))},methods:{getMap:function(){return this.mapComp.mapObject},setFeatures:function(){ke(this.features),this.geoJSON.features=this.features;var t=this._transform2geo();this.mapObject.clear(),this.mapObject.addFeatures(t)},addFeatures:function(t){this.mapObject.addFeatures(t)},addOverlay:function(t,e){if(this.mapComp){var n=null;this.mapComp.mapObject.addOverlay(t);var i=this.mapObject.getFeatureById(t.getId()).getGeometry();switch(i.getType()){case"LineString":n=i.getCoordinateAt(.5);break;default:var r=i.getExtent();n=Object(re.x)(r)}setTimeout((function(){t.setPosition(n)}),300)}},_transform2geo:function(){var t=this,e=this.format.readFeatures(this.geoJSON);return e.forEach((function(e){var n=function(t,e,n){var i=t.slice();"function"==typeof n&&(i=n(e,t.slice()));var r=null,a=null;switch(e){case"Point":a=new Lt.a(i);break;case"LineString":a=new ct.a(i);break;case"Polygon":a=new Ie.a(i);break;case"Circle":a=new Lt.a(i)}return a&&(r="Circle"===e?Ae(i,this.radius):a.clone().transform("EPSG:4326","EPSG:3857")),r}(e.getGeometry().getCoordinates(),e.getGeometry().getType(),t.transformFn);e.setGeometry(n),e.get("id")&&e.setId(e.get("id"))})),e},getPortFeatures:function(){var t=null;if(this.mapComp){var e=this.mapComp.mapObject;if(e){var n=this.mapObject.getFeatures();t=Ct(n,e)}}return t}}},Fe=Object(Dt.a)(Ee,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticStyle:{disply:"none"}},[this.ready?this._t("default"):this._e()],2)}),[],!1,null,null,null).exports,Pe=Ce,Be=n(411),De={name:"OLFeature",props:{geoType:{type:String,default:"Point"},coordinates:{custom:!0,type:Array,default:function(t){return[0,0]}},properties:{custom:!0,type:Object,default:function(){return{}}},radius:{custom:!0,type:Number,default:1},visible:{custom:!0,type:Boolean,default:!0}},data:function(){return{ready:!1}},mounted:function(){var t=this,e=b(this,"OLMap");e&&(this.transformFn=e.transformFn,this.mapComp=e);var n=this._geometryFunction();this.mapObject=new N.a(Object.assign({id:de(),geometry:n},this.properties)),L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent),this.visible&&this.parentContainer.addFeatures([this.mapObject]);var i=O(this.properties,"style/image/svg-symbol/symbolType");if(i){var r=gt.getSymbolDef(i);if(r&&r.ports&&r.ports.items.length>0){var a=Object(Be.a)({},r.ports);a.items.forEach((function(e,n){e.id=(t.mapObject.get("id")||de())+"@"+e.group})),this.mapObject.set("ports",a)}}this.ready=!0,this.$nextTick((function(){t.$emit("ready",t.mapObject)}))},beforeDestroy:function(){if(this.parentContainer&&this.parentContainer.mapObject&&(this.parentContainer.mapObject.removeFeature(this.mapObject),this.overlay&&this.overlay.getMap)){var t=this.overlay.getMap();t&&t.removeOverlay(this.overlay),this.overlay=null}},methods:{_geometryFunction:function(t){var e=t||this.coordinates.slice();"function"==typeof this.transformFn&&(e=this.transformFn(this.geoType,this.coordinates.slice()));var n=null,i=null;switch(this.geoType){case"Point":i=new Lt.a(e);break;case"LineString":i=new ct.a(e);break;case"Polygon":i=new Ie.a(e);break;case"Circle":i=new Lt.a(e)}return i&&(n="Circle"===this.geoType?this.getGeometryCircle(e,this.radius):i.clone().transform("EPSG:4326","EPSG:3857")),n},getGeometryCircle:function(t,e){var n=Object(Te.d)(t,e,0),i=new Lt.a(n).transform("EPSG:4326","EPSG:3857").getFirstCoordinate(),r=new Lt.a(t).transform("EPSG:4326","EPSG:3857").getFirstCoordinate(),a=new Me.a([NaN,NaN]),o=Object(p.i)(r,i);return a.setCenterAndRadius(r,Math.sqrt(o)),a},setVisible:function(t){!1===t?this.parentContainer.mapObject.removeFeature(this.mapObject):this.parentContainer.addFeatures([this.mapObject])},setRadius:function(t){if("Circle"===this.geoType){var e=this.transformFn?this.transformFn(this.geoType,this.coordinates.slice()):this.coordinates.slice(),n=this.getGeometryCircle(e,t);this.mapObject.setGeometry(n)}},setCoordinates:function(t){var e=this._geometryFunction(t);this.mapObject.setGeometry(e)},setProperties:function(t){var e=this,n=this.mapObject.getProperties();Object.keys(n).forEach((function(t){"geometry"!==t&&e.mapObject.unset(t,!0)})),this.mapObject.setProperties(t,!1),this.mapObject.changed()},addOverlay:function(t,e){if(this.mapComp){var n=null;this.mapComp.mapObject.addOverlay(t);var i=this.mapObject.getGeometry();switch(i.getType()){case"LineString":n=i.getCoordinateAt(.5);break;default:var r=i.getExtent();n=Object(re.x)(r)}setTimeout((function(){t.setPosition(n)}),300)}},getMap:function(){var t=null;return this.mapComp&&(t=this.mapComp.mapObject),t}}},$e=Object(Dt.a)(De,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticStyle:{display:"none"}},[this.ready?this._t("default"):this._e()],2)}),[],!1,null,null,null).exports,Ne=$e,ze=n(400),Ge=n(451),Ze=function(t,e,n){return Y.post(t,e,n)},Re=function(t){return Y.post("joint/graph/getAllGraphList.do",t)},Ve=function(t){var e=t.layerId,n=t.versionNo;if(!e||!n)return'{"successful":false,"resultHint":"查询失败"}';var i="".concat("v1/neo4j","/algo/type/check-conencted/version/").concat(n,"/layers/").concat(e);return Y.get(i)},We=function(t,e,n){n=n||"master";var i="".concat("v1/neo4j","/algo/type/shortest-path/version/").concat(n,"/start/").concat(t,"/end/").concat(e);return Y.get(i)},He=function(t,e,n){n=n||{};var i=function(t,e){var n=t;if(e&&e.layerId){for(var i=[],r=n.features,a=0;a<r.length;a++){var o=r[a],s={graphId:o.properties.id,layerId:e.layerId||null,type:o.properties.type||o.geometry.type,nodeOne:0,nodeTwo:0,nodeThree:0};if("Point"===o.geometry.type){var l=o.properties.ports;if(l&&l.items)for(var c=0;c<l.items.length;c++){var u=l.items[c].group,p=l.items[c].id;switch(u){case"terminal_1":s.nodeOne=p;break;case"terminal_2":s.nodeTwo=p;break;case"terminal_3":s.nodeThree=p}}else s.nodeOne=o.properties.id}"LineString"===o.geometry.type&&(o.properties&&o.properties.source&&(o.properties.source.port?s.nodeOne=o.properties.source.port:o.properties.source.id&&(s.nodeOne=o.properties.source.id)),o.properties&&o.properties.target&&(o.properties.target.port?s.nodeTwo=o.properties.target.port:o.properties.target.id&&(s.nodeTwo=o.properties.target.id)),s.nodeThree=0),0==s.nodeOne&&0==s.nodeTwo&&0==s.nodeThree||i.push(s)}return i}}(t,e);return new Promise((function(r,a){if(e.layerId||t.layerId){var o={cims:JSON.stringify(i),layerId:e.layerId||t.layerId,MenuID:n.MenuID};Ze("joint/graph/saveCimTopo.do",o).then((function(t){r({isTopo:!0,message:"保存拓扑执行完成"})})).catch((function(t){a(t)}))}}))},Ue=function(t,e){for(var n=Object(Ge.a)(t),i=e||"#",r=0;r<n.length-1;r++){var a=Number(n[r]).toString(16);1===a.length&&(a="0"+a),i+=a}return i.toUpperCase()},Je=function(t,e){for(var n=null,i=t.features,r=0;r<i.length;r++){var a=i[r];if("Point"===a.geometry.type&&e.id==a.properties.id){n=1;var o=a.properties.ports;if(o&&o.items)for(var s=0;s<o.items.length;s++){var l=o.items[s].group;if(o.items[s].id==e.port)switch(l){case"terminal_1":n=1;break;case"terminal_2":n=2;break;case"terminal_3":n=3}}break}}return n},Ye=function(t,e,n,i,r){r=r||{};!0===n&&i||(n=!1,i=null);var a=function(t,e,n,i,r){for(var a=[],o=e,s=t.features,l=0;l<s.length;l++){var c,u=s[l],p=u.properties.symbolType;if(!p&&(p=O(u.properties,"style/image/svg-symbol/symbolType")),!p&&(p=O(u.properties,"style/image/font-symbol/glyph")),!p)switch(u.geometry.type){case"Point":p="basic.Circle";break;case"LineString":p="app.Link";break;case"Polygon":p="basic.Ploygon"}var h=null;if("LineString"===u.geometry.type){if(u.properties.source&&u.properties.source.id){var d=u.properties.source.id,f=Je(t,u.properties.source);null!==f&&((h=h||{})[1]=d+"@"+f)}if(u.properties.target&&u.properties.target.id){var m=u.properties.target.id,g=Je(t,u.properties.target);null!==g&&((h=h||{})[2]=m+"@"+g)}h&&(h=JSON.stringify(h))}var y=O(u.properties,"style/image/svg-symbol")?"style/image/svg-symbol/":null;!y&&O(u.properties,"style/image/shape")&&(y="style/image/shape/"),!y&&O(u.properties,"style/image/circle")&&(y="style/image/circle/"),!y&&(y="style/");var b=O(u.properties,y+"stroke/lineDash"),v=O(u.properties,y+"radius"),w=(c={guid_:u.properties.id,graphId:u.properties.id,graphName:u.properties.GraphName||u.properties.graphName||u.properties.name||null,graphType:p,layerId:o.layerId,gbCode:u.properties.gbCode||null,theGeom:u.properties.viewTextWKT,strokeColor:O(u.properties,y+"stroke/color")||O(u.properties,y+"stroke/color/color")||null,fillOpacity:null,strokeWidth:O(u.properties,y+"stroke/width")||null,fillColor:O(u.properties,y+"fill")||null},Object(ze.a)(c,"fillOpacity",O(u.properties,y+"fill")||null),Object(ze.a)(c,"strokeDasharray",b&&b.length>0?b.join(" "):null),Object(ze.a)(c,"size",O(u.properties,y+"size/width")||(v?2*v:null)),Object(ze.a)(c,"devId",u.properties.devId||null),Object(ze.a)(c,"voltageLevel",u.voltageLevel||null),Object(ze.a)(c,"connRelation",h),c);if(w.strokeColor&&(w.strokeColor=Ue(w.strokeColor)),w.fillColor){var _=Object(Ge.a)(w.fillColor);_.length>=3&&(w.fillOpacity=_[3]),w.fillColor=Ue(w.fillColor)}a.push(w),delete u.properties.textWKT,delete u.properties.viewTextWKT}return a}(t,e),o=function(t,e,n,i,r){var a=e;return{guid_:a.guid_||ce(),graphContent:JSON.stringify(t),layerId:a.layerId||ce(),layerName:a.layerName||a.code_||"unknown",versionNo:n?i:null,extra:a.extra?JSON.stringify(a.extra):null,code:a.code_||null,scriptCode:a.scriptCode||null}}(t,e);return new Promise((function(s,l){(function(t,e){var n={features:t};return Y.post("v1/gis/features/"+e,n)})(JSON.stringify(a),e.layerId).then((function(t){var e=t.data;console.log(e.resultHint)})).catch((function(t){console.log(t.stack)})),K(Object.assign({graph:JSON.stringify([o]),isVersion:n,versionNo:i,gisGraphInfo:null,dataType:"GEOJSON"},r)).then((function(n){var i=n.data;return i.successful&&(console.log(i.resultHint||"保存数据成功"),!r||!1!==r.isTopo)?(console.log("开始保存拓扑数据"),He(t,e,r)):new Promise((function(t,e){t({isTopo:r.isTopo,data:i})}))})).then((function(e){!1===e.isTopo?(console.log("不保存拓扑数据，开始执行回调"),"function"==typeof r.callback&&r.callback(t,e.data)):console.log(e.message),s(e)})).catch((function(t){console.log(t.stack),l(t)}))}))},Xe=function(t){var e={};return Object.keys(t).forEach((function(n){"graphContent"!==n&&(e[n]=t[n])})),e},Ke=function(t,e){return e=e||{},new Promise((function(n,i){X(Object.assign({layerId:t},e)).then((function(t){var e=t.data;if(e.successful)if(e.resultValue&&e.resultValue.length>0){for(var r=[],a=0;a<e.resultValue.length;a++){var o=e.resultValue[a],s=o.graphContent?JSON.parse(o.graphContent):{type:"FeatureCollection",features:[]},l=Xe(o);r.push({geoJSON:s,layerProps:l})}n(r)}else n();else console.log(e.resultHint),i(e.resultHint)})).catch((function(t){console.log(t.stack)}))}))},qe=n(125),Qe={name:"OLReadFile",data:function(){return{fileVisible:!1,files:[],fileName:""}},components:{"el-dialog":qe.Dialog,"el-select":qe.Select,"el-form":qe.Form,"el-form-item":qe.FormItem,"el-option":qe.Option,"el-button":qe.Button},methods:{dialogOpen:function(){var t=this;t.fileVisible=!0,Re().then((function(e){var n=e.data.resultValue;t.files=n,t.fileName=n[0].layerId}))},readFeature:function(){this.fileVisible=!1,this.$emit("layerName",this.fileName)}}},tn=Object(Dt.a)(Qe,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-dialog",{attrs:{visible:t.fileVisible,title:"打开文件",width:"400px","close-on-click-modal":!1,"append-to-body":!0,"show-close":!1}},[n("el-form",{attrs:{"label-width":"70px"}},[n("el-form-item",{attrs:{label:"文件名称"}},[n("el-select",{model:{value:t.fileName,callback:function(e){t.fileName=e},expression:"fileName"}},t._l(t.files,(function(t,e){return n("el-option",{key:e,attrs:{label:t.layerName,value:t.layerId}})})),1)],1)],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"small"},on:{click:function(e){t.fileVisible=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.readFeature}},[t._v("确 定")])],1)],1)],1)}),[],!1,null,"0927d5ce",null).exports,en='\t\t<g id="<%= id %>_text" >\n            <text ref-type="<%= refType %>" style="text-anchor:<%= ancchor %>" x="<%= x %>" y="<%= y %>" font-size="<%= fontSize %>" font-family="<%= fontFamily %>" stroke="<%= stroke %>" fill="<%= fill %>" transform="rotate(<%= rotate %>)"><%= text %></text>\n        </g>\n',nn=function(t){return-t},rn=function(t,e){var n=t.geometry.coordinates,i="";if(O(t.properties,"style/image/svg-symbol")){var r=O(t.properties,"style/image/svg-symbol/size/width")||30,a=O(t.properties,"style/image/svg-symbol/size/height")||30;i=x('       <g id="<%= id %>" >\n            <use x="<%= x %>" y="<%= y %>" fill="<%= fill %>" stroke="<%= stroke %>" width="<%= width %>" height="<%= height %>" transform="rotate(<%= angle %>,<%= rotateX %>,<%= rotateY %>)" xlink:href="#<%= symbolHref %>" />\n        </g>\n')({id:t.properties.id,x:n[0]-1*r/2,y:nn(n[1]+1*a/2),width:1*r,height:1*a,angle:O(t.properties,"style/image/svg-symbol/rotation")||0,rotateX:n[0],rotateY:nn(n[1]),symbolHref:O(t.properties,"style/image/svg-symbol/symbolType")||"",fill:O(t.properties,"style/image/svg-symbol/fill")||"#ff0000",stroke:O(t.properties,"style/image/svg-symbol/stroke/color")||"#ff0000",strokeWidth:O(t.properties,"style/image/svg-symbol/stroke/width")||1})}else i=x('       <g id="<%= id %>" >\n            <circle cx="<%= cx %>" cy="<%= cy %>" r="<%= r %>" fill="<%= fill %>" stroke="<%= stroke %>" />\n        </g>\n')({id:t.properties.id,cx:n[0],cy:nn(n[1]),fill:O(t.properties,"style/image/circle/fill")||"#000000",stroke:O(t.properties,"style/image/circle/stroke/color")||"#ff0000",strokeWidth:O(t.properties,"style/image/circle/stroke/width")||1,r:1*O(t.properties,"style/image/circle/radius")||2});return i},an=function(t,e){var n=t.geometry.coordinates,i=new Array(n.length);n.forEach((function(t,e){var n=t[0],r=nn(t[1]);i[e]=n+","+r}));var r=O(t.properties,"style/stroke"),a="#FF0000",o=1,s="";if(Array.isArray(r)){var l=O(r,"0/color"),c=O(r,"0/width"),u=O(r,"0/lineDash");l&&(a=l),c&&(o=c),u&&(s=u)}else r&&r.color&&(a=r.color),r&&r.width&&(o=r.width),r&&r.lineDash&&(s=r.lineDash);return x('       <g id="<%= id %>" >\n            <path d="<%= d %>" stroke="<%= stroke %>" stroke-width="<%= strokeWidth %>" stroke-dasharray="<%= strokeDasharray %>"/>\n        </g>\n')({id:t.properties.id,d:"M "+i.join(" L "),stroke:a,strokeWidth:o,strokeDasharray:s?s.join(","):""})},on=function(t,e){var n=[];return t.geometry.coordinates.forEach((function(t){t.forEach((function(t){n.push(t[0]+","+nn(t[1]))}))})),x('       <g id="<%= id %>" >\n            <polygon points="<%= points %>" fill="<%= fill %>" stroke="<%= stroke %>" stroke-width="<%= strokeWidth %>" />\n        </g>\n')({id:t.properties.id,points:n.join(" "),fill:O(t.properties,"style/fill")||"rgb(0,0,0)",stroke:O(t.properties,"style/stroke/color")||"rgb(255,0,0)",strokeWidth:O(t.properties,"style/stroke/width")||2})},sn=function(t,e){var n=O(t.properties,"style/text/text")||t.properties.name;if(!n)return null;var i=t.geometry.coordinates,r=(O(t.properties,"style/text/font")||"normal 12px Simsun").split(" "),a="";switch(t.geometry.type){case"Point":var o=O(t.properties,"style/svg-symbol/size")||{width:30,height:30};a=x(en)({id:t.properties.id,refType:"Point",ancchor:O(t.properties,"style/text/textAlign")||"left",x:i[0]+1*o.width/2,y:nn(i[1]),fontSize:1*Number(r[1].replace("px","")),fontFamily:r[2].replace("宋体","Simsun"),stroke:O(t.properties,"style/text/stroke/color")||"rgb(255,0,0)",fill:O(t.properties,"style/text/fill")||"rgb(255,255,255)",text:n});break;case"LineString":for(var s=0;s<i.length-1;s++){var l=i[s],c=i[s+1],u=[(l[0]+c[0])/2,(l[1]+c[1])/2],p=Math.atan2(c[1]-l[1],c[0]-l[0])*(180/Math.PI);a+=x(en)({id:t.properties.id+"_"+s,refType:"LineString",ancchor:O(t.properties,"style/text/textAlign")||"center",x:u[0],y:nn(u[1]),fontSize:1*Number(r[1].replace("px","")),fontFamily:r[2].replace("宋体","Simsun"),stroke:O(t.properties,"style/text/stroke/color")||"rgb(255,0,0)",fill:O(t.properties,"style/text/fill")||"rgb(255,255,255)",text:n,rotate:[u[0],u[1],p<0?180+p:p].join(",")})}}return a},ln=function(t,e){var n,i=[],r=null;r=t.type&&"FeatureCollection"==t.type?t.features:t;for(var a=0;a<r.length;a++){var o=r[a],s=o.geometry.type,l="";"Point"===s?l=rn(o):"LineString"===s?l=an(o):"Polygon"===s&&(l=on(o)),i.push(l);var c=sn(o);c&&i.push(c)}return x('<?xml version="1.0" encoding="UTF-8"?>\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:cim="http://iec.ch/TC57/2003/CIM-schema-cim10#" xmlns:PBD="urn:osisoft-com-data" width="<%= width %>" height="<%= height %>" viewBox="<%= originX %> <%= originY %> <%= widthV %> <%= heightV %>" preserveAspectRatio="xMidYMid">\n    <defs>\n<%= defsSymbols %>\n    </defs>\n    <g id="Head_layer"></g>\n    <g id="Main_layer">\n<%= content %>\n    </g>\n</svg>\n')({originX:e[0],originY:nn(e[3]),widthV:e[2]-e[0],heightV:e[3]-e[1],defsSymbols:(n=[],Object.keys(gt.prototype.defs).forEach((function(t){var e=gt.prototype.defs[t],i=e.originSize,r=x('       <symbol id="<%= id %>" viewBox="0 0 <%= width %> <%= height %>">\n            <%= symbolContent %>\n        </symbol>\n')({id:t,symbolContent:e.svg,width:i?i[0]:30,height:i?i[1]:30});n.push(r)})),n.join("")),content:i.join("")})},cn=n(453),un=n(1289),pn=n(1293),hn={name:"SearchFeature",mixins:[Ft],mounted:function(){var t=this;this.mapObject=new pn.a({placeholder:"输入搜索地点名称",source:new $.a,property:"name"}),L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent),this.parentContainer.addControl(this.mapObject),this.mapObject.getInputField().addEventListener("focus",function(t){this._setVectorSource(t)}.bind(this)),this.$nextTick((function(){t.$emit("ready",t.mapObject),t.mapObject.on("select",t._onSelectHandler.bind(t))}))},methods:{_setVectorSource:function(t){var e=this;e.mapObject.getSource().clear(),e.mapObject.getMap().getLayers().forEach((function(t){if(t.getSource()instanceof $.a){var n=t.getSource().getFeatures();e.mapObject.getSource().addFeatures(n)}}))},_bounce:function(t){var e=11*Math.PI/2,n=-Math.cos(e)*Math.pow(2,-.01);return t=1-Math.cos(t*Math.PI/2),(1+Math.abs(Math.cos(e*t))*Math.pow(2,-.01*t)+n*t)/2},_onSelectHandler:function(t){var e=t.search.getGeometry().getFirstCoordinate(),n=this.mapObject.getMap();n.getView().animate({center:e});var i=new N.a(new Lt.a(e));i.setStyle(new nt.c({image:new it.a({radius:30,stroke:new at.a({color:"red",width:2})})})),n.animateFeature(i,new un.a({fade:cn.b,duration:3e3,easing:this._bounce})),this.$emit("searched",t)}},render:function(){return null}},dn=Object(Dt.a)(hn,void 0,void 0,!1,null,null,null).exports,fn=n(515),mn={name:"Button",mixins:[Ft],props:{className:{type:String,default:""},title:{type:String,default:""},icon:{custom:!0,type:String,default:""},img:{custom:!0,type:String,default:""},symbol:{type:String,default:""},label:{type:String,default:""},target:{type:String,default:""}},mounted:function(){var t=this,e="";this.label?e=this.label:this.icon?e='<i class="'.concat(this.icon,'"></i>'):this.img?e='<img src="'.concat(this.img,'" width="20" height="20" style="cursor:pointer;"/>'):this.symbol&&(e=this.getSymbolHtml(this.symbol)),this.mapObject=new fn.a(Object(ze.a)({html:e,className:this.className,title:this.title,target:this.target,handleClick:function(t){this.$emit("onClick",t)}.bind(this)},"target",this.target)),L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent),this.parentContainer.mapObject.addControl(this.mapObject),this.$nextTick((function(){t.$emit("ready",t.mapObject);var e=t.mapObject.getButtonElement().querySelector("embed");e&&(e.onload=function(){console.log("加载完成")})}))},methods:{getMap:function(){return this.mapObject.getMap()},setIcon:function(t){var e='<i class="'.concat(t,'"></i>');this.mapObject.setHtml(e)},setImg:function(t){var e='<img src="'.concat(t,'" width="20" height="20" style="cursor:pointer;"/>');this.mapObject.setHtml(e)},setSymbol:function(t){var e=this.getSymbolHtml(t);this.mapObject.setHtml(e)},getSymbolHtml:function(t){var e="",n=this.$SvgSymbol.getSymbolDef(t);return n&&(e=n.canvas.toDataURL("images/png")),'<img src="'.concat(e,'" width="20" height="20" style="cursor:pointer;"/>')},getButtonElement:function(){return this.mapObject.getButtonElement()},onload:function(){console.log("onload")}},render:function(){return null}},gn=(n(1254),Object(Dt.a)(mn,void 0,void 0,!1,null,null,null).exports),yn=n(1255),bn={name:"TextButton",mixins:[Ft],props:{className:{type:String,default:null},title:{type:String,default:null},icon:{type:String,default:null},label:{custom:!0,type:String,default:null}},mounted:function(){var t=this;this.mapObject=new yn.a({html:this.label,className:this.className,title:this.title,handleClick:function(t){this.$emit("onClick",t)}.bind(this)}),L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent),this.parentContainer.mapObject.addControl(this.mapObject),this.$nextTick((function(){t.$emit("ready",t.mapObject)}))},methods:{getMap:function(){return this.mapObject.getMap()},setLabel:function(t){this.mapObject.setHtml(t)}},render:function(){return null}},vn=(n(1256),Object(Dt.a)(bn,void 0,void 0,!1,null,null,null).exports);z.a.prototype.setBar=function(t){this.subbar_=t,this.subbar_.setTarget(this.element),this.subbar_.element.classList.add("ol-option-bar")};var On={name:"Toggle",mixins:[Ft],props:{icon:{type:String,default:""},img:{type:String,default:""},label:{type:String,default:null},className:{type:String,default:""},title:{type:String,default:""},active:{type:Boolean,default:!1},disable:{type:Boolean,default:!1},autoActive:{type:Boolean,default:!1}},data:function(){return{ready:!1}},mounted:function(){var t=this,e="";this.label?e=this.label:this.icon?e='<i class="'.concat(this.icon,'"></i>'):this.img&&(e='<img src="'.concat(this.img,'" width="20" height="20" style="cursor:pointer;" />')),this.mapObject=new z.a({html:e,className:this.className,title:this.title,active:this.active,onToggle:function(t){this.$emit("onToggle",t)}.bind(this)}),L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent),this.parentContainer.addControl(this.mapObject),this.ready=!0,this.$nextTick((function(){t.$emit("ready",t.mapObject)}))},methods:{getMap:function(){return this.mapObject.getMap()},addInteraction:function(t){this.mapObject.getMap().addInteraction(t),this.mapObject.setInteraction(t),this.mapObject.setActive(this.mapObject.getActive())},addControl:function(t){this.mapObject.getMap().addControl(t)},setBar:function(t){this.mapObject.setBar(t)}}},wn=(n(1257),Object(Dt.a)(On,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticStyle:{display:"none"}},[this.ready?this._t("default"):this._e()],2)}),[],!1,null,null,null).exports),_n=n(545),xn=n(436),Sn={name:"ToggleSnap",props:{icon:{type:String,default:""},className:{type:String,default:""},title:{type:String,default:""},active:{type:Boolean,default:!1},disable:{type:Boolean,default:!1},autoActive:{type:Boolean,default:!1}},data:function(){return{ready:!1}},mounted:function(){var t=this;this.mapObject=new z.a({html:'<i class="'.concat(this.icon,'"></i>'),className:this.className,title:this.title,active:this.active,onToggle:function(t){this._onToggleHandle(t),this.$emit("onToggle",t)}.bind(this)}),L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent),this.parentContainer.addControl(this.mapObject),this.ready=!0,this.$nextTick((function(){t.$emit("ready",t.mapObject)}))},beforeDestroy:function(){if(this.mapObject){var t=this.mapObject.getMap();this.interaction&&t&&t.removeInteraction(this.interaction),t&&t.removeControl(this.mapObject)}},methods:{_onToggleHandle:function(t){var e=this.mapObject.getMap();t&&(this.interaction||(this.source=new $.a,this.interaction=new _n.a({features:new xn.a}),this.mapObject.setInteraction(this.interaction),e.addInteraction(this.interaction)))},clear:function(){this.interaction&&(this.interaction.getFeatures_().clear(),this.source.clear())},addFeature:function(t){this.interaction&&(this.interaction.getFeatures_().push(t,!0),this.source.addFeature(t))},addFeatures:function(t){var e=this;e.interaction&&(t.forEach((function(t){e.addFeature(t)})),this.source.addFeatures(t))},removeFeature:function(t){this.interaction&&(this.interaction.getFeatures_().remove(t),this.source.removeFeature(t))},removeFeatures:function(t){var e=this;Array.isArray(t)||(t=[t]),e.interaction&&t.forEach((function(t){e.removeFeature(t)}))},getFeaturesAtCoordinate:function(t){var e=[];if(this.source){var n=[t[0],t[1],t[0],t[1]];e=this.source.getFeaturesInExtent(n)}return e}},render:function(){return null}},Ln=(n(1258),Object(Dt.a)(Sn,void 0,void 0,!1,null,null,null).exports),jn=n(1259);jn.a.prototype.setPosition=function(t){this.element.classList.remove("ol-left","ol-top","ol-bottom","ol-right","targetleft"),t=t.split("-");for(var e=0;e<t.length;e++)switch(t[e]){case"top":case"left":case"bottom":case"right":case"targetleft":this.element.classList.add("ol-"+t[e])}};var Cn={name:"Bar",mixins:[Ft],props:{position:{type:String,default:""},visible:{type:Boolean,default:!0},className:{type:String,default:""},toggleOne:{type:Boolean,default:!1},group:{type:Boolean,default:!1},autoDeactivate:{type:Boolean,default:!1},target:{type:String,default:""}},data:function(){return{ready:!1}},mounted:function(){var t=this;this.mapObject=new jn.a({className:this.className,toggleOne:this.toggleOne,group:this.group,autoDeactivate:this.autoDeactivate,target:this.target}),this.mapObject.setPosition(this.position),L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent),"function"==typeof this.parentContainer.setBar&&this.parentContainer.setBar(this.mapObject),this.parentContainer.addControl(this.mapObject),this.ready=!0,this.$nextTick((function(){t.$emit("ready",t.mapObject),t.mapObject.setVisible(t.visible)}))},methods:{addControl:function(t){this.mapObject.addControl(t)},addInteraction:function(t){var e=this.getMap();e&&e.addInteraction(t)},getMap:function(){return this.mapObject.getMap()}}},kn=(n(1260),Object(Dt.a)(Cn,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticStyle:{display:"none"}},[this.ready?this._t("default"):this._e()],2)}),[],!1,null,null,null).exports),In=n(1291);In.a.prototype.drawPanel_=function(){if(!--this.dcount&&!this.dragging_){this._clearLayerForLI(),this.panel_.querySelectorAll("li").forEach(function(t){t.classList.contains("ol-header")||t.remove()}.bind(this));var t=this.getMap()?this.getMap().getLayers():new xn.a;this.drawList(this.panel_,this._layerGroup?this._layerGroup.getLayers():t)}};var Mn=In.a,Tn={name:"LayerSwitcher",mixins:[Ft],props:{showProgress:{type:Boolean,default:!1},mouseover:{type:Boolean,default:!1},reordering:{type:Boolean,default:!0},trash:{type:Boolean,default:!1},info:{type:Boolean,default:!1},extent:{type:Boolean,default:!0},onextent:{type:Function,default:function(){}},drawDelay:{type:Number,default:0},collapsed:{type:Boolean,default:!0}},mounted:function(){var t=C(this.$props,this);!0===this.info&&(t.oninfo=function(){}),this.mapObject=new Mn(t),!0===this.info&&this.mapObject.on("info",function(t){this.$emit("onInfo",t)}.bind(this)),I(this.mapObject,this.$listeners),L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent),this.parentContainer.addControl(this.mapObject)},render:function(t){return null}},An=Object(Dt.a)(Tn,void 0,void 0,!1,null,null,null).exports,En=n(1294),Fn={name:"Legend",mixins:[Ft],props:{className:{type:String,default:null},title:{type:String,default:"图例"},size:{type:Array,default:function(){return[40,25]}},margin:{type:Number,default:10},collapsed:{type:Boolean,default:!0},collapsible:{type:Boolean,default:!0},target:{type:String,default:null}},data:function(){return{ready:!1}},mounted:function(){var t=this;this.parentContainer=k(this.$parent);var e=C(this.$props,this);"function"==typeof this.parentContainer.isMapRoot&&this.parentContainer.isMapRoot()||(e.target=this.parentContainer.mapObject.element,e.title=" "),this.mapObject=new En.a(e),L(this,this.mapObject,this.$options.props),this.parentContainer.addControl(this.mapObject),this.ready=!0,this.$nextTick((function(){t.$emit("ready",t.mapObject)}))},methods:{addRow:function(t){this.mapObject.addRow(t)},addFeatures:function(t){Array.isArray(t)||(t=[t]),t.forEach(function(t,e){var n={title:t.get("title")||"图例"+e,feature:t};this.addRow(n)}.bind(this))},addControl:function(t){this.parentContainer.addControl(t)}}},Pn=Object(Dt.a)(Fn,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticStyle:{display:"none"}},[this.ready?this._t("default"):this._e()],2)}),[],!1,null,null,null).exports,Bn={name:"LegendItem",props:{geoType:{type:String,default:"Point"},properties:{custom:!0,type:Object,default:function(){return{}}},radius:{custom:!0,type:Number,default:3}},mounted:function(){var t=this,e=this._geometryFunction();this.mapObject=new N.a(Object.assign({geometry:e},this.properties)),L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent);var n=this.parentContainer.mapObject.getMap().getView(),i=n.getResolution(),r=n.getZoom(),a=Mt(this.mapObject,i,{mapMinZoomLevel:0,mapMaxZoomLevel:20,zoomLevel:r});this.mapObject.setStyle(a),this.parentContainer.addFeatures([this.mapObject]),this.$nextTick((function(){t.$emit("ready",t.mapObject),setTimeout(function(){this.parentContainer.mapObject.refresh()}.bind(t),1e3)}))},methods:{_geometryFunction:function(){var t=null;switch(this.geoType){case"Point":t=new Lt.a([0,0]);break;case"LineString":t=new ct.a([[0,0],[0,0]]);break;case"Polygon":t=new Ie.a([[[0,0],[0,0],[0,0]]]);break;case"Circle":t=new Me.a([0,0],this.radius)}return t}},render:function(){return null}},Dn=Object(Dt.a)(Bn,void 0,void 0,!1,null,null,null).exports,$n=n(1261),Nn=(Boolean,Boolean,Boolean,Boolean,Boolean,Boolean,Boolean,Boolean,Boolean,{name:"Overview",mixins:[Ft],props:{projection:{type:String,default:"EPSG:3857"},minZoom:{type:Number,default:0},maxZoom:{type:Number,default:18},rotation:{type:Boolean,default:!1},align:{custom:!0,type:String,default:"bottom-right"},layers:{type:Array,default:function(){return[]}},panAnimation:{type:Boolean,default:!0},collapsed:{type:Boolean,default:!0},extentStyle:{type:Object,default:function(){return{}}}},data:function(){return{ready:!1}},mounted:function(){var t=this,e=C(this.$props,this);e.style=[new nt.c({image:new it.a({fill:new rt.a({color:O(this.extentStyle,"image/fill")||"rgba(0,255,102, 1)"}),stroke:new at.a({width:O(this.extentStyle,"image/stroke/width")||7,color:O(this.extentStyle,"image/stroke/color")||"rgba(0,255,102, 0.8)"}),radius:O(this.extentStyle,"image/radius")||5}),stroke:new at.a({width:O(this.extentStyle,"stroke/width")||3,color:O(this.extentStyle,"stroke/color")||"rgba(255,0,0,1)",lineDash:O(this.extentStyle,"stroke/lineDash")||[0,0]})})],this.mapObject=new $n.a(e),this.mapObject.getOverviewMap().getLayers().getArray()[0].setZIndex(1e3),L(this,this.mapObject,this.$options.props),I(this.mapObject,this.$listeners),this.parentContainer=k(this.$parent),this.parentContainer.addControl(this.mapObject),this.ready=!0,this.$nextTick((function(){t.$emit("ready",t.mapObject)}))},methods:{addLayer:function(t){this.mapObject.getOverviewMap().addLayer(t.mapObject)},setAlign:function(t){this.mapObject.setPosition(t)}}}),zn=Object(Dt.a)(Nn,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticStyle:{display:"none"}},[this.ready?this._t("default"):this._e()],2)}),[],!1,null,null,null).exports,Gn=n(1262),Zn={name:"Overlay",mixins:[Ft],props:{className:{type:String,default:void 0},hideOnClick:{type:Boolean,default:!1},closeBox:{type:Boolean,default:!1}},data:function(){return{ready:!1}},mounted:function(){var t=this,e=C(this.$props,this);this.mapObject=new Gn.a(e),L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent),this.parentContainer.addControl(this.mapObject),"Toggle"===this.parentContainer.$options.name&&this.parentContainer.$on("onToggle",this.mapObject.toggle.bind(this.mapObject));for(var n=0;n<this.$slots.default.length;n++){var i=this.$slots.default[n].elm;i&&this.mapObject.element.appendChild(i)}this.ready=!0,this.$nextTick((function(){t.$emit("ready",t.mapObject)}))},methods:{getMap:function(){return this.mapObject.getMap()},addInteraction:function(t){this.mapObject.getMap().addInteraction(t)}}},Rn=Object(Dt.a)(Zn,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticStyle:{display:"none"}},[this._t("default")],2)}),[],!1,null,null,null).exports,Vn=n(458),Wn=n(443),Hn={name:"OLBasicSelect",props:{addCondition:{type:Function,default:function(){return!1}},condition:{type:Function,default:Wn.n},removeCondition:{type:Function,default:function(){return!1}},toggleCondition:{type:Function,default:Wn.m},filter:{type:Function,default:function(){return!0}},multi:{type:Boolean,default:!1},wrapX:{type:Boolean,default:!0},hitTolerance:{type:Number,default:0}},mounted:function(){var t=this,e=C(this.$props,this);this.mapObject=new Vn.a(e),this.mapObject.set("interactionType","ol-basic-select"),this.mapObject.set("interactionName","基础选择图形"),L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent),this.parentContainer.addInteraction(this.mapObject),I(this.mapObject,this.$listeners),this.$nextTick((function(){t.mapObject.set("$parent",t),t.$emit("ready",t.mapObject,t)}))},methods:{},render:function(){return null}},Un=(Object(Dt.a)(Hn,void 0,void 0,!1,null,null,null).exports,n(595)),Jn={beforeDestroy:function(){if(this.mapObject){var t=this.mapObject.getMap();t&&t.removeInteraction(this.mapObject)}},methods:{activeSelect:function(t){if(this.mapObject){var e=this.mapObject.getMap();if(e)e.getInteractions().forEach((function(e){e instanceof Vn.a&&e.setActive(t)}))}}}},Yn={name:"OLSelect",mixins:[Jn],props:{multi:{type:Boolean,default:!1},wrapX:{type:Boolean,default:!1},hitTolerance:{type:Number,default:10},color:{type:String,default:"blue"},active:{type:Boolean,default:!1},properties:{type:Object,default:function(){return{isOLSelect:!0}}},filter:{type:Function,default:function(t,e){return null!=e}}},mounted:function(){var t=this,e=this;this.parentContainer=k(this.$parent);var n=e.parentContainer.getMap(),i=n.getView(),r=b(this,"OLMap");r&&(this.mapComp=r);var a=C(this.$props,this);a.style=function(t,a){var o=i.getZoom(),s=i.getMaxZoom(),l=i.getMinZoom(),c=Mt(t,a,{type:"select",color:e.color,mapComp:r,mapObject:n,zoomLevel:o,mapMaxZoomLevel:s,mapMinZoomLevel:l});if("Point"===t.getGeometry().getType()){var u=e.getScaleRatio(e.mapObject.getMap(),t,a);c.getImage().setScale(u)}return c},this.mapObject=new Vn.a(a),this.mapObject.setProperties(this.properties),this.mapObject.setActive(this.active),this.parentContainer.addInteraction(this.mapObject),this.mapObject.set("interactionType","ol-select"),this.mapObject.set("interactionName","选择矢量图形"),L(this,this.mapObject,this.$options.props),I(this.mapObject,this.$listeners),this.dragBox=new Un.a({className:"drag-select-box",condition:Wn.j}),this.mapObject.setActive(this.mapObject.getActive()),n.addInteraction(this.dragBox);var o=this.mapObject.getFeatures();this.dragBox.on("boxend",function(t){var n=this.dragBox.getGeometry().getExtent();(function(t,e,n){var i=[];return t.getLayers().forEach((function(t){if(t instanceof e)if(n){var r=t.get("id")||t.get("layerId");void 0!==r&&r===n&&i.push(t)}else i.push(t)})),i})(e.mapObject.getMap(),D.a).forEach((function(t){t.getSource().forEachFeatureIntersectingExtent(n,(function(n){e.mapObject.filter_(n,t)&&(o.push(n),e.mapObject.addFeatureLayerAssociation_(n,t))}))})),t.selected=o.getArray(),t.deselected=[],t.type="selectbox",t.target=this.mapObject,this.$emit("select",t)}.bind(this)),this.dragBox.on("boxstart",function(){o.clear()}.bind(this)),this.mapObject.on("change:active",function(t){var e=t.target.get(t.key);this.dragBox.setActive(e),!e&&this.mapObject.getFeatures().clear()}.bind(this)),this.$nextTick((function(){t.dragBox.setActive(t.active),t.mapObject.set("$parent",t),t.$emit("ready",t.mapObject)}))},methods:{selectedFeatures:function(t){var e=this;Array.isArray(t)||(t=[t]);var n=this.mapObject.getFeatures();t.forEach((function(t){n.push(t),e.mapObject.addFeatureLayerAssociation_(t,v)}))},getFeatures:function(){return this.mapObject.getFeatures()},clear:function(){this.mapObject.getFeatures().clear()},getScaleRatio:function(t,e,n){var i=1,r=this.mapObject.getLayer(e),a=r?r.get("isSymbolsWithMapZoom"):null,o=r?r.get("initSymbolsZoomLevel"):null;return!0===a&&(i=t.getView().getMaxResolution()/(n||t.getView().getResolution()),o&&o>=0&&(i*=1/Math.pow(2,o))),i}},render:function(){return null}},Xn=(n(1263),Object(Dt.a)(Yn,void 0,void 0,!1,null,null,null).exports),Kn=n(547),qn=n(1264),Qn={name:"OLMeasure",mixins:[Jn],props:{geoType:{type:String,default:"LineString"},active:{type:Boolean,default:!1,custom:!0}},mounted:function(){var t=this;this.mapObject=new Kn.a({type:this.geoType}),this.mapObject.set("interactionType","ol-measure"),this.mapObject.set("interactionName","测量"),this.mapObject.getOverlay().set("select",!1),L(this,this.mapObject,this.$options.props),k(this.$parent),this.parentContainer=k(this.$parent),this.parentContainer.addInteraction(this.mapObject);var e=new qn.a;"function"==typeof this.parentContainer.mapObject.addOverlay?this.parentContainer.mapObject.addOverlay(e):this.parentContainer.mapObject.getMap().addOverlay(e),this.mapObject.on("drawstart",e.setFeature.bind(e)),this.mapObject.on(["change:active","drawend"],e.removeFeature.bind(e)),this.mapObject.setActive(this.active),this.$nextTick((function(){t.mapObject.set("$parent",t),t.$emit("ready",t.mapObject)}))},methods:{setActive:function(t){this.mapObject.setActive(t)}},render:function(){return null}},ti=Object(Dt.a)(Qn,(function(){var t=this.$createElement;return(this._self._c||t)("div")}),[],!1,null,null,null).exports,ei=(n(1265),n(35)),ni=n(205),ii=n(204),ri=n(439),ai=n(408),oi=n(415),si=n(466),li=n(542),ci=n(430),ui="Point",pi="LineString",hi="Polygon",di="drawstart",fi="drawend",mi=function(t){Object(ni.a)(n,t);var e=Object(ii.a)(n);function n(t,i){var r;return Object(ei.a)(this,n),(r=e.call(this,t)).feature=i,r}return n}(ci.a),gi=function(t){Kn.a.call(this,t)};Object(pt.d)(gi,Kn.a),gi.prototype.handleEvent=function(t){t.originalEvent.type===ai.a.CONTEXTMENU&&t.preventDefault(),this.freehand_=this.mode_!==ui&&this.freehandCondition_(t);var e=t.type===si.a.POINTERMOVE,n=!0;!this.freehand_&&this.lastDragTime_&&t.type===si.a.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,e=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0));return this.freehand_&&t.type===si.a.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(t),n=!1):this.freehand_&&t.type===si.a.POINTERDOWN?n=!1:e?(n=t.type===si.a.POINTERMOVE)&&this.freehand_?n=this.handlePointerMove_(t):(t.pointerEvent.pointerType==li.b||t.type===si.a.POINTERDRAG&&void 0===this.downTimeout_)&&(this.mode_===pi&&this.snapToTerminal(t),this.handlePointerMove_(t)):t.type===si.a.DBLCLICK&&(n=!1),ri.b.prototype.handleEvent.call(this,t)&&n},gi.prototype.snapToTerminal=function(t){var e=this.getMap(),n=null,i=null,r=null;if(e.forEachFeatureAtPixel(t.pixel,(function(t,e){if("Point"===t.getGeometry().getType())return(n=n||[]).push(t),r=e,i=e.get("layerId"),!0}),{hitTolerance:(this.snapTolerance_-1)/2,layerFilter:function(t){return t instanceof D.a&&!1!==t.get("displayInLayerSwitcher")}}),n&&n.length){var a=n[0],o=a.getGeometry().getFirstCoordinate().slice(0,2),s=e.getPixelFromCoordinate(o);this.snapped_={feature:a,layerId:i};var l=a.get("ports");if(!l||l.items.length<=0)return t.coordinate=o,t.pixel=s,this.snapped_.pixel=s.slice(0,2),void(this.snapped_.coordinate=o.slice(0,2));var c=a.get("style")||{},u=O(c,"image/svg-symbol/size")||a.get("size")||{width:30,height:30},h={width:u.width,height:u.height};if(r&&!0===r.get("isSymbolsWithMapZoom")){var d=r.get("initSymbolsZoomLevel"),f=this.getScaleRatio(e,d);h.width=h.width*f,h.height=h.height*f}for(var m=s[0]-h.width/2,g=s[1]-h.height/2,y=Number.MAX_VALUE,b=0;b<l.items.length;b++){var v=l.items[b],w=[m+parseFloat(v.args.x)/100*h.width,g+parseFloat(v.args.y)/100*h.height],_=Object(p.i)(t.pixel,w);_<y&&(t.pixel=w,y=_,this.snapped_.port=v,this.snapped_.pixel=t.pixel.slice(0,2))}t.coordinate=e.getCoordinateFromPixel(t.pixel),this.snapped_.coordinate=t.coordinate.slice(0,2)}else this.snapped_=null},gi.prototype.handleDownEvent=function(t){return this.snapped_&&(this.snapped_.pixel&&(t.pixel=this.snapped_.pixel.slice(0,2)),this.snapped_.coordinate&&(t.coordinate=this.snapped_.coordinate.slice(0,2))),Kn.a.prototype.handleDownEvent.call(this,t)},gi.prototype.handleUpEvent=function(t){return this.snapped_&&(this.snapped_.pixel&&(t.pixel=this.snapped_.pixel.slice(0,2)),this.snapped_.coordinate&&(t.coordinate=this.snapped_.coordinate.slice(0,2))),Kn.a.prototype.handleUpEvent.call(this,t)},gi.prototype.startDrawing_=function(t){var e=t.coordinate;this.finishCoordinate_=e,this.mode_===ui?this.sketchCoords_=e.slice():this.mode_===hi?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new N.a(new ct.a(this.sketchLineCoords_)));var n=this.geometryFunction_(this.sketchCoords_);if(this.sketchFeature_=new N.a,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(n),this.updateSketchFeatures_(),this.snapped_&&this.snapped_.feature&&this.mode_===pi){var i={id:this.snapped_.feature.get("id")};this.snapped_.port&&(i.port=this.snapped_.port.id),this.sketchFeature_.set("source",i),this.sketchFeature_.set("sourceElement",this.snapped_.feature),this.sketchFeature_.set("sourceLayerId",this.snapped_.layerId),this.snapped_=null}this.dispatchEvent(new mi(di,this.sketchFeature_))},gi.prototype.finishDrawing=function(){var t=this.abortDrawing_();if(t){var e=this.sketchCoords_,n=t.getGeometry();if(this.mode_===pi?(e.pop(),this.geometryFunction_(e,n)):this.mode_===hi&&(e[0].pop(),this.geometryFunction_(e,n),e=n.getCoordinates()),this.type_===oi.a.MULTI_POINT?t.setGeometry(new MultiPoint([e])):this.type_===oi.a.MULTI_LINE_STRING?t.setGeometry(new MultiLineString([e])):this.type_===oi.a.MULTI_POLYGON&&t.setGeometry(new MultiPolygon([e])),this.snapped_&&this.snapped_.feature&&this.mode_===pi){var i={id:this.snapped_.feature.get("id")};this.snapped_.port&&(i.port=this.snapped_.port.id),t.set("target",i),t.set("targetElement",this.snapped_.feature),t.set("targetLayerId",this.snapped_.layerId),this.snapped_=null}this.dispatchEvent(new mi(fi,t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t)}},gi.prototype.createOrUpdateSketchPoint_=function(t){var e=t.coordinate.slice();this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new N.a(new Lt.a(e)),this.updateSketchFeatures_());this.sketchPointStyle_?this.sketchPoint_.set("style",this.sketchPointStyle_):this.sketchPoint_.unset("style")},gi.prototype.setSketchPointStyle=function(t){this.sketchPointStyle_=t},gi.prototype.getScaleRatio=function(t,e){var n=1;return t&&e>=0&&(n=t.getView().getMaxResolution()/t.getView().getResolution(),e>=0&&(n*=1/Math.pow(2,e))),n};var yi=gi,bi={name:"OLDraw",mixins:[Jn],props:{geoType:{type:String,default:"Point"},clickTolerance:{type:Number,default:6},dragVertexDelay:{type:Number,default:500},snapTolerance:{type:Number,default:12},sketchStyle:{type:Object,default:function(){return null}},silentSvg:{type:Boolean,default:!0},isPortToCenter:{type:Boolean,default:!0}},data:function(){return{}},mounted:function(){var t=this,e=this,n=b(this,"OLMap");n&&(this.mapComp=n);var i={type:this.geoType,clickTolerance:this.clickTolerance,dragVertexDelay:this.dragVertexDelay,snapTolerance:this.snapTolerance};"Point"===this.geoType&&(i.style=this.styleFunction.bind(this)),this.sketchStyle&&(i.style=this.sketchStyle),this.mapObject=new yi(i),this.mapObject.set("interactionType","ol-draw-"+this.geoType.toLowerCase()),this.mapObject.set("interactionName","绘制图形"),this.mapObject.getOverlay().setProperties({displayInLayerSwitcher:!1,select:!1}),this.mapObject.on(["drawstart","drawend"],function(t){if("drawend"==t.type){var n=t.feature.get("id")||de();if(t.feature.setId(n),t.feature.set("id",n),"LineString"===t.feature.getGeometry().getType()&&!0===e.isPortToCenter){var i=t.feature.get("sourceElement"),r=t.feature.get("targetElement"),a=t.feature.getGeometry().getCoordinates();i&&(a[0]=i.getGeometry().getFirstCoordinate()),r&&(a[a.length-1]=r.getGeometry().getFirstCoordinate()),t.feature.getGeometry().setCoordinates(a)}}}.bind(this)),L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent),this.parentContainer.addInteraction(this.mapObject),I(this.mapObject,this.$listeners),this.$nextTick((function(){t.mapObject.set("$parent",t),t.$emit("ready",t.mapObject,t)}))},methods:{setSource:function(t){this.mapObject.source_=t},finishDrawing:function(){this.mapObject.finishDrawing()},removeLastPoint:function(){this.mapObject.removeLastPoint()},styleFunction:function(t,e){var n=this.mapObject.getMap().getView().getZoom(),i=this.mapComp.$props.maxZoom,r=this.mapComp.$props.minZoom;return Mt(t,e,{mapObject:this.mapObject.getMap(),mapComp:this.mapComp,zoomLevel:n,mapMaxZoomLevel:i,mapMinZoomLevel:r,silentSvg:this.silentSvg})},setSketchPointStyle:function(t){this.mapObject.setSketchPointStyle(t)}},render:function(){return null}},vi=Object(Dt.a)(bi,void 0,void 0,!1,null,null,null).exports,Oi=n(589),wi={name:"OLModify",mixins:[Jn],props:{pixelTolerance:{type:Number,default:10},wrapX:{type:Boolean,default:!1}},mounted:function(){var t=C(this.$props,this),e=new xn.a;t.features=e,this.mapObject=new Oi.a(t),this.mapObject.set("interactionType","ol-modify"),this.mapObject.set("interactionName","修改矢量图形"),L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent),this.parentContainer.addInteraction(this.mapObject),this.mapObject.on("change:active",function(t){"active"===t.key&&this.activeSelect(!1)}.bind(this)),this.mapObject.set("$parent",this)},methods:{clear:function(){this.mapObject.features_.clear()},addFeatures:function(t){this.mapObject.features_.extend(t)}},render:function(){return null}},_i=Object(Dt.a)(wi,void 0,void 0,!1,null,null,null).exports,xi=n(590),Si={name:"OLTranslate",mixins:[Jn],props:{pixelTolerance:{type:Number,default:10}},mounted:function(){var t=this,e=C(this.$props,this),n=new xn.a;e.features=n,this.mapObject=new xi.a(e),L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent),this.parentContainer.addInteraction(this.mapObject),this.mapObject.on("translatestart",function(t){var e=this;if(1==t.features.getLength()&&"Point"===t.features.item(0).getGeometry().getType()){var n=t.features.item(0).getGeometry().getFirstCoordinate();this.translateCoord_=n.slice();var i=t.target.getMap(),r=10,a=i.getLayers().getArray().find((function(e){var n=t.features.item(0).getId(),i=null;return e.getSource().getFeatureById&&(i=e.getSource().getFeatureById(n)),!!i})),o=a?a.get("initSymbolsZoomLevel"):null;if(o&&o>=0)r=30*(i.getView().getMaxResolution()/i.getView().getResolution()*(1/Math.pow(2,o)));var s=i.getPixelFromCoordinate(n);i.forEachFeatureAtPixel(s,(function(t){if("LineString"===t.getGeometry().getType()){e.links_=e.links_||[],e.links_.push(t),e.linksPoints_=e.linksPoints_||[];var n=t.getGeometry().getCoordinates(),i=n.length;e.linksPoints_.push({start:n[0].slice(),end:n[i-1].slice()})}}),{hitTolerance:r})}}.bind(this)),this.mapObject.on("translating",function(t){var e=t.features.item(0).getGeometry().getFirstCoordinate(),n=e[0]-this.translateCoord_[0],i=e[1]-this.translateCoord_[1],r=this.linksPoints_;this.links_&&this.links_.forEach((function(e,a){var o=e.get("source"),s=e.get("target"),l=null;t.features.item(0).getGeometry().getFirstCoordinate();(o&&o.id==t.features.item(0).get("id")&&((l=e.getGeometry().getCoordinates())[0]=[r[a].start[0]+n,r[a].start[1]+i]),s&&s.id==t.features.item(0).get("id"))&&((l=e.getGeometry().getCoordinates())[l.length-1]=[r[a].end[0]+n,r[a].end[1]+i]);l&&e.getGeometry().setCoordinates(l)}))}.bind(this)),this.mapObject.on("translateend",function(){this.links_=null,this.linksPoints_=[],this.translateCoord_=null}.bind(this)),this.mapObject.set("interactionType","ol-translate"),this.mapObject.set("interactionName","平移矢量图形"),I(this.mapObject,this.$listeners),this.$nextTick((function(){t.mapObject.set("$parent",t),t.$emit("ready",t.mapObject,t)}))},methods:{clear:function(){this.mapObject.features_.clear()},addFeatures:function(t){this.mapObject.features_.extend(t)},setFeatures:function(t){t instanceof xn.a?this.mapObject.features_=t:(this.clear(),this.addFeatures(t))}},render:function(){return null}},Li=Object(Dt.a)(Si,void 0,void 0,!1,null,null,null).exports,ji={name:"OLSnap",mixins:[Jn],props:{pixelTolerance:{type:Number,default:10},edge:{type:Boolean,default:!0},vertex:{type:Boolean,default:!0}},mounted:function(){var t=this,e=C(this.$props,this);e.features=new xn.a,this.mapObject=new _n.a(e),this.mapObject.set("interactionType","ol-snap"),this.mapObject.set("interactionName","捕捉"),this.parentContainer=k(this.$parent),this.parentContainer.addInteraction(this.mapObject),L(this,this.mapObject,this.$options.props),this.$nextTick((function(){t.mapObject.set("$parent",t),t.$emit("ready",t.mapObject)}))},methods:{clear:function(){this.mapObject.getFeatures_().clear()},addFeature:function(t){this.mapObject.addFeature(t)},addFeatures:function(t){var e=this;t.forEach((function(t){e.mapObject.addFeature(t)}))},removeFeature:function(t){this.mapObject.removeFeature(t)},removeFeatures:function(t){var e=this;t.forEach((function(t){e.mapObject.removeFeature(t)}))}},render:function(){return null}},Ci=Object(Dt.a)(ji,void 0,void 0,!1,null,null,null).exports,ki=n(1290);ki.a.prototype.handleDownEvent_=function(t){return this.current_=this.getFeatureAtPixel_(t),!!this.current_&&(this.currentStyle_=this.current_.feature.getStyle(),this.source_&&(this.get("duplicate")||t.originalEvent.ctrlKey)?(this.current_.feature=this.current_.feature.clone(),this.source_.addFeature(this.current_.feature)):this.dispatchEvent({type:"modifystart",features:[this.current_.feature]}),this.dispatchEvent({type:"offsetstart",feature:this.current_.feature,offset:0}),!0)};var Ii=ki.a,Mi={name:"OLOffset",mixins:[Jn],props:{duplicate:{type:Boolean,default:!1}},mounted:function(){var t=this,e=C(this.$props,this);this.mapObject=new Ii(e),this.mapObject.set("interactionType","ol-offset"),this.mapObject.set("interactionName","偏移矢量图形"),this.parentContainer=k(this.$parent),this.parentContainer.addInteraction(this.mapObject),L(this,this.mapObject,this.$options.props),I(this.mapObject,this.$listeners),this.mapObject.on("offsetend",function(t){var e=de();t.feature.setId(e),t.feature.set("id",e)}.bind(this)),this.$nextTick((function(){t.mapObject.set("$parent",t),t.$emit("ready",t.mapObject)}))},methods:{getSource:function(){this.mapObject.source_},setSource:function(t){this.mapObject.source_=t}},render:function(){return null}},Ti=Object(Dt.a)(Mi,void 0,void 0,!1,null,null,null).exports,Ai=n(1266),Ei={name:"OLTransform",mixins:[Jn],props:{hitTolerance:{type:Number,default:0},translate:{type:Boolean,default:!0},translateBBox:{type:Boolean,default:!0},stretch:{type:Boolean,default:!0},scale:{type:Boolean,default:!0},rotate:{type:Boolean,default:!0},noFlip:{type:Boolean,default:!1},selection:{type:Boolean,default:!0},enableRotatedTransform:{type:Boolean,default:!0},filter:{type:Function}},mounted:function(){var t=this,e=C(this.$props,this);this.mapObject=new Ai.a(e),this.mapObject.set("interactionType","ol-transform"),this.mapObject.set("interactionName","变换矢量图形"),this.parentContainer=k(this.$parent),this.parentContainer.addInteraction(this.mapObject),L(this,this.mapObject,this.$options.props),I(this.mapObject,this.$listeners),this.$nextTick((function(){t.mapObject.set("$parent",t),t.$emit("ready",t.mapObject)}))},methods:{getSource:function(){this.mapObject.source_},setSource:function(t){this.mapObject.source_=t}},render:function(){return null}},Fi=Object(Dt.a)(Ei,void 0,void 0,!1,null,null,null).exports,Pi=n(1267),Bi={name:"OLCopyPaste",mixins:[Jn],props:{sources:{type:Object,default:function(){return null}},destination:{type:Object,default:function(){return null}}},mounted:function(){var t=this,e=C(this.$props,this);e.condition=function(t){if(t.originalEvent.ctrlKey){if(/^C$/i.test(t.originalEvent.key))return"copy";if(/^X$/i.test(t.originalEvent.key))return"cut";if(/^V$/i.test(t.originalEvent.key))return"paste"}return!1}.bind(this),this.mapObject=new Pi.a(e);var n=this;this.mapObject.on("copy",(function(t){this.features=n.getSelectedCopy()})),this.mapObject.on("paste",(function(t){n.selectedPasteFeatures(t)})),this.mapObject.set("interactionType","ol-copy-paste"),this.mapObject.set("interactionName","复制粘贴"),this.parentContainer=k(this.$parent),this.parentContainer.addInteraction(this.mapObject),L(this,this.mapObject,this.$options.props),I(this.mapObject,this.$listeners),this.format=new P.a,this.$nextTick((function(){t.mapObject.set("$parent",t),t.$emit("ready",t.mapObject)}))},methods:{getDestination:function(){this.mapObject.getDestination()},setDestination:function(t){this.mapObject.setDestination(t)},getSources:function(){this.mapObject.getSources()},setSources:function(t){this.mapObject.setSources(t)},getSelectedCopy:function(){this.mapComp||(this.mapComp=b(this,"OLMap"));var t=this,e=[];return this.mapComp&&this.mapComp.mapObject.getInteractions().forEach((function(n){if(n instanceof Vn.a&&!0===n.get("isOLSelect")){t.selectInteraction=n;var i={},r=[],a={};n.getFeatures().forEach((function(t){var n=Object.assign({},t.getProperties());delete n.geometry,delete n.sourceElement,delete n.targetElement;var o=JSON.parse(JSON.stringify(n)),s=t.clone();s.setProperties(o);var l=t.get("id"),c=de();switch(s.setId(c),s.set("id",c),s.getGeometry().getType()){case"Point":var u=s.get("ports");u&&u.items&&u.items.forEach((function(t){a[l+"@"+t.group]=t.id,t.id=c+"@"+t.group})),i[l]=s;break;case"LineString":(s.get("source")||s.get("target"))&&r.push(s)}e.push(s)})),r.forEach((function(t){var e=t.get("source"),n=t.get("target");if(e&&e.id&&i[e.id]){var r=e.id,o=i[r].get("id");if(e.id=o,e.port){var s=i[r].get("ports");s&&s.items.forEach((function(t){var n=r+"@"+t.group;a[n]===e.port&&(e.port=t.id)})),t.set("sourceElement",i[r])}}if(n&&n.id&&i[n.id]){var l=n.id,c=i[l].get("id");if(n.id=c,n.port){var u=i[l].get("ports");u&&u.items.forEach((function(t){var e=l+"@"+t.group;a[e]===n.port&&(n.port=t.id)})),t.set("targetElement",i[l])}}}))}})),e},selectedPasteFeatures:function(t){if(this.selectInteraction){var e=this.selectInteraction.getFeatures();e.clear(),e.extend(t.features)}}},render:function(){return null}},Di=Object(Dt.a)(Bi,void 0,void 0,!1,null,null,null).exports,$i=n(1268),Ni={name:"OLFocusMap",mixins:[Jn],props:{},mounted:function(){var t=this;C(this.$props,this);this.mapObject=new $i.a,this.mapObject.set("interactionType","ol-focus-map"),this.mapObject.set("interactionName","使地图获取焦点"),this.parentContainer=k(this.$parent),this.parentContainer.addInteraction(this.mapObject),L(this,this.mapObject,this.$options.props),this.$nextTick((function(){t.mapObject.set("$parent",t),t.$emit("ready",t.mapObject)}))},methods:{},render:function(){return null}},zi=Object(Dt.a)(Ni,void 0,void 0,!1,null,null,null).exports,Gi=n(437),Zi=n(423),Ri=n(417),Vi=function t(e){var n=e||{};this.source_=n.source?n.source:null,this.features_=n.features?n.features:null,this.radius_=n.radius?n.radius:1e3,Gi.a.call(this,{handleEvent:t.handleEvent}),this.filter_="function"==typeof n.filter?n.filter:Zi.b;var i=new D.a({displayInLayerSwitcher:void 0!==n.displayInLayerSwitcher&&n.displayInLayerSwitcher,source:new $.a({useSpatialIndex:!1,wrapX:n.wrapX}),style:n.style?n.style:t.getDefaultStyleFunction(),updateWhileAnimating:!0,updateWhileInteracting:!0});this.featureOverlay_=i};Object(pt.d)(Vi,Gi.a),Vi.prototype.setMap=function(t){Gi.a.prototype.setMap.call(this,t),this.featureOverlay_.setMap(t)},Vi.prototype.setSource=function(t){this.source_=t},Vi.prototype.getSource=function(){this.source_},Vi.prototype.setRadius=function(t){this.radius_=t},Vi.prototype.getRadius=function(){this.radius_},Vi.prototype.setCenter=function(t){var e=this.doSreach(t);this.showResult(e)},Vi.prototype.showResult=function(t){var e=this.featureOverlay_.getSource();e.clear(),e.addFeatures(t),this.bufferCircle&&e.addFeatures([this.bufferCircle])},Vi.prototype.getBufferCircle=function(t,e){var n=Object(Te.d)(t,e,0),i=new Lt.a(n).transform("EPSG:4326","EPSG:3857").getFirstCoordinate(),r=new Lt.a(t).transform("EPSG:4326","EPSG:3857").getFirstCoordinate(),a=new Me.a([NaN,NaN]),o=Object(p.i)(r,i);return a.setCenterAndRadius(r,Math.sqrt(o)),new N.a({geometry:a})},Vi.prototype.doSreach=function(t,e){var n=[];e=e||this.radius_;var i=null;this.source_?i=this.source_.getFeatures():this.features_&&(i=this.features_);var r=Object(h.m)(t),a=this.getBufferCircle(r,e);return this.bufferCircle=a,i&&i.forEach((function(t){var i=t.getGeometry();if("Point"===i.getType()){var a=Object(h.m)(i.getFirstCoordinate());Object(Te.b)(r,a)<=e&&n.push(t)}})),n},Vi.handleEvent=function(t){var e=!1;if(t.type==si.a.CLICK){t.map;var n=t.coordinate,i=this.doSreach(n);this.showResult(i),this.dispatchEvent(new Wi("mapclick",t,i)),t.preventDefault(),e=!0}return!e},Vi.getDefaultStyleFunction=function(){var t=Object(nt.b)();Object(Ri.c)(t[oi.a.POLYGON],t[oi.a.LINE_STRING]),Object(Ri.c)(t[oi.a.GEOMETRY_COLLECTION],t[oi.a.LINE_STRING]);var e=new nt.c({stroke:new at.a({color:"red",width:2}),fill:new rt.a({color:"rgba(255,0,0,0.2)"})});return Object(Ri.c)(t[oi.a.CIRCLE],e),function(e,n){return e.getGeometry()?t[e.getGeometry().getType()]:null}};var Wi=function(t,e,n){ci.a.call(this,t),this.mapBrowserEvent=e,this.sreachFeatures=n};Object(pt.d)(Wi,ci.a);var Hi,Ui=Vi,Ji={name:"OLDistanceSearch",mixins:[Jn],props:{active:{type:Boolean,default:!1},displayInLayerSwitcher:{type:Boolean,default:!1},radius:{type:Number,default:1e3},center:{type:Array,default:function(){return[0,0]}}},mounted:function(){var t=C(this.$props,this);this.mapObject=new Ui(t),this.mapObject.set("interactionType","ol-distance-search"),this.mapObject.set("interactionName","距离查找"),L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent),this.parentContainer.addInteraction(this.mapObject),I(this.mapObject,this.$listeners),this.mapObject.set("$parent",this)},methods:{setSource:function(t){this.mapObject.setSource(t)},doSreach:function(){}},render:function(){return null}},Yi=Object(Dt.a)(Ji,void 0,void 0,!1,null,null,null).exports,Xi=n(733),Ki={name:"UndoRedo",mixins:[Jn],props:{active:{type:Boolean,default:!0}},mounted:function(){var t=this;this.mapObject=new Xi.a,this.mapObject.set("interactionType","ol-undoredo"),this.mapObject.set("interactionName","撤销重做"),L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent),this.parentContainer.addInteraction(this.mapObject),I(this.mapObject,this.$listeners),this.mapObject.setActive(this.active),this.$nextTick((function(){t.mapObject.set("$parent",t),t.$emit("ready",t.mapObject)}))},methods:{blockEnd:function(){this.mapObject.blockEnd()},blockStart:function(){this.mapObject.blockStart()},hasRedo:function(){return this.mapObject.hasRedo()},hasUndo:function(){return this.mapObject.hasUndo()},clear:function(){this.mapObject.clear()},redo:function(){this.mapObject.redo()},undo:function(){this.mapObject.undo()}},render:function(){return null}},qi=Object(Dt.a)(Ki,void 0,void 0,!1,null,null,null).exports,Qi=n(1269),tr={name:"OLFillAttribute",props:{active:{type:Boolean,default:!0},cursor:{type:Boolean,default:!0},properties:{custom:!0,type:Object,default:function(){return Object.assign({})}}},mounted:function(){var t=this;this.mapObject=new Qi.a({active:this.active,cursor:this.cursor},this.properties||{}),this.mapObject.set("interactionType","ol-fillattribute"),this.mapObject.set("interactionName","设置填充色属性"),L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent),this.parentContainer.addInteraction(this.mapObject),I(this.mapObject,this.$listeners),this.$nextTick((function(){t.mapObject.set("$parent",t),t.$emit("ready",t.mapObject)}))},methods:{setProperties:function(t,e){this.mapObject.setAttributes(t)},setAttributes:function(t){this.setProperties(t)},setAttribute:function(t,e){this.mapObject.setAttribute(t,e)},fill:function(t,e){this.mapObject.fill(t,e)}},render:function(){return null}},er=Object(Dt.a)(tr,void 0,void 0,!1,null,null,null).exports,nr=n(1270),ir={name:"OLDelete",props:{},mounted:function(){var t=this;this.mapObject=new nr.a,this.mapObject.set("interactionType","ol-delete"),this.mapObject.set("interactionName","删除矢量图形"),this.parentContainer=k(this.$parent),this.parentContainer.addInteraction(this.mapObject),I(this.mapObject,this.$listeners),this.$nextTick((function(){t.mapObject.set("$parent",t),t.$emit("ready",t.mapObject)}))},methods:{delete:function(t){this.mapObject.delete(t)}},render:function(){return null}},rr=Object(Dt.a)(ir,void 0,void 0,!1,null,null,null).exports,ar={name:"BarUndoRedo",components:{OLBar:kn,OLButton:gn,OLUndoRedo:qi},props:{undoIcon:{type:String,default:"fa fa-undo"},redoIcon:{type:String,default:"fa fa-repeat"}},methods:{_handleUndoClick:function(t){this.$refs.undoInteraction.undo()},_handleRedoClick:function(t){this.$refs.undoInteraction.redo()},clear:function(){this.$refs.undoInteraction.clear()}}},or=Object(Dt.a)(ar,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("OLBar",[n("OLButton",{attrs:{title:"撤销",icon:t.undoIcon},on:{onClick:t._handleUndoClick}}),t._v(" "),n("OLButton",{attrs:{title:"重做",icon:t.redoIcon},on:{onClick:t._handleRedoClick}}),t._v(" "),n("OLUndoRedo",t._g({ref:"undoInteraction"},t.$listeners))],1)}),[],!1,null,null,null).exports,sr={name:"ToggleFillAttribute",components:{OLToggle:wn,OLBar:kn,OLButton:gn},props:{label:{type:String,default:""},title:{type:String,default:"设置颜色"},icon:{type:String,default:""},colors:{type:Array,default:function(){return[{color:"red",title:"红色"},{color:"green",title:"绿色"},{color:"blue",title:"蓝色"}]}}},watch:{colors:function(t){var e=[];t.forEach((function(t){e.push({color:t.color,text:t.text})})),this.colorList=e}},data:function(){return{colorList:this.colors,currentColor:"red"}},mounted:function(){},methods:{_handlerReady:function(t){},_handlerBtnReady:function(t,e){var n=t.getButtonElement();n.style.color=e,n.style.backgroundColor=e},_handlerClick:function(t,e){this.currentColor=e,this._handlerSetattributestart()},_handlerSetattributestart:function(t){var e=this.getSelected();if(1==e.length){var n=this.getUndoRedoInteraction(),i=e[0].get("style"),r=i?JSON.parse(JSON.stringify(i)):{},a=i?JSON.parse(JSON.stringify(i)):{},o=e[0].getGeometry().getType(),s=this.currentColor;"Point"===o?O(a,"image/circle")?(w(a,"image/circle/stroke/color",s),w(a,"image/circle/stroke/fill",s)):O(a,"image/font-symbol")?w(a,"image/font-symbol/stroke",s):O(a,"image/svg-symbol")&&w(a,"image/svg-symbol/stroke/color",s):"Polygon"===o?(w(a,"stroke/color",s),w(a,"fill",s)):Array.isArray(a.stroke)?w(a,"stroke/0/color",s):w(a,"stroke/color",s),e[0].set("style",a),n&&n.push("style",{feature:e[0],after:a,before:r})}else this.$message&&this.$message({message:"请选中一个图形",type:"warning"})},getSelected:function(){var t=b(this.$parent,"OLMap"),e=[];return t&&(this.mapComp=t,t.mapObject.getInteractions().forEach((function(t){t instanceof Vn.a&&!0===t.get("isOLSelect")&&t.getFeatures().forEach((function(t){e.push(t)}))}))),e},getUndoRedoInteraction:function(){if(this.undoredoInteraction)return this.undoredoInteraction;var t=null;return this.mapComp||(this.mapComp=b(this.$parent,"OLMap")),this.mapComp.mapObject.getInteractions().forEach((function(e){e instanceof Xi.a&&(t=e)})),this.undoredoInteraction=t,this.defineStyleAction(t),t},defineStyleAction:function(t){t&&t.define("style",(function(t){var e=t.before;t.feature.set("style",e)}),(function(t){var e=t.after;t.feature.set("style",e)}))}}},lr=(n(1271),Object(Dt.a)(sr,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("OLToggle",{attrs:{label:t.label,icon:t.icon,title:t.title}},[n("OLBar",t._l(t.colorList,(function(e,i){return n("OLButton",{key:"color-"+i,attrs:{className:"color",title:e.title},on:{ready:function(n){return t._handlerBtnReady(n,e.color)},onClick:function(n){return t._handlerClick(n,e.color)}}})})),1)],1)}),[],!1,null,null,null).exports),cr={name:"ButtonSave",mixins:[Ft],props:{className:{type:String,default:""},title:{type:String,default:"保存"},icon:{custom:!0,type:String,default:"fa-save"},isTip:{type:Boolean,default:!0},saveBefore:{type:Function,default:function(){return!0}},MenuID:{type:String,default:"0042"}},mounted:function(){var t=this,e=b(this,"OLMap");e&&(this.transformFn=e.transformFn,this.unTransformFn=e.unTransformFn||function(t,e){return e},this.mapComp=e),this.mapObject=new fn.a({html:'<i class="'.concat(this.icon,'"></i>'),title:this.title,handleClick:function(t){this.$emit("onClick"),this._handlerClick(t)}.bind(this)}),L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent),this.parentContainer.addControl(this.mapObject),this.format=new P.a({dataProjection:"EPSG:4326"}),this.formatWkT=new B.a({dataProjection:"EPSG:4326"}),this.$nextTick((function(){t.$emit("ready",t.mapObject)}))},methods:{_handlerClick:function(t){var e=this,n=this,i=this.getSource();if(i){var r=[];i.getFeatures().forEach((function(t){var i=t.clone();n.transfromToWGS84Coordinates(i);var a=i.get("sourceElement");if(a instanceof N.a){var o=a.clone();n.transfromToWGS84Coordinates(o);var s=n.format.writeFeatureObject(o);i.set("sourceElement",s)}var l=i.get("targetElement");if(l instanceof N.a){var c=l.clone();n.transfromToWGS84Coordinates(c);var u=n.format.writeFeatureObject(c);i.set("targetElement",u)}var p=e.formatWkT.writeFeature(i);i.set("textWKT",p),r.push(i);var h=t.clone();h.getGeometry().transform("EPSG:3857","EPSG:4326");var d=e.formatWkT.writeFeature(h);i.set("viewTextWKT",d)}));var a=this.format.writeFeaturesObject(r);console.log(a),!1!==this.saveBefore(a)&&this.save(a)}else console.warn("请设置数据源")},transfromToWGS84Coordinates:function(t){if("function"==typeof this.unTransformFn){var e=t.getGeometry(),n=e.getType(),i=e.getCoordinates(),r=this.unTransformFn(n,i);e.setCoordinates(r)}},save:function(t){var e=this,n=this,i={},r=this.getSourceLayer().getProperties();i.MenuID=this.MenuID,Ye(t,r,!1,null,i).then((function(t,i){e.isTip&&n.$message({message:"保存成功",type:"success"})})).catch((function(t){console.log(t.stack),n.$message.error("保存失败")}))},setSource:function(t,e){t.mapObject?(this.sourceComp=t,this.source=t.mapObject):this.source=t,this.vectorLayer=e},getSource:function(){return this.source},getSourceLayer:function(){var t=null;return this.vectorLayer?t=this.vectorLayer:this.sourceComp&&(t=this.sourceComp.parentContainer.mapObject),t}},render:function(){return null}},ur=Object(Dt.a)(cr,void 0,void 0,!1,null,null,null).exports,pr=(n(1272),n(1273),n(716)),hr=n.n(pr),dr=n(0),fr={mixins:[At],data:function(){return{dialogFormVisible:!0,mapObject:null,expType:"0",mapContentTitle:"",isWithBaseLayer:!0,bbox:{minLon:"",minLat:"",maxLon:"",maxLat:""},scales:[559082263.9508929,279541131.97544646,139770565.98772323,69885282.99386162,34942641.49693081,17471320.748465404,8735660.374232702,4367830.187116351,2183915.0935581755,1091957.5467790877,545978.7733895439,272989.38669477194,136494.69334738597,68247.34667369298,34123.67333684649,17061.836668423246,8530.918334211623,4265.4591671058115,2132.7295835529058],mapZoomLevel:"",pixelWidth:"",pixelHeight:"",titlePosition:"top,right",titleFontSize:18,titleFontColor:"#000000",fontSizeList:new Array(36),WORLD_ENVELOPE:[-20037508.34,-20037508.34,20037508.34,20037508.34]}},methods:{_onOk:function(){this.ok&&this.ok()},_handlerClosed:function(){this.$destroy(),this.$el.remove()},_onSelectBBox:function(){var t=this;this.zIndex=this.$el.style.zIndex,this.$el.style.zIndex=-1;var e=document.querySelector(".v-modal");e&&(this.modalZIndex=e.style.zIndex,this.modalDiv=e,this.modalDiv.style.zIndex=-1),this.dragBox=new Un.a({className:"drag-select-box"}),this.excludeIneractionActive(!1),this.mapObject.addInteraction(this.dragBox),this.dragBox.on("boxend",function(e){var n=this.dragBox.getGeometry().getExtent();t.bbox.minLon=n[0],t.bbox.minLat=n[1],t.bbox.maxLon=n[2],t.bbox.maxLat=n[3],t.$emit("selectExpBBoxEnd",n),t.mapObject.removeInteraction(t.dragBox),t.modalDiv&&(t.modalDiv.style.zIndex=this.modalZIndex),t.$el.style.zIndex=t.zIndex,t.setPixelWidthAndHeight()}.bind(this)),this.dragBox.setActive(!0)},_handleScaleBtn:function(){this.mapZoomLevel=this.mapObject.getView().getZoom()},_handlerScaleChange:function(){this.bbox.minLon&&this.bbox.minLat&&this.bbox.maxLon&&this.bbox.maxLat?this.setPixelWidthAndHeight():(this.pixelWidth="",this.pixelHeight="")},setPixelWidthAndHeight:function(){var t=this.mapZoomLevel||this.mapObject.getView().getZoom(),e=this.bbox.maxLon-this.bbox.minLon,n=this.bbox.maxLat-this.bbox.minLat,i=this.WORLD_ENVELOPE[2]-this.WORLD_ENVELOPE[0],r=this.WORLD_ENVELOPE[3]-this.WORLD_ENVELOPE[1];this.pixelWidth=Math.floor(256*Math.pow(2,t)*e/i)-1,this.pixelHeight=Math.floor(256*Math.pow(2,t)*n/r)}}},mr=Object(Dt.a)(fr,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{visible:t.dialogFormVisible,title:"导出image",width:"500px",modal:!0,"append-to-body":!0,"show-close":!1,"destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogFormVisible=e},closed:t._handlerClosed}},[n("el-form",{attrs:{"label-position":"right","label-width":"105px",size:"mini",model:t.bbox}},[n("el-form-item",{attrs:{label:"导出类型：","label-width":"120px"}},[n("el-radio-group",{model:{value:t.expType,callback:function(e){t.expType=e},expression:"expType"}},[n("el-radio",{attrs:{label:"0"}},[t._v("当前内容")]),t._v(" "),n("el-radio",{attrs:{label:"1"}},[t._v("指定范围")])],1)],1),t._v(" "),"1"==t.expType?n("el-form-item",{attrs:{label:""}},[n("el-checkbox",{model:{value:t.isWithBaseLayer,callback:function(e){t.isWithBaseLayer=e},expression:"isWithBaseLayer"}},[t._v("基础底图")])],1):t._e(),t._v(" "),"1"==t.expType?n("el-form-item",{attrs:{label:"标题设置:"}},[n("el-row",{attrs:{type:"flex",justify:"end"}},[n("el-col",{attrs:{span:4}},[n("label",[t._v("内容")])]),t._v(" "),n("el-col",{attrs:{span:20}},[n("el-input",{attrs:{placeholder:"输入标题内容"},model:{value:t.mapContentTitle,callback:function(e){t.mapContentTitle=e},expression:"mapContentTitle"}})],1)],1),t._v(" "),n("el-row",{attrs:{type:"flex",justify:"end"}},[n("el-col",{attrs:{span:4}},[n("label",[t._v("位置")])]),t._v(" "),n("el-col",{attrs:{span:20}},[n("el-select",{attrs:{placeholder:"标题位置"},model:{value:t.titlePosition,callback:function(e){t.titlePosition=e},expression:"titlePosition"}},[n("el-option",{attrs:{label:"顶部靠左",value:"top,left"}}),t._v(" "),n("el-option",{attrs:{label:"顶部居中",value:"top,center"}}),t._v(" "),n("el-option",{attrs:{label:"顶部靠右",value:"top,right"}}),t._v(" "),n("el-option",{attrs:{label:"靠左居中",value:"center,left"}}),t._v(" "),n("el-option",{attrs:{label:"居中",value:"center,center"}}),t._v(" "),n("el-option",{attrs:{label:"靠右居中",value:"center,right"}}),t._v(" "),n("el-option",{attrs:{label:"底部靠左",value:"bottom,left"}}),t._v(" "),n("el-option",{attrs:{label:"底部居中",value:"bottom,center"}}),t._v(" "),n("el-option",{attrs:{label:"底部靠右",value:"bottom,right"}})],1)],1)],1),t._v(" "),n("el-row",{attrs:{type:"flex",justify:"end"}},[n("el-col",{attrs:{span:4}},[n("label",{staticClass:"demonstration"},[t._v("大小")])]),t._v(" "),n("el-col",{attrs:{span:20}},[n("el-select",{attrs:{placeholder:""},model:{value:t.titleFontSize,callback:function(e){t.titleFontSize=e},expression:"titleFontSize"}},t._l(t.fontSizeList,(function(t,e){return n("el-option",{key:e+1,attrs:{label:e+1,value:e+1}})})),1)],1)],1),t._v(" "),n("el-row",{attrs:{type:"flex",justify:"end"}},[n("el-col",{attrs:{span:4}},[n("label",{staticClass:"demonstration"},[t._v("颜色")])]),t._v(" "),n("el-col",{attrs:{span:20}},[n("el-color-picker",{model:{value:t.titleFontColor,callback:function(e){t.titleFontColor=e},expression:"titleFontColor"}})],1)],1)],1):t._e(),t._v(" "),"1"==t.expType?n("el-form-item",{attrs:{label:"范围:"}},[n("el-button",{on:{click:t._onSelectBBox}},[t._v("框选范围")]),t._v(" "),n("el-input",{attrs:{placeholder:"左侧坐标"},model:{value:t.bbox.minLon,callback:function(e){t.$set(t.bbox,"minLon",e)},expression:"bbox.minLon"}}),t._v(" "),n("el-input",{attrs:{placeholder:"底部坐标"},model:{value:t.bbox.minLat,callback:function(e){t.$set(t.bbox,"minLat",e)},expression:"bbox.minLat"}}),t._v(" "),n("el-input",{attrs:{placeholder:"右侧坐标"},model:{value:t.bbox.maxLon,callback:function(e){t.$set(t.bbox,"maxLon",e)},expression:"bbox.maxLon"}}),t._v(" "),n("el-input",{attrs:{placeholder:"顶部坐标"},model:{value:t.bbox.maxLat,callback:function(e){t.$set(t.bbox,"maxLat",e)},expression:"bbox.maxLat"}})],1):t._e(),t._v(" "),"1"==t.expType?n("el-form-item",{attrs:{label:"比例尺:"}},[n("el-row",[n("el-col",{attrs:{span:16}},[n("el-select",{attrs:{placeholder:"请选择比例尺"},on:{change:t._handlerScaleChange},model:{value:t.mapZoomLevel,callback:function(e){t.mapZoomLevel=e},expression:"mapZoomLevel"}},t._l(t.scales,(function(t,e){return n("el-option",{key:e,attrs:{label:"1: "+(t>100?100*Math.round(t/100):Math.round(t)),value:e}})})),1)],1),t._v(" "),n("el-col",{attrs:{span:7}},[n("el-button",{attrs:{size:"mini"},on:{click:t._handleScaleBtn}},[t._v("设置为当前比例尺")])],1)],1)],1):t._e(),t._v(" "),"1"==t.expType?n("el-form-item",{attrs:{label:"像素宽高:"}},[n("el-row",[n("el-col",{attrs:{span:12}},[n("el-input",{attrs:{disabled:"",placeholder:"宽度"},model:{value:t.pixelWidth,callback:function(e){t.pixelWidth=e},expression:"pixelWidth"}})],1),t._v(" "),n("el-col",{attrs:{span:12}},[n("el-input",{attrs:{disabled:"",placeholder:"高度"},model:{value:t.pixelHeight,callback:function(e){t.pixelHeight=e},expression:"pixelHeight"}})],1)],1)],1):t._e()],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("关闭")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t._onOk}},[t._v("获取内容")])],1)],1)}),[],!1,null,null,null).exports,gr=dr.default.extend(mr),yr=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=document.body,n=document.createElement("div");e.appendChild(n);var i=new gr({el:n,data:t});return i},br={name:"ButtonExport",mixins:[Tt],props:{icon:{type:String,default:"fa-download"},geoJsonIcon:{type:String,default:"fa-file-o"},svgIcon:{type:String,default:"fa-file-text-o"},dxfIcon:{type:String,default:"fa-file-code-o"},pngIcon:{type:String,default:"fa-file-image-o"},pdfIcon:{type:String,default:"fa-file-pdf-o"},currentLayer:{type:Object,default:{}},layers:{type:Array,default:[]},maxRenderMemory:{type:Number,default:67108864}},methods:{setSource:function(t){this.source},getLayerSources:function(){var t,e=[];return null==this.currentLayer?(this.$parent.mapObject.getMap().getLayers().forEach((function(t){t instanceof D.a&&e.push(t.getSource())})),t=e):t=this.currentLayer.getSource(),t},_handlerExpGeoJSON:function(){var t=this.getLayerSources();if(Array.isArray(t)||(t=[t]),t.length>0){var e=this,n={type:"FeatureCollection",features:[]};_.forEach(t,(function(t){var i=e.getGeoJsonBySource(t);n.features=n.features.concat(i.features)}));var i=new Blob([JSON.stringify(n,null,4)]),r="exp-geo-"+this.getTimeString()+".geojson";hr.a.saveAs(i,r,!0)}},_handlerExpDXF:function(){var t=this.getLayerSources();if(Array.isArray(t)||(t=[t]),t.length>0){var e=this,n={type:"FeatureCollection",features:[]};_.forEach(t,(function(t){var i=e.getGeoJsonBySource(t);n.features=n.features.concat(i.features)}));var i=new P.a,r=i.readFeatures(n,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}),a=new $.a({features:r}).getExtent(),o=i.writeFeaturesObject(r),s=ln(o,a);this.getTimeString();!function(t,e){Y.nativeFormRequest(t,e)}("export/exportImage.do",{printData:JSON.stringify({svg:s,fileName:"exp"}),type:"dxf"})}},_handlerExpMap:function(){var t=this.mapComp.mapObject,e="exp-map-"+this.getTimeString(),n=this;this.expImageDialog=yr({mapObject:t,ok:function(){n._expImageOk(t,e)}.bind(n)})},_expImageOk:function(t,e){var n=this;if(this.expImageDialog&&"1"===this.expImageDialog.expType){var i=n.expImageDialog.pixelWidth,r=n.expImageDialog.pixelHeight;if(i&&r)if(Number.parseInt(i)*Number.parseInt(r)*3>this.maxRenderMemory)return void this.$alert("处理此图片需要的内存空间大于64M，请重新设置范围","导出警告",{type:"warning"});this.$confirm("<div>此操作需要保存数据，如存在未保存的数据，导出时将不显示。<div/><div>如果已经保存请点击“确定”继续操作。<div/><div>是否继续?<div/>","提示",{dangerouslyUseHTMLString:!0,type:"info"}).then((function(){var t=n.expImageDialog.mapContentTitle||"",e=[n.expImageDialog.bbox.minLon,n.expImageDialog.bbox.minLat,n.expImageDialog.bbox.maxLon,n.expImageDialog.bbox.maxLat],i=n.expImageDialog.pixelWidth,r=n.expImageDialog.pixelHeight,a=!0===n.expImageDialog.isWithBaseLayer?"joinbright:f1_group_1":"joinbright:tb_gis_features",o=n.expImageDialog.titlePosition||"top,right",s=n.expImageDialog.titleFontSize||18,l=n.expImageDialog.titleFontColor||"#000000";l=l.replace("#","%23");var c="/geoserver/wms?bbox=".concat(e,"&styles=&Format=image/png&request=GetMap&layers=").concat(a,"&width=").concat(i,"&height=").concat(r,"&srs=").concat("EPSG:3857","&format_options=layout:style-editor-legend&env=message:").concat(t,";D_FONTSIZE:").concat(s,";D_POSITION:").concat(o,";D_FONTCOLOR:").concat(l),u=window.open("","打印地图","width=".concat(i,",height=").concat(r+30,",location=no"));u.document.body.setAttribute("style","margin: 0px; background: #0e0e0e; height: 100%");var p=u.document.createElement("img");p.setAttribute("src",window.location.origin+c),p.setAttribute("style","-webkit-user-select:none;margin:auto;");var h=u.document.createElement("button");h.setAttribute("style","width:"+i+"px;height:30px;font-size:16px;cursor:pointer;"),h.innerText="打印地图",u.document.body.appendChild(h),u.document.body.appendChild(p),h.onclick=function(){h.style.display="none",u.window.print(),h.style.display=""}})).catch((function(){console.log("取消导出")}))}else t.once("postcompose",(function(t){var i=t.context.canvas;navigator&&navigator.msSaveBlob?navigator.msSaveBlob(i.msToBlob(),e+".png"):i.toBlob((function(t){hr.a.saveAs(t,e+".png")})),n.$emit("onAfterExportMap")})),t.renderSync()},getTimeString:function(){var t=new Date;return t.getFullYear()+(t.getMonth()+1+"").padStart(2,"0")+(t.getDate()+"").padStart(2,"0")+(t.getHours()+"").padStart(2,"0")+(t.getMinutes()+"").padStart(2,"0")+(t.getSeconds()+"").padStart(2,"0")}}},vr=Object(Dt.a)(br,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("OLToggle",{attrs:{title:"导出数据",icon:t.icon}},[n("OLBar",[n("OLButton",{attrs:{title:"导出GeoJSON",icon:t.geoJsonIcon},on:{onClick:t._handlerExpGeoJSON}}),t._v(" "),n("OLButton",{attrs:{title:"导出DXF",img:t.dxfIcon},on:{onClick:t._handlerExpDXF}}),t._v(" "),n("OLButton",{attrs:{title:"导出PNG",icon:t.pngIcon},on:{onClick:t._handlerExpMap}})],1)],1)}),[],!1,null,null,null).exports,Or={name:"ButtonLayersChoose",props:{mapComp:{type:Object,default:null},title:{type:String,default:"图层选择"},onOk:{type:Function,default:function(t){}}},data:function(){return{form:{layerId:""},layerVisibile:!0,layers:[],layerId:"",rules:{layerId:[{required:!0,message:"请选中一个编辑图层",trigger:"blur"}]}}},components:{"el-dialog":qe.Dialog,"el-select":qe.Select,"el-form":qe.Form,"el-form-item":qe.FormItem,"el-option":qe.Option,"el-button":qe.Button},mounted:function(){this.mapComp&&this.showChooseDia()},methods:{showChooseDia:function(t){var e=this;this.mapComp.mapObject.getLayers().forEach((function(t){if(t instanceof D.a){var n={};n.layerName=t.get("title"),n.layerId=t.get("layerId"),n.layerType=t.get("layerType"),n.instance=t,e.layers.push(n)}}))},readFeature:function(){var t=this,e=this;this.$refs.targetform.validate((function(n,i){if(!n)return!1;var r=e.layers.filter((function(t){return t.layerId==e.form.layerId})),a=r&&r.length>0?r[0].instance:null;!1!==t.onOk(a)&&(e.layerVisibile=!1)}))},handlerClosed:function(){this.$destroy(),this.$el.remove()}}},wr=Object(Dt.a)(Or,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{visible:t.layerVisibile,title:"请选择需要编辑的图层","close-on-click-modal":!1,"append-to-body":!0,"show-close":!1,"destroy-on-close":!0},on:{"update:visible":function(e){t.layerVisibile=e},closed:t.handlerClosed}},[n("el-form",{ref:"targetform",attrs:{"label-width":"70px",rules:t.rules,model:t.form}},[n("el-form-item",{attrs:{label:"图层名称","label-width":"120px",prop:"layerId"}},[n("el-select",{model:{value:t.form.layerId,callback:function(e){t.$set(t.form,"layerId",e)},expression:"form.layerId"}},t._l(t.layers,(function(t,e){return n("el-option",{key:e,attrs:{label:t.layerName,value:t.layerId}})})),1)],1)],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"small"},on:{click:function(e){t.layerVisibile=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.readFeature}},[t._v("确 定")])],1)],1)}),[],!1,null,null,null).exports,_r=dr.default.extend(wr),xr=function(t){var e=document.body,n=document.createElement("div");return e.appendChild(n),new _r({el:n,propsData:t||{}})},Sr=y('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="32px" height="32px" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve">\n\t<g stroke="#fff" fill="#fff">\n\t\t<polygon points="0,32 6.581,30.966 1.034,25.394 \t\t"/>\n\t\t<path d="M31.225,6.219c1.034-1.037,1.034-2.59,0-3.627l-1.806-1.814c-1.031-1.036-2.581-1.036-3.611,0L24,2.591l5.418,5.441\n\t\t\tL31.225,6.219z"/>\n\t\t<path d="M23,14c-4.962,0-9,4.038-9,9s4.038,9,9,9s9-4.038,9-9S27.962,14,23,14z M23,30c-3.86,0-7-3.14-7-7s3.14-7,7-7s7,3.14,7,7\n\t\t\tS26.86,30,23,30z"/>\n\t\t<path d="M22.965,12.148c0.739,0,1.46,0.076,2.159,0.215l2.433-2.453l-5.494-5.54L2.831,23.759l5.497,5.539l3.818-3.849\n\t\t\tc-0.144-0.716-0.221-1.456-0.221-2.214C11.924,17.111,16.867,12.148,22.965,12.148z"/>\n\t\t<path d="M21,20c-0.552,0-1,0.448-1,1v4c0,0.552,0.448,1,1,1s1-0.448,1-1v-4C22,20.448,21.552,20,21,20z"/>\n\t\t<path d="M25,20c-0.552,0-1,0.448-1,1v4c0,0.552,0.448,1,1,1s1-0.448,1-1v-4C26,20.448,25.552,20,25,20z"/>\n\t</g>\n</svg>'),Lr=y('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="32px" height="32px" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve">\n\t<g stroke="#fff" fill="#fff">\n\t\t<polygon points="0,32 6.581,30.966 1.034,25.394 \t\t"/>\n\t\t<path d="M31.225,6.219c1.034-1.037,1.034-2.59,0-3.627l-1.806-1.814c-1.031-1.036-2.581-1.036-3.611,0L24,2.591l5.418,5.441\n\t\t\tL31.225,6.219z"/>\n\t\t<path d="M23,14c-4.962,0-9,4.038-9,9s4.038,9,9,9s9-4.038,9-9S27.962,14,23,14z M23,30c-3.86,0-7-3.14-7-7s3.14-7,7-7s7,3.14,7,7\n\t\t\tS26.86,30,23,30z"/>\n\t\t<path d="M22.965,12.148c0.739,0,1.46,0.076,2.159,0.215l2.433-2.453l-5.494-5.54L2.831,23.759l5.497,5.539l3.818-3.849\n\t\t\tc-0.144-0.716-0.221-1.456-0.221-2.214C11.924,17.111,16.867,12.148,22.965,12.148z"/>\n\t\t<path d="M22.707,19.293c-0.286-0.287-0.715-0.372-1.09-0.217C21.244,19.231,21,19.596,21,20v6c0,0.404,0.244,0.769,0.617,0.924\n\t\t\tC21.741,26.975,21.871,27,22,27c0.26,0,0.516-0.102,0.707-0.293l3-3c0.391-0.391,0.391-1.023,0-1.414L22.707,19.293z"/>\n\t</g>\n</svg>'),jr={name:"ButtonStartOrStopEdit",props:{startIcon:{type:String,default:""},stopIcon:{type:String,default:""},startImg:{type:String,default:Lr},stopImg:{type:String,default:Sr},currentLayer:{type:Object,default:null}},data:function(){return{title:"开始编辑",editing:!1}},mounted:function(){this.parentContainer=b(this,"OLMap")},methods:{_handlerClick:function(){var t=this;if(!0===this.editing){this.$emit("stop",(function(e){!1!==e&&(t.editing=!1,t.title="开始编辑",t.startIcon?t.$refs.btn.setIcon(t.startIcon):t.startImg&&t.$refs.btn.setImg(t.startImg),t.currentLayer)}))}else{var e=this._getEditLayerBySelectFeature();if(e&&(this.currentLayer=e),null==this.currentLayer)xr({mapComp:this.parentContainer,onOk:this._onOk.bind(this)});else this._onOk(this.currentLayer)}},_onOk:function(t){var e=this;this.editing=!0,this.$emit("start",t),e.title="停止编辑",e.stopIcon?e.$refs.btn.setIcon(e.stopIcon):e.stopImg&&e.$refs.btn.setImg(e.stopImg)},_getEditLayerBySelectFeature:function(){var t=null,e=this.$refs.btn.mapObject.getMap();if(e){var n=null,i=e.getInteractions().getArray().filter((function(t){return t instanceof Vn.a}));i&&i.length>0&&(n=i[0]).getFeatures().getLength()>0&&(t=n.getLayer(n.getFeatures().item(0)))}return t}}},Cr=Object(Dt.a)(jr,(function(){var t=this.$createElement;return(this._self._c||t)("OLButton",{ref:"btn",attrs:{title:this.title,icon:this.startIcon,img:this.startImg},on:{onClick:this._handlerClick}})}),[],!1,null,null,null).exports,kr={name:"ButtonImport",mixins:[Ft],props:{title:{type:String,default:"导入"},icon:{type:String,default:""},img:{type:String,default:""}},mounted:function(){var t=this,e=this,n="";this.label?n=this.label:this.icon?n='<i class="'.concat(e.icon,'"></i>'):this.img&&(n='<img src="'.concat(e.img,'" width="20" height="20" style="cursor:pointer;"/>')),this.mapObject=new fn.a({html:n,className:this.className,title:this.title,handleClick:function(t){}.bind(this)}),L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent),this.parentContainer.mapObject.addControl(this.mapObject),this.$nextTick((function(){t.$emit("ready",t.mapObject,t),e.initInputFile()}))},methods:{initInputFile:function(){var t=this.mapObject.getButtonElement().parentElement,e=this,n=document.createElement("input");n.setAttribute("type","file"),n.setAttribute("title",e.title),n.setAttribute("accept",".json,.shape,.svg,.txt,application/json;.svg,image/svg+xml;"),n.setAttribute("style","position:absolute;opacity:0;font-size:10em;top:-5px;right:-5px;margin:0;cursor:pointer;"),n.addEventListener("change",(function(t){var i=this;if(1==i.files.length){i.files[0].name.substring(i.files[0].name.lastIndexOf(".")+1).toLocaleLowerCase();var r=new FileReader;r.onloadend=function(t){var i=t.target.result;e.readDataCompleted(i),n.blur()},r.onerror=function(){n.blur(),console.error("导入失败")},r.readAsText(i.files[0])}else n.blur(),console.warn("请选择一个GeoJSON文件");i.value=""})),t.style.overflow="hidden",t.appendChild(n)},setSource:function(t){t&&(this.source=t)},readDataCompleted:function(t){if(t){var e=JSON.parse(t);this.$emit("readend",e)}}},render:function(){return null}},Ir=Object(Dt.a)(kr,void 0,void 0,!1,null,null,null).exports,Mr={data:function(){return{form:{guid_:"",layerId:"",layerName:"",layerType:""},isTempLayer:!1,dialogFormVisible:!0,formLabelWidth:"120px",layerOption:[]}},mounted:function(){this._loadLayerType()},methods:{_onOk:function(){var t=this;this.$refs.submitform.validate((function(e,n){if(!e)return!1;var i=t.getLayerProperties();!1!==t.ok(i,t.$refs.submitform)&&(t.dialogFormVisible=!1)}))},getLayerProperties:function(){var t=Object.assign({guid_:"",layerId:"",layerName:"",layerType:"",features:[]},this.form);return!0===this.isTempLayer&&(t.isTemp=!0),t},_handlerClose:function(){this.$destroy(),this.$el.remove()},_loadLayerType:function(){var t=this;return Object(Z.a)(regeneratorRuntime.mark((function e(){var n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={service:"layerTypeCodeGridService",start:0,limit:10,filterStr:{filterMap:[{target:"@TABLENAME.PARENT_ID",type:"=",value:"4A19E119-CE6E-4956-97F0-647D14CE8AAC-00022"}],orderMap:[]}},e.next=3,Y.post("grid/query.do",n).then((function(t){for(var e=[],n=0,i=t.data.rows.length;n<i;n++)e.push({label:t.data.rows[n].NAME_CH,value:t.data.rows[n].LAYER_TYPE});return e}));case 3:i=e.sent,t.layerOption=i;case 5:case"end":return e.stop()}}),e)})))()}}},Tr=Object(Dt.a)(Mr,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:"新建图层",visible:t.dialogFormVisible,"destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogFormVisible=e},closed:t._handlerClose}},[n("el-form",{ref:"submitform",attrs:{model:t.form,rules:t.rules}},[n("el-form-item",{attrs:{"label-width":t.formLabelWidth}},[n("el-checkbox",{model:{value:t.isTempLayer,callback:function(e){t.isTempLayer=e},expression:"isTempLayer"}},[t._v("是否临时图层")])],1),t._v(" "),n("el-form-item",{attrs:{label:"图层名称","label-width":t.formLabelWidth,prop:"layerName"}},[n("el-input",{ref:"layerNameFiled",attrs:{autocomplete:"off"},model:{value:t.form.layerName,callback:function(e){t.$set(t.form,"layerName",e)},expression:"form.layerName"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"图层类型","label-width":t.formLabelWidth,prop:"layerName"}},[n("el-select",{attrs:{clearable:"",placeholder:"请选择图层类型"},model:{value:t.form.layerType,callback:function(e){t.$set(t.form,"layerType",e)},expression:"form.layerType"}},t._l(t.layerOption,(function(t){return n("el-option",{key:t.value,attrs:{value:t.value,label:t.label}})})),1)],1)],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t._onOk}},[t._v("确 定")])],1)],1)}),[],!1,null,null,null).exports,Ar=dr.default.extend(Tr),Er=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=document.body,n=document.createElement("div");e.appendChild(n);var i=new Ar({el:n,data:t});return i},Fr=y('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="32px" height="32px" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve">\n\t<g stroke="#fff" fill="#fff">\n\t\t<path d="M24,18c-3.86,0-7,3.141-7,7s3.14,7,7,7s7-3.141,7-7S27.86,18,24,18z M24,30c-2.757,0-5-2.243-5-5s2.243-5,5-5s5,2.243,5,5S26.757,30,24,30z"/>\n\t\t<path d="M28,0H4C2.344,0,1,1.348,1,3.004V22c0,0.021,0.011-0.96,0.013-0.938c0.005,0.091,0.023,0.179,0.053,0.265C1.077,21.357,1.085,21.39,1.1,21.42c0.048,0.104,0.108,0.2,0.191,0.283c0.001,0.002,0.002,0.004,0.003,0.005l7.999,7.998c0.092,0.093,0.202,0.166,0.324,0.217C9.738,29.973,9.868,30,10,30h6.523c-0.413-0.616-0.744-1.289-0.996-2H11v-7c0-0.553-0.448-1-1-1H3V3.004C3,2.45,3.45,2,4.004,2h23.992C28.549,2,29,2.45,29,3.004v14.52c0.756,0.506,1.429,1.125,2,1.831V3.004C31,1.348,29.657,0,28,0z M9,22v4.586L4.414,22H9z"/>\n\t\t<path d="M25.004,23.979v-2c0-0.553-0.448-1-1-1s-1,0.447-1,1v2h-2c-0.552,0-1,0.447-1,1s0.448,1,1,1h2v2c0,0.553,0.448,1,1,1s1-0.447,1-1v-2h2c0.552,0,1-0.447,1-1s-0.448-1-1-1H25.004z"/>\n\t</g>\n</svg>'),Pr={name:"ButtonCreateLayer",mixins:[Et],props:{img:{type:String,default:Fr},layers:{type:Array,default:function(){return[]}}},data:function(){return{}},methods:{_handlerCreateLayer:function(){var t=Er({form:{guid_:de(),layerId:de(),layerName:""},ok:this.onOk,rules:{layerName:[{validator:this.validateLayerName.bind(this),trigger:""}]}});this.dialog=t},onOk:function(t,e){this.layers.push(t),this.$emit("onOk",t,this),!0!==this.dialog.isTempLayer&&this.saveLayerInfos(t)},validateLayerName:(Hi=Object(Z.a)(regeneratorRuntime.mark((function t(e,n,i){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!0!==this.dialog.isTempLayer){t.next=2;break}return t.abrupt("return",!!n);case 2:if(n){t.next=6;break}i(new Error("图层名不能为空")),t.next=14;break;case 6:if(-1==this.layers.findIndex((function(t){return t.layerName==n}))){t.next=10;break}return i(new Error("图层名已经存在")),t.abrupt("return",!1);case 10:return r=!1,t.next=13,q(n).then((function(t){var e=t.data;e.successful&&e.resultValue>0&&(r=!0)})).catch((function(t){throw t.message}));case 13:r&&i(new Error("图层名已经存在"));case 14:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return Hi.apply(this,arguments)})}},Br=Object(Dt.a)(Pr,(function(){var t=this.$createElement;return(this._self._c||t)("OLButton",{attrs:{img:this.img,title:"新建矢量图层"},on:{onClick:this._handlerCreateLayer}})}),[],!1,null,null,null).exports,Dr={created:function(){var t=this;Q().then((function(e){var n=e.data;n&&("string"==typeof n&&(n=JSON.parse(n)),t.layerInfos=n)})).catch((function(t){throw t.message}))},data:function(){return{layerInfos:[],seletedLayerId:[],dialogFormVisible:!0,formLabelWidth:"120px"}},methods:{_onOk:function(){var t=this.getLayerInfoList();this.ok(t,this.seletedLayerId),this.dialogFormVisible=!1},getLayerInfoList:function(){var t=this;return this.layerInfos.filter((function(e){return-1!=t.seletedLayerId.findIndex((function(t){return t===e.layerId}))}))},_handlerClose:function(){this.$destroy(),this.$el.remove()}}},$r=Object(Dt.a)(Dr,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:"打开图层",visible:t.dialogFormVisible,"destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogFormVisible=e},closed:t._handlerClose}},[n("el-select",{attrs:{multiple:"",placeholder:"请选择矢量图层",filterable:"","reserve-keyword":""},model:{value:t.seletedLayerId,callback:function(e){t.seletedLayerId=e},expression:"seletedLayerId"}},t._l(t.layerInfos,(function(t,e){return n("el-option",{key:e,attrs:{label:t.layerName,value:t.layerId}})})),1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t._onOk}},[t._v("确 定")])],1)],1)}),[],!1,null,null,null).exports,Nr=dr.default.extend($r),zr=function(t){var e=document.createElement("div");return document.body.appendChild(e),new Nr({el:e,data:t})},Gr={mixins:[Et],props:{img:{type:String,default:null},layers:{type:Array,default:function(){return[]}}},methods:{_handlerReadClick:function(){this.dialog=zr({ok:this._onOk.bind(this)})},_onOk:function(t,e){var n=this;t&&t.length>0&&this.$Read(e.join(",")).then((function(e){t.forEach((function(t){var i=n.findIndex(t.layerId);-1==i?n.addLayer(t,e):console.warn(n.layers[i].layerName+"图层已经存在，不进行重复添加")}))})).catch((function(t){throw t.message}))},findIndex:function(t){return this.layers.findIndex((function(e){return e.layerId===t}))},addLayer:function(t,e){var n={guid_:t.guid_||de(),layerId:t.layerId,layerName:t.layerName,layerType:t.layerType,features:[]};e&&e.forEach((function(e){e&&e.layerProps&&e.layerProps.guid_&&t.layerId===e.layerProps.layerId&&(n.guid_=e.layerProps.guid_,e.geoJSON&&e.geoJSON.features.length>0&&(n.features=e.geoJSON.features))})),this.layers.push(n)}}},Zr=Object(Dt.a)(Gr,(function(){var t=this.$createElement;return(this._self._c||t)("OLButton",{attrs:{title:"打开图层",img:this.img},on:{onClick:this._handlerReadClick}})}),[],!1,null,null,null).exports,Rr=n(412),Vr=n(1292),Wr=function(t){Vr.a.call(this,t)};Object(Rr.b)(Wr,Vr.a),Wr.prototype._draw=function(t){if(this.getVisible()&&this.getMap()){var e=this.getMap().getView().getCenter(),n="  当前层级："+this.getMap().getView().getZoom();this.getMap().getView().getResolution();if(this.get("projection")&&(e=Object(h.n)(e,this.getMap().getView().getProjection(),this.get("projection"))),e=this._format(e),this.element.textContent="中心："+e+n,this.get("canvas")){var i=this.getContext(t);if(i){var r=t.frameState.pixelRatio;i.save(),i.scale(r,r);var a=this.element.getBoundingClientRect(),o=this.getMap().getViewport().getBoundingClientRect(),s=this.getMap().getSize()[0]/o.width;i.translate((a.left-o.left)*s,(a.top-o.top)*s);var l=this.element.clientHeight,c=this.element.clientWidth;i.beginPath(),i.fillStyle=Object(Ge.b)(this.getTextFill().getColor()),i.strokeStyle=Object(Ge.b)(this.getTextStroke().getColor()),i.lineWidth=this.getTextStroke().getWidth(),i.textAlign="center",i.textBaseline="middle",i.font=this.getTextFont(),i.lineWidth&&i.strokeText(e,c/2,l/2),i.fillText("中心："+e+n,c/2,l/2),i.closePath(),i.restore()}}}};var Hr=Wr,Ur={props:{className:{type:String,default:void 0},textStyle:{type:Object,default:function(){return{font:"bold 12px sans-serif",stroke:{color:"rgb(255,255,255)",width:2},fill:"rgb(255,0,0)"}}},projection:{type:String,default:"EPSG:4326"},coordinateFormat:{type:Function,default:function(t){return Object(p.k)(t)}},canvas:{type:Boolean,default:!0}},mounted:function(){var t=this,e=C(this.$props,this);e.style=new nt.c({stroke:new at.a({color:this.textStyle.stroke.color,width:this.textStyle.stroke.width}),text:new ot.a({font:this.textStyle.font,fill:new rt.a({color:this.textStyle.fill})})}),this.mapObject=new Hr(e),L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent),this.parentContainer.addControl(this.mapObject),this.$nextTick((function(){t.$emit("ready",t.mapObject,t)}))},render:function(){return null}},Jr=Object(Dt.a)(Ur,void 0,void 0,!1,null,null,null).exports,Yr=n(591).a,Xr=(n(1278),Object(Dt.a)(Yr,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",{staticClass:"ol-context-menu el-dropdown-menu el-popper",staticStyle:{"transform-origin":"center top","z-index":"2003",display:"none"}},[t._l(t.menuData,(function(e){return[n("li",{key:e.id,staticClass:"el-dropdown-menu__item",attrs:{"data-id":e.id}},[e.iconCls?n("i",{class:e.iconCls}):t._e(),t._v("\n            "+t._s(e.text)+"\n        ")])]}))],2)}),[],!1,null,null,null).exports),Kr=(n(219),n(539)),qr={name:"OLStencil",mixins:[At],data:function(){return{activeName:[],currentLayer:this.stencilLayer}},props:{groups:{type:Array,default:function(){return[]}},left:{type:Number,default:0},top:{type:Number,default:0},visiable:{type:Boolean,default:!0},"stencil-layer":{type:Object,default:function(){return{}}},isServer:{type:Boolean,default:!0}},components:{"el-collapse":qe.Collapse,"el-collapse-item":qe.CollapseItem},mounted:function(){var t=this;this.mapObject=this.$refs.overlay.mapObject,this.$refs.drawPoint.mapObject.setActive(!1),this.$refs.drawLineString.mapObject.setActive(!1),this.$refs.drawPolygon.mapObject.setActive(!1),this.$el.style.left=this.left+"px",this.$el.style.top=this.top+"px",this.groups.forEach((function(e,n){t.activeName.push(n)})),!0===this.visiable&&this.mapObject.show()},watch:{stencilLayer:function(t,e){if(null==t)return!1;if(!0===this.isServer){var n=t.get("layerType");n&&this._getCurLayerStencil(n)}},visiable:function(t,e){this.mapObject.toggle(t)}},methods:{_handleChange:function(){},_handleItemClick:function(t,e){this.excludeIneractionActive(!1),this.curDrawFea=this.groups[t].children[e];var n=this.curDrawFea.geoType||"Point";if("Point"==n){this.$refs.drawPoint.mapObject.setActive(!0);var i=this._getPointStyle();this.$refs.drawPoint.setSketchPointStyle(i)}else if("LineString"==n){this.$refs.drawLineString.mapObject.setActive(!0);var r=this._getLineStringStyle();this.setSketchLineStringStyle=r}else"Polygon"==n&&this.$refs.drawPolygon.mapObject.setActive(!0);var a=this.mapObject.getMap().getInteractions().getArray().find((function(t){return t instanceof Kr.a}));a&&a.setActive(!1)},_getPointStyle:function(){var t=this.curDrawFea.type,e=this.curDrawFea.style&&"string"==typeof this.curDrawFea.style?JSON.parse(this.curDrawFea.style):this.curDrawFea.style?this.curDrawFea.style:{},n=e["stroke-dasharray"]?e["stroke-dasharray"].split(/\s*,\s*/):[0,0],i=null;switch(t){case"basic.Circle":i={image:{circle:{stroke:{color:e.stroke||"rgb(0,0,0)",lineDash:n,width:e["stroke-width"]||1},fill:e.fill||"rgb(0,0,0)",radius:this.curDrawFea.size/2}}};break;case"basic.Shape":i={image:{shape:{points:e.points,stroke:{color:e.stroke||"rgb(255,0,0)",lineDash:n,width:e["stroke-width"]||1},fill:e.fill||"rgb(0,0,0)",radius:this.curDrawFea.size/2,radius1:e.radius1,radius2:e.radius2,rotation:e.rotation,angle:e.angle}}};break;default:var r=this.curDrawFea.size;i={image:{"svg-symbol":{symbolType:t,stroke:{color:e.stroke||"rgb(0,0,0)",width:e["stroke-width"]||1},size:{width:r,height:r}}}}}return i},_getLineStringStyle:function(){var t=this.curDrawFea.style&&"string"==typeof this.curDrawFea.style?JSON.parse(this.curDrawFea.style):this.curDrawFea.style?this.curDrawFea.style:{},e=t["stroke-dasharray"]?t["stroke-dasharray"].split(/\s*,\s*/):[0,0],n=null;switch(this.curDrawFea.type){case"electricity.DianLan":n={stroke:{color:t.stroke||"rgb(0,0,255)",width:t["stroke-width"]||2,lineDash:e},lineType:"electricity.DianLan"};break;case"electricity.GuangXian":n={stroke:{color:t.stroke||"rgb(0,255,0)",width:t["stroke-width"]||4,lineDash:e},lineStyle:"electricity.GuangXian"};break;case"electricity.DianLanTongDao":n={stroke:[{color:t.stroke||"rgb(0,255,0)",width:t["stroke-width"]?t["stroke-width"]<4?6:t["stroke-width"]:20,lineCap:"round"},{color:"rgb(255,255,255)",width:t["stroke-width"]?t["stroke-width"]-4:6},{color:t.stroke||"rgb(0,255,0)",width:2,lineDash:[5,5],lineJoin:"square"}],lineType:"electricity.DianLanTongDao"};break;default:n={stroke:{color:t.stroke||"rgb(0,0,0)",width:t.width||2,lineDash:e},lineType:"app.Link"}}return n},_getPolygonStyle:function(){var t=this.curDrawFea.style&&"string"==typeof this.curDrawFea.style?JSON.parse(this.curDrawFea.style):this.curDrawFea.style?this.curDrawFea.style:{},e=t["stroke-dasharray"]?t["stroke-dasharray"].split(/\s*,\s*/):[0,0];return{stroke:{color:t.stroke||"rgb(0,0,0)",lineDash:e,width:t["stroke-width"]||2},fill:t.fill}},_onPloygonDrawend:function(t){var e=this._getPolygonStyle();e&&(t.feature.set("style",e),this.curDrawFea&&this.curDrawFea.flagType&&t.feature.set("symbolType",this.curDrawFea.flagType),t.feature.set("layerId",this.stencilLayer.get("layerId"))),this.stencilLayer.getSource().addFeature(t.feature),this.$refs.drawPolygon.mapObject.setActive(!1);var n=this._getSelectInteraction();n&&n.setActive(!0)},_onLineStringDrawend:function(t){var e=this._getLineStringStyle();e&&(t.feature.set("style",e),e.lineType&&(t.feature.set("symbolType",e.lineType),delete e.lineType),this.curDrawFea&&"app.Link"===this.curDrawFea.type&&this.curDrawFea&&this.curDrawFea.flagType&&t.feature.set("symbolType",this.curDrawFea.flagType),t.feature.set("layerId",this.stencilLayer.get("layerId"))),this.stencilLayer.getSource().addFeature(t.feature),this.$refs.drawLineString.mapObject.setActive(!1);var n=this._getSelectInteraction();n&&n.setActive(!0)},_onPointDrawend:function(t){var e=this._getPointStyle();e&&(t.feature.set("style",e),t.feature.set("layerId",this.stencilLayer.get("layerId"))),this.curDrawFea&&this.curDrawFea.flagType?t.feature.set("symbolType",this.curDrawFea.flagType):(t.feature.set("symbolType",this.curDrawFea.type),this.curDrawFea.gbCode&&t.feature.set("gbCode",this.curDrawFea.gbCode)),this.stencilLayer.getSource().addFeature(t.feature),this.$refs.drawPoint.mapObject.setActive(!1);var n=this._getSelectInteraction();n&&n.setActive(!0)},_getSelectInteraction:function(){return this.mapObject.getMap().getInteractions().getArray().find((function(t){return"ol-select"===t.get("interactionType")}))},_getCurLayerStencil:function(t){var e=this;return Object(Z.a)(regeneratorRuntime.mark((function n(){var i,r,a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=e,r=t?{layerType:t}:{},a=[],n.next=5,et(r).then((function(t){var e=t.data.filter((function(t){return"1"==t.DISPLAY}));return e.forEach((function(t){-1==a.findIndex((function(e){return e.name===t.GROUP_ID}))&&a.push({title:t.GROUP_ID_DSPVALUE,name:t.GROUP_ID,children:[]})})),e})).catch((function(t){console.log(t.message)}));case 5:i.curStencilData=n.sent,a.forEach((function(t){i.curStencilData.forEach((function(e){var n={};if(e.GROUP_ID==t.name){var r=i.$SvgSymbol.getSymbolDef(e.JOINT_SHAPE_TYPE)?i.$SvgSymbol.getSymbolDef(e.JOINT_SHAPE_TYPE).svg:"";n.img=i.getImage(e.SYMBOL_TYPE,e.SYMBOL_STYLE,r,e.JOINT_SHAPE_TYPE),n.title=e.SYMBOL_NAME,n.type=i.covertToBasicShape(e.JOINT_SHAPE_TYPE)||"","basic.Shape"===n.type&&(n.flagType=e.JOINT_SHAPE_TYPE),n.size=e.SYMBOL_SIZE,n.style=e.SYMBOL_STYLE,n.geoType=i.convertSymTypeToGeoType(e.SYMBOL_TYPE),n.gbCode=e.APP_FLAG,t.children.push(n)}}))})),i.groups=a,i.groups.forEach((function(t){i.activeName.push(t.title)}));case 9:case"end":return n.stop()}}),n)})))()},getImage:function(t,e,n,i){var r=null,a=e,o={};switch(a&&(o=JSON.parse(a)),t){case"1":n||(n='<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" width="30" height="30"><line x1="1" y1="15" x2="30" y2="15" stroke="'.concat(o.stroke||"rgb(0,0,0)",'" stroke-width="').concat(o["stroke-width"]||2,'" stroke-dasharray="').concat(o["stroke-dasharray"]||"none",'"/></svg>')),r=this.$svg2base64(n);break;case"0":r=this.$svg2base64(n.replace("param(outline)",o.stroke||"rgb(0,0,0)"),{width:30,height:30});break;case"2":if(n)r=this.$svg2base64(n);else{var s=new at.a({color:o.stroke||"black",width:o["stroke-width"]||2}),l=new rt.a({color:o.fill||"red"}),c=null;if("basic.Circle"==i)c=new it.a({fill:l,stroke:s,radius:15});else{var u=void 0;switch(o.points){case 5:u=6}c=new lt.a({fill:l,stroke:s,points:o.points,radius:15,radius1:o.radius1,radius2:u,angle:o.angle})}r=c.getImage().toDataURL("image/png")}break;case"3":n||(n='<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" width="30" height="30"><polygon points="0,15 30,0 30,30 0,30" stroke="'.concat(o.stroke||"rgb(0,0,0)",'" stroke-width="').concat(o["stroke-width"]||2,'" stroke-dasharray="').concat(o["stroke-dasharray"]||"none",'" fill="').concat(o.fill,'"/></svg>')),r=this.$svg2base64(n)}return r},covertToBasicShape:function(t){return t&&t.startsWith("basic.")?"basic.Circle"===t?t:"basic.Shape":t},convertSymTypeToGeoType:function(t){var e="Point";switch(t){case"0":case"2":e="Point";break;case"1":e="LineString";break;case"3":e="Polygon"}return e}}},Qr=(n(1279),Object(Dt.a)(qr,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("OLOverlay",{ref:"overlay",attrs:{className:"menu",closeBox:!0}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.visiable,expression:"visiable"}],staticClass:"gis-stencil"},[n("el-collapse",{on:{change:t._handleChange},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},t._l(t.groups,(function(e,i){return n("el-collapse-item",{key:i,attrs:{title:e.title,name:e.title}},t._l(e.children,(function(e,r){return n("div",{key:r,staticClass:"webgis-stencil-item",attrs:{title:e.title,type:e.type},on:{click:function(e){return t._handleItemClick(i,r)}}},[n("div",{staticClass:"stencil-item-img"},[n("img",{staticStyle:{width:"30px",height:"30px"},attrs:{src:e.img}})]),t._v(" "),n("div",{staticClass:"stencil-item-label"},[t._v(t._s(e.title))])])})),0)})),1),t._v(" "),n("OLDraw",{ref:"drawPoint",attrs:{silentSvg:!1},on:{drawend:t._onPointDrawend}}),t._v(" "),n("OLDraw",{ref:"drawLineString",attrs:{geoType:"LineString"},on:{drawend:t._onLineStringDrawend}}),t._v(" "),n("OLDraw",{ref:"drawPolygon",attrs:{geoType:"Polygon"},on:{drawend:t._onPloygonDrawend}})],1)])}),[],!1,null,"51f9b91c",null).exports),ta={name:"ButtonFeatureZoom",props:{title:{type:String,default:"层级设置"},features:{type:Array,default:function(){return[]}},onOk:{type:Function,default:function(t){}}},data:function(){var t=this;return{form:{maxZoomLevel:null,minZoomLevel:null,name:null,textMaxZoomLevel:null,textMinZoomLevel:null},dialogVisibile:!0,rules:{maxZoomLevel:[{validator:function(e,n,i){n&&t.form.minZoomLevel&&t.form.minZoomLevel>=0&&n<t.form.minZoomLevel?i(new Error("最大层级必须大于最小层级")):i()},trigger:"change"}],minZoomLevel:[{validator:function(e,n,i){n&&t.form.maxZoomLevel&&t.form.maxZoomLevel>=0&&n>t.form.maxZoomLevel?i(new Error("最小层级必须小于最大层级")):i()},trigger:"change"}],textMaxZoomLevel:[{validator:function(e,n,i){n&&t.form.textMinZoomLevel&&t.form.textMinZoomLevel>=0&&n<t.form.textMinZoomLevel?i(new Error("标签的最小层级必须小于标签的最大层级")):i()},trigger:"change"}],textMinZoomLevel:[{validator:function(e,n,i){n&&t.form.textMaxZoomLevel&&t.form.textMaxZoomLevel>=0&&n>t.form.textMaxZoomLevel?i(new Error("标签的最小层级必须小于标签的最大层级")):i()},trigger:"change"}]},zoomData:new Array(19)}},mounted:function(){1===this.features.length&&(this.form={maxZoomLevel:this.features[0].get("maxZoomLevel"),minZoomLevel:this.features[0].get("minZoomLevel"),name:this.features[0].get("name"),textMaxZoomLevel:this.features[0].get("textMaxZoomLevel"),textMinZoomLevel:this.features[0].get("textMinZoomLevel")}),this.features.length>1&&(this.form={maxZoomLevel:null,minZoomLevel:null,name:null,textMaxZoomLevel:null,textMinZoomLevel:null})},methods:{setZoomFeatures:function(t){var e=this;this.$refs[t].validate((function(t){if(!t){return console.log("error submit!!"),!1}var n={maxZoomLevel:e.form.maxZoomLevel,minZoomLevel:e.form.minZoomLevel,name:e.form.name,textMaxZoomLevel:e.form.textMaxZoomLevel,textMinZoomLevel:e.form.textMinZoomLevel};e.features.forEach((function(t){Object.keys(n).forEach((function(e){n[e]&&t.set(e,n[e])}))})),e.dialogVisibile=!1}))},handlerClosed:function(){this.$destroy(),this.$el.remove()}}},ea=Object(Dt.a)(ta,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{visible:t.dialogVisibile,title:"图形属性设置","close-on-click-modal":!1,"append-to-body":!0,"show-close":!1,"destroy-on-close":!0},on:{"update:visible":function(e){t.dialogVisibile=e},closed:t.handlerClosed}},[n("el-form",{ref:"targetform",attrs:{"label-width":"70px",inline:!1,rules:t.rules,model:t.form,size:"mini"}},[n("el-form-item",{attrs:{label:"图形最大显示层级","label-width":"130px",prop:"maxZoomLevel"}},[n("el-select",{model:{value:t.form.maxZoomLevel,callback:function(e){t.$set(t.form,"maxZoomLevel",t._n(e))},expression:"form.maxZoomLevel"}},t._l(t.zoomData,(function(t,e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),t._v(" "),n("el-form-item",{attrs:{label:"图形最小显示层级","label-width":"130px",prop:"minZoomLevel"}},[n("el-select",{model:{value:t.form.minZoomLevel,callback:function(e){t.$set(t.form,"minZoomLevel",t._n(e))},expression:"form.minZoomLevel"}},t._l(t.zoomData,(function(t,e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),t._v(" "),n("el-form-item",{attrs:{label:"标签","label-width":"130px",prop:"name"}},[n("el-input",{attrs:{placeholder:"请输入图形标签文本内容"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",t._n(e))},expression:"form.name"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"标签最大显示层级","label-width":"130px",prop:"textMaxZoomLevel"}},[n("el-select",{model:{value:t.form.textMaxZoomLevel,callback:function(e){t.$set(t.form,"textMaxZoomLevel",t._n(e))},expression:"form.textMaxZoomLevel"}},t._l(t.zoomData,(function(t,e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),t._v(" "),n("el-form-item",{attrs:{label:"标签最小显示层级","label-width":"130px",prop:"textMinZoomLevel"}},[n("el-select",{model:{value:t.form.textMinZoomLevel,callback:function(e){t.$set(t.form,"textMinZoomLevel",t._n(e))},expression:"form.textMinZoomLevel"}},t._l(t.zoomData,(function(t,e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogVisibile=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.setZoomFeatures("targetform")}}},[t._v("确 定")])],1)],1)}),[],!1,null,null,null).exports,na=dr.default.extend(ea),ia=function(t){var e=document.body,n=document.createElement("div");return e.appendChild(n),new na({el:n,propsData:t||{}})},ra={name:"ButtonZoomEdit",props:{currentLayer:{type:Object,default:null},currentFeature:{type:Object,default:null},img:{type:String,default:""}},data:function(){return{title:"修改图元层级",zoomIcon:"fa-cog"}},mounted:function(){this.mapObject=this.$refs.btn.mapObject,this.mapComp=b(this,"OLMap")},methods:{_handlerClick:function(){var t=this.getSelectFeatures();if(null==t||t.length<=0)return qe.Message.error("请选择至少一个图形"),!1;ia({features:t})},getSelectFeatures:function(){var t=null,e=this.mapObject.getMap().getInteractions().getArray().find((function(t){return"ol-select"===t.get("interactionType")}));return e&&(t=e.getFeatures().getArray()),t}}},aa=Object(Dt.a)(ra,(function(){var t=this.$createElement;return(this._self._c||t)("OLButton",{ref:"btn",attrs:{title:this.title,icon:this.zoomIcon,img:this.img},on:{onClick:this._handlerClick}})}),[],!1,null,null,null).exports,oa={name:"OLTopoAnaly",props:{img:{type:String,default:null},beginId:{type:String,default:null},endId:{type:String,default:null},strokeColor:{type:String,default:"rgba(0,255,0,1)"},strokeWidth:{type:Number,default:8}},mounted:function(){},data:function(){return{startGraphId:null,endGraphId:null,tempLayer:new D.a({source:new $.a})}},methods:{_handlerStartAndEnd:function(t,e){var n=this._getSelectInteraction();if(n){var i=n.getFeatures().item(0);i&&"Point"===i.getGeometry().getType()?(0===e&&(this.startGraphId=i.get("id")),1===e&&(this.endGraphId=i.get("id"))):this.$message.warning("请选中一个点，并设置为起点或终点")}},_handlerClear:function(){var t=this.$refs._ol_btn.getMap();this.tempLayer.getSource().clear(),t.removeLayer(this.tempLayer),this.startGraphId=null,this.endGraphId=null},_handler:function(t){var e=this,n=this.startGraphId,i=this.endGraphId;n&&i?We(n,i).then((function(t){if(t.data.successful){var n=t.data.resultValue;e.proccess(n),n&&n.length>0&&e.$message.success(t.data.resultHint)}else e.$message.error(t.data.resultHint)})).catch((function(t){e.$message.error("分析失败"),console.log(t)})):(!n&&e.$message.warning("请选中一个点，并设置为起点"),!i&&e.$message.warning("请选中一个点，并设置为终点"))},_handlerCheckConnected:function(t){var e=this;Ve({layerId:e._getLayerIds().join(","),versionNo:"master"}).then((function(t){if(t.data.successful){var n=t.data.resultValue;e._proccessCheckConnResult(n)}else e.$message.error(t.data.resultHint)})).catch((function(t){e.$message.error("检查失败"),console.log(t)}))},_getLayerIds:function(){var t=this.$refs._ol_btn.getMap(),e=[];return t.getLayers().forEach((function(t){t instanceof D.a&&!0===t.getVisible()&&e.push(t.get("layerId"))})),e},proccess:function(t,e){if(!t||t.length<=0)this.$message.warning("没有查询结果");else{var n=this,i=this.$refs._ol_btn.getMap();this.tempLayer.getSource().clear(),this.tempLayer.setMap(i);var r=[];i.getLayers().forEach((function(i){if(i instanceof D.a)for(var a=i.getSource(),o=0;o<t.length;o++){var s=t[o],l="string"==typeof s?s:s.graphId,c=a.getFeatureById(l);if(c){var u=c.clone();"object"!==Object(G.a)(s)||Array.isArray(s)||(u.set("showColor",s.color),u.set("showRadius",s.radius)),n._setStyle(u,e),r.push(u)}}})),n.tempLayer.getSource().addFeatures(r)}},_proccessCheckConnResult:function(t){var e="检查完成",n=!1,i=[];if(!t.noConnected||t.noConnected.length<=0?(n=!1,e+="，无孤立设备"):(t.noConnected.forEach((function(t){i.push({graphId:t,isSingle:!0,color:"rgba(255,0,0,1)"})})),n=!0,e+="，存在孤立设备"),!t.connectedDomain||Object.keys(t.connectedDomain).length<=0)n=!0,e+="，无连通域";else{var r="连通域无闭环";for(var a in t.circleDomain)!0===t.circleDomain[a]&&(n=!0,r="连通域存在闭环",t.connectedDomain[a].forEach((function(t){i.push({graphId:t,isCircle:!0,color:"rgba(0,255,0,1)"})})));e+="，"+r}n?(i.length>0&&this.proccess(i),this.$message.warning(e)):this.$message.success(e)},_setStyle:function(t,e){var n=t.get("showColor")||e,i=t.get("showRadius")||15;t.setStyle(new nt.c({image:new it.a({radius:i,fill:new at.a({color:n||this.strokeColor}),stroke:new at.a({width:this.strokeWidth,color:n||this.strokeColor})}),fill:new at.a({color:n||this.strokeColor}),stroke:new at.a({width:this.strokeWidth,color:n||this.strokeColor})}))},_getSelectInteraction:function(){return this.$refs._ol_btn.getMap().getInteractions().getArray().find((function(t){return"ol-select"===t.get("interactionType")}))}}},sa=Object(Dt.a)(oa,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("OLButton",{ref:"_ol_btn_start",attrs:{label:"S",title:"设为起点"},on:{onClick:function(e){return t._handlerStartAndEnd(e,0)}}}),t._v(" "),n("OLButton",{ref:"_ol_btn_end",attrs:{label:"E",title:"设为终点"},on:{onClick:function(e){return t._handlerStartAndEnd(e,1)}}}),t._v(" "),n("OLButton",{ref:"_ol_btn",attrs:{label:"Q",title:"最短路径"},on:{onClick:t._handler}}),t._v(" "),n("OLButton",{ref:"_ol_btn_check_connected",attrs:{label:"C",title:"连通性检查"},on:{onClick:t._handlerCheckConnected}}),t._v(" "),n("OLButton",{ref:"_ol_btn_clear",attrs:{label:"X",title:"清空结果"},on:{onClick:t._handlerClear}})],1)}),[],!1,null,null,null).exports,la=n(546),ca={props:{coordinate:{custom:!0,type:Array,default:function(){return[0,0]}},visible:{custom:!0,type:Boolean,default:!0}},beforeDestroy:function(){if(this.mapObject&&this.mapObject.getMap){var t=this.mapObject.getMap();t&&t.removeOverlay(this.mapObject)}},methods:{show:function(t,e){this.mapObject.show(t,e)},hide:function(){this.mapObject.hide()},setVisible:function(t){if(!1!==t){var e=this._getCoordinate();this.mapObject.show(e)}else this.hide()},setCoordinate:function(t){var e=this._getCoordinate(t);this.mapObject.setPosition(e)},_getCoordinate:function(){var t=null;this.parentContainer.mapObject;t=this.parentContainer.transformFn?this.parentContainer.transformFn(this.geoType,this.coordinate):this.coordinate.slice(0,2);var e=null;switch(this.geoType){case"LineString":var n=new ct.a(t);e=Object(h.g)(n.getCoordinateAt(.5));break;case"Polygon":var i=new Ie.a(t).getExtent();e=Object(h.g)(getCenter(i));break;default:e=Object(h.g)(t)}return e}}},ua={name:"OLPopup",mixins:[ca],props:{id:{type:String,default:null},geoType:{type:String,default:"Point"},popupClass:{type:String,default:"default"},closeBox:{type:Boolean,default:!1},offsetBox:{type:Array,default:function(){return[0,0]}},positioning:{type:String,default:"auto"},maxZoomLevel:{type:Number,default:20},minZoomLevel:{type:Number,default:0},coordinate:{custom:!0,type:Array,default:function(){return[0,0]}}},data:function(){return{}},mounted:function(){var t=this,e=this;if((this.parentContainer=k(this.$parent),this.parentContainer&&this.parentContainer.mapObject)&&!1===this.parentContainer.mapObject.get("visible"))return;var n=this.parentContainer.getMap(),i=C(this.$props,this);i.id=this.mapObjectId=this.id||this.parentContainer.mapObject.get("id")||ce();for(var r=this.parentContainer.getMap().getOverlays().getArray(),a=r.length-1;a>=0;a--)r[a].getId()==i.id&&n.removeOverlay(r[a]);i.onclose=function(){this.$emit("onclose",e)}.bind(this),i.onshow=function(){this.$emit("onshow",e)}.bind(this),this.mapObject=new la.a(i),this.parentContainer.addOverlay(this.mapObject);for(var o=0;o<this.$slots.default.length;o++){var s=this.$slots.default[o].elm;s&&this.mapObject.content.appendChild(s)}this.$nextTick((function(){t.$emit("ready",t.mapObject),setTimeout((function(){t.coordinate&&t.coordinate.length>1&&0!==t.coordinate[0]&&0!==t.coordinate[1]&&(t.mapObject.setPosition(t._getCoordinate()),t.mapObject.setOffset(t.offsetBox))}),300)}))},methods:{removePopupClass:function(t){this.mapObject.removePopupClass(t)},addPopupClass:function(t){this.mapObject.addPopupClass(t)},getVisible:function(){return this.mapObject.getVisible()}}},pa=Object(Dt.a)(ua,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticStyle:{display:"none"}},[this._t("default")],2)}),[],!1,null,null,null).exports,ha=n(1280),da={name:"OLPopupFeature",props:{popupClass:{type:String,default:"default anim"},closeBox:{type:Boolean,default:!1},offsetBox:{type:[Number,Array],default:0},positionning:{type:String,default:void 0},canFix:{type:Boolean,default:!1},showImage:{type:Boolean,default:!1},maxChar:{type:Number,default:200},template:{type:Object,default:function(){return null}}},data:function(){return{ready:!1}},mounted:function(){var t=this,e=C(this.$props,this);e.onclose=this._onClose.bind(this),e.onshow=this._onShow.bind(this),null===this.template&&(e.template=this.getDefaultTemplate.bind(this)),this.mapObject=new ha.a(e),L(this,this.mapObject,this.$options.props),this.parentContainer=k(this.$parent),this.parentContainer.mapObject.addOverlay(this.mapObject),this.ready=!0,this.$nextTick((function(){t.$emit("ready",t.mapObject)}))},methods:{_onClose:function(){this.$emit("onclose",this.mapObject)},_onShow:function(t,e){this.$emit("onshow",t,e)},getDefaultTemplate:function(t){var e={},n=t.getProperties();return Object.keys(n).forEach((function(t){"string"==typeof n[t]&&(e[t]=n[t])})),Object.assign({title:function(t){return"属性信息"}},{attributes:e})}}},fa=(n(1281),Object(Dt.a)(da,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticStyle:{display:"none"}},[this.ready?this._t("default"):this._e()],2)}),[],!1,null,null,null).exports),ma=n(1282),ga={name:"OLPlacemark",mixins:[ca],props:{popupClass:{type:String,default:"default"},color:{type:String,default:null},backgroundColor:{type:String,default:null},contentColor:{type:String,default:null},radius:{type:Number,default:10},coordinate:{custom:!0,type:Array,default:function(){return[0,0]}}},data:function(){return{ready:!1}},mounted:function(){var t=this,e=C(this.$props,this);Object.assign(e,{autoPan:!0,autoPanAnimation:{duration:250},onclose:function(){this.$emit("onclose",this.mapObject)}.bind(this),onshow:function(){this.$emit("onshow",this.mapObject)}.bind(this)}),this.mapObject=new ma.a(e),this.parentContainer=k(this.$parent),this.parentContainer.addOverlay(this.mapObject),this.ready=!0,this.$nextTick((function(){t.$emit("ready",t.mapObject),setTimeout(function(){this.coordinate&&this.coordinate.length>1&&0!==this.coordinate[0]&&0!==this.coordinate[1]&&(this.mapObject.show(this._getCoordinate()),this.mapObject.setRadius(this.radius))}.bind(t),300)}))},methods:{}},ya=(n(1283),Object(Dt.a)(ga,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticStyle:{display:"none"}},[this.ready?this._t("default"):this._e()],2)}),[],!1,null,"040c423e",null).exports),ba={name:"OLMapShow",components:{OLMap:zt,GoogleTileLayer:Kt,AMapTileLayer:Qt,BMapTileLayer:se,OLVectorLayer:xe,OLVectorSource:Pe,OLFeature:Ne,OLSearchFeature:dn,OLSelect:Xn,OLPopupFeature:fa},mixins:[{props:{center:{custom:!0,type:Array,default:function(t){return[116.3880556,39.9075]}},zoomLevel:{type:Number,default:13},maxZoom:{type:Number,default:18},minZoom:{type:Number,default:0},extent:{type:Array,default:function(t){return[]}}}}],props:{baseTileLayer:{type:String,default:"AMap"},tileUrl:{type:String,default:null},isCluster:{type:Boolean,default:!1},clusterDistance:{type:Number,default:1},features:{type:Array,default:function(t){return[]}},popupTemplateFun:{type:Function,default:function(){return null}},zoom:{type:Boolean,default:!1}},data:function(){return{}},created:function(){this._processLinks(this.features)},mounted:function(){var t=this;this.$nextTick((function(){setTimeout((function(){t.$refs.vectorlayer.mapObject.changed()}),1e3)}))},methods:{_processLinks:function(t){ke(t)},getDefaultTemplate:function(t){var e={},n=t.getProperties();return Object.keys(n).forEach((function(t){"string"==typeof n[t]&&(e[t]=n[t])})),Object.assign({title:function(t){return"属性信息"}},{attributes:e})},_vectorRendercomplete:function(t){},_onSelectFeature:function(t){var e=t.mapBrowserEvent.coordinate,n=t.selected[0];if(n){this.$emit("onFeatureSelected",t,n);var i=this.popupTemplateFun(n)||this.getDefaultTemplate(n);this.$refs.popupinfo.mapObject.setTemplate(i)}else this.$emit("onUnFeatureSelected",t);this.$refs.popupinfo.mapObject.show(e,n)}}},va=Object(Dt.a)(ba,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("OLMap",{attrs:{zoom:t.zoom,center:t.center,maxZoom:t.maxZoom,minZoom:t.minZoom}},["Google"==t.baseTileLayer?n("GoogleTileLayer",{attrs:{url:t.tileUrl}}):t._e(),t._v(" "),"AMap"==t.baseTileLayer?n("AMapTileLayer",{attrs:{url:t.tileUrl}}):t._e(),t._v(" "),"BMap"==t.baseTileLayer?n("BMapTileLayer",{attrs:{url:t.tileUrl}}):t._e(),t._v(" "),n("OLVectorLayer",{ref:"vectorlayer",on:{render:t._vectorRendercomplete}},[n("OLVectorSource",{attrs:{isCluster:t.isCluster,distance:t.clusterDistance}},[t._l(t.features,(function(t,e){return[n("OLFeature",{key:e,attrs:{geoType:t.geometry.type,coordinates:t.geometry.coordinates,properties:t.properties}})]}))],2)],1),t._v(" "),n("OLSearchFeature"),t._v(" "),n("OLSelect",{attrs:{active:!0},on:{select:t._onSelectFeature}}),t._v(" "),n("OLPopupFeature",{ref:"popupinfo"},[t._t("popup")],2)],1)}),[],!1,null,null,null).exports,Oa=(n(216),y('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="32px" height="32px" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve">\n\t<g stroke="#fff" fill="#fff">\n        <circle cx="3" cy="18" r="3"/>\n        <circle cx="7" cy="29" r="3"/>\n        <path d="M31.492,6.699l-1.181-1.182c-0.675-0.676-1.689-0.676-2.363,0l-1.183,1.182l3.546,3.546l1.181-1.182C32.169,8.388,32.169,7.375,31.492,6.699z"/>\n        <rect x="18.512" y="7.031" transform="matrix(-0.7073 -0.7069 0.7069 -0.7073 24.6926 42.0146)" width="5.066" height="17.728"/>\n        <polygon points="11.063,25.863 15.368,25.188 11.738,21.558"/>\n\t</g>\n</svg>')),wa=y('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="32px" height="32px" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve">\n\t<g stroke="#fff" fill="#fff">\n\t\t<path d="M5.358,22.944l3.322-3.923c0.328-0.387,0.313-0.959-0.034-1.33l-6.917-7.375c-0.378-0.403-1.012-0.422-1.414-0.045c-0.403,0.378-0.423,1.011-0.045,1.414l6.307,6.725l-3.34,3.945c-0.336,0.397-0.312,0.985,0.056,1.353l7,7C10.488,30.902,10.744,31,11,31s0.512-0.098,0.707-0.293c0.391-0.391,0.391-1.023,0-1.414L5.358,22.944z"/>\n\t\t<path d="M31.492,6.699l-1.181-1.182c-0.675-0.676-1.689-0.676-2.363,0l-1.183,1.182l3.546,3.546l1.181-1.182C32.169,8.388,32.169,7.375,31.492,6.699z"/>\n\t\t<rect x="18.512" y="7.031" transform="matrix(-0.7073 -0.7069 0.7069 -0.7073 24.6926 42.0146)" width="5.066" height="17.728"/>\n\t\t<polygon points="11.063,25.863 15.368,25.188 11.738,21.558"/>\n\t</g>\n</svg>'),_a=y('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="32px" height="32px" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve">\n\t<g stroke="#fff" fill="#fff">\n\t\t<path d="M31.492,6.699l-1.181-1.182c-0.675-0.676-1.689-0.676-2.363,0l-1.183,1.182l3.546,3.546l1.181-1.182C32.169,8.388,32.169,7.375,31.492,6.699z"/>\n\t\t<rect x="18.515" y="7.031" transform="matrix(-0.7073 -0.7069 0.7069 -0.7073 24.6992 42.0173)" width="5.066" height="17.728"/>\n\t\t<polygon points="11.066,25.863 15.372,25.188 11.742,21.558 \t\t"/>\n\t\t<path d="M2.128,20.237l1.983-7.118l7.237-1.862l3.993,3.495c0.414,0.362,1.047,0.321,1.41-0.094c0.364-0.416,0.322-1.047-0.094-1.411l-4.39-3.843c-0.247-0.218-0.589-0.299-0.907-0.216l-8.308,2.138c-0.346,0.089-0.618,0.355-0.714,0.7L0.037,20.29c-0.102,0.362,0.009,0.75,0.286,1.004l7,6.441C7.515,27.913,7.758,28,8,28c0.27,0,0.539-0.108,0.736-0.323c0.373-0.407,0.348-1.039-0.06-1.413L2.128,20.237z"/>\n\t</g>\n</svg>'),xa=y('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="32px" height="32px" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve">\n\t<g stroke="#fff" fill="#fff">\n        <path d="M28,24c-1.729,0-3.19,1.108-3.748,2.646c-4.005-0.925-7.217-2.9-9.421-4.663c0.547-0.685,0.889-1.541,0.889-2.483c0-2.206-1.794-4-4-4c-0.786,0-1.516,0.236-2.135,0.629C7.429,12.871,6.17,9.664,5.526,7.694C6.977,7.093,8,5.665,8,4c0-2.206-1.794-4-4-4S0,1.794,0,4c0,2.037,1.536,3.705,3.508,3.95c0.667,2.118,2.093,5.906,4.687,9.701C7.901,18.207,7.72,18.83,7.72,19.5c0,2.206,1.794,4,4,4c0.517,0,1.007-0.106,1.461-0.285c2.432,2.017,6.145,4.403,10.886,5.438C24.38,30.547,26.018,32,28,32c2.206,0,4-1.794,4-4S30.206,24,28,24z M2,4c0-1.103,0.897-2,2-2s2,0.897,2,2S5.103,6,4,6S2,5.103,2,4z M9.72,19.5c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2S9.72,20.604,9.72,19.5z M28,30c-1.103,0-2-0.897-2-2s0.897-2,2-2s2,0.897,2,2S29.103,30,28,30z"/>\n        <path d="M31.492,4.052c0.677-0.675,0.677-1.688,0-2.364l-1.181-1.182c-0.675-0.676-1.689-0.676-2.363,0L18.99,9.464l3.546,3.546 L31.492,4.052z"/>\n        <polygon points="17.676,10.695 17,15 21.306,14.325"/>\n\t</g>\n</svg>'),Sa=y('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="32px" height="32px" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve">\n\t<g stroke="#fff" fill="#fff">\n        <path d="M31,7H17V1c0-0.552-0.448-1-1-1H8C7.448,0,7,0.448,7,1v6H1C0.448,7,0,7.448,0,8v8c0,0.552,0.448,1,1,1h6v14c0,0.552,0.448,1,1,1h8c0.552,0,1-0.448,1-1V17h14c0.552,0,1-0.448,1-1V8C32,7.448,31.552,7,31,7z M2,15V9h5v6H2z M15,30H9v-3h2c0.552,0,1-0.448,1-1s-0.448-1-1-1H9v-3h2c0.552,0,1-0.448,1-1s-0.448-1-1-1H9v-3h2c0.552,0,1-0.448,1-1s-0.448-1-1-1H9v-3h2c0.552,0,1-0.448,1-1s-0.448-1-1-1H9V7h2c0.552,0,1-0.448,1-1s-0.448-1-1-1H9V2h6V30z M30,15h-3v-2c0-0.552-0.448-1-1-1s-1,0.448-1,1v2h-3v-2c0-0.552-0.448-1-1-1s-1,0.448-1,1v2h-3V9h13V15z"/>\n\t</g>\n</svg>'),La=y('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="32px" height="32px" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve">\n\t<g stroke="#fff" fill="#fff">\n\t\t<path d="M31.718,7.55l-15.5-7.5c-0.138-0.066-0.298-0.066-0.436,0l-15.5,7.5C0.11,7.634,0,7.809,0,8s0.11,0.366,0.282,0.45 l15.5,7.5C15.851,15.983,15.925,16,16,16s0.149-0.017,0.218-0.05l15.5-7.5C31.89,8.366,32,8.191,32,8S31.89,7.634,31.718,7.55z"/>\n\t\t<path d="M31.105,15.553l-4.211-2.105c-0.492-0.246-1.297-0.246-1.789,0l-8.211,4.105c-0.492,0.246-1.297,0.246-1.789,0 l-8.211-4.105c-0.492-0.246-1.297-0.246-1.789,0l-4.211,2.105c-0.492,0.246-0.492,0.648,0,0.895l14.211,7.105 c0.492,0.246,1.297,0.246,1.789,0l14.211-7.105C31.598,16.201,31.598,15.799,31.105,15.553z"/>\n\t\t<path d="M31.105,23.553l-4.211-2.105c-0.492-0.246-1.297-0.246-1.789,0l-8.211,4.105c-0.492,0.246-1.297,0.246-1.789,0 l-8.211-4.105c-0.492-0.246-1.297-0.246-1.789,0l-4.211,2.105c-0.492,0.246-0.492,0.648,0,0.895l14.211,7.105 c0.492,0.246,1.297,0.246,1.789,0l14.211-7.105C31.598,24.201,31.598,23.799,31.105,23.553z"/>\n\t</g>\n</svg>'),ja=y('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="32px" height="32px" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve">\n\t<g stroke="#fff" fill="#fff">\n\t\t<path d="M30,25c-0.552,0-1,0.448-1,1l0.002,4H19l0.002-10H23c0.552,0,1-0.448,1-1s-0.448-1-1-1h-3.998C17.898,18,17,18.897,17,20v10c0,1.103,0.898,2,2.002,2h10C30.104,32,31,31.103,31,30v-4C31,25.448,30.552,25,30,25z"/>\n\t\t<path d="M30,18h-3c-0.552,0-1,0.448-1,1s0.448,1,1,1h0.611l-4.32,4.345c-0.39,0.392-0.388,1.025,0.004,1.414c0.195,0.194,0.45,0.291,0.705,0.291c0.257,0,0.514-0.098,0.709-0.295L29,21.439V22c0,0.552,0.448,1,1,1s1-0.448,1-1v-3C31,18.448,30.552,18,30,18z"/>\n\t\t<path d="M27.996,0H4.004C2.348,0,1,1.348,1,3.004V21c0,0.021,0.011,0.04,0.013,0.062c0.005,0.091,0.023,0.179,0.053,0.265C1.077,21.357,1.085,21.39,1.1,21.42c0.048,0.104,0.108,0.2,0.191,0.283c0.001,0.002,0.002,0.004,0.003,0.005l7.999,7.998c0.092,0.093,0.202,0.166,0.324,0.217C9.738,29.973,9.868,30,10,30h5.031v-2H11v-7c0-0.553-0.448-1-1-1H3V3.004C3,2.45,3.45,2,4.004,2h23.992C28.549,2,29,2.45,29,3.004V16h2V3.004C31,1.348,29.652,0,27.996,0z M9,22v4.586L4.414,22H9z"/>\n\t</g>\n</svg>'),Ca=y('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="32px" height="32px" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve">\n\t<g stroke="#fff" fill="#fff">\n\t\t<path d="M24.004,18.004c-3.86,0-7,3.14-7,7s3.14,7,7,7s7-3.14,7-7S27.864,18.004,24.004,18.004z M24.004,30.004c-2.757,0-5-2.243-5-5s2.243-5,5-5s5,2.243,5,5S26.761,30.004,24.004,30.004z"/>\n\t\t<path d="M11,28v-7c0-0.553-0.448-1-1-1H3V3.004C3,2.45,3.45,2,4.004,2h23.992C28.549,2,29,2.45,29,3.004v14.52c0.756,0.506,1.429,1.125,2,1.831V3.004C31,1.348,29.652,0,27.996,0H4.004C2.348,0,1,1.348,1,3.004V21c0,0.021,0.011,0.04,0.013,0.062c0.005,0.091,0.023,0.179,0.053,0.265C1.077,21.357,1.085,21.39,1.1,21.42c0.048,0.104,0.108,0.2,0.191,0.283c0.001,0.002,0.002,0.004,0.003,0.005l7.999,7.998c0.092,0.093,0.202,0.166,0.324,0.217C9.738,29.973,9.868,30,10,30h6.523c-0.413-0.616-0.744-1.289-0.996-2H11z M9,26.586L4.414,22H9V26.586z"/>\n\t\t<path d="M27.004,23.979h-6c-0.552,0-1,0.448-1,1s0.448,1,1,1h6c0.552,0,1-0.448,1-1S27.556,23.979,27.004,23.979z"/>\n\t</g>\n</svg>'),ka=y('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="32px" height="32px" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve">\n\t<g stroke="#fff" fill="#fff">\n\t\t<path d="M31.564,15.194l-2.509-1.716l2.5-1.668C31.833,11.625,32,11.313,32,10.978c0-0.333-0.167-0.646-0.446-0.831L16.563,0.168c-0.335-0.224-0.772-0.225-1.108-0.001L0.446,10.146C0.167,10.332,0,10.645,0,10.978c0,0.335,0.167,0.647,0.445,0.833l2.511,1.673l-2.518,1.708c-0.276,0.188-0.44,0.5-0.438,0.832c0.002,0.335,0.169,0.645,0.447,0.828l15.009,10.149c0.167,0.11,0.36,0.166,0.553,0.166c0.192,0,0.386-0.056,0.553-0.166l14.991-10.149c0.277-0.184,0.444-0.493,0.447-0.825C32.002,15.692,31.839,15.382,31.564,15.194z M2.806,10.98l13.203-8.779l13.188,8.779l-13.188,8.797L2.806,10.98z M16.008,25.001L2.794,16.009l1.865-1.266c0.03-0.021,0.047-0.052,0.074-0.075l10.721,7.144c0.168,0.112,0.361,0.168,0.555,0.168s0.387-0.056,0.555-0.168l10.71-7.145c0.017,0.013,0.025,0.032,0.043,0.044l1.894,1.297L16.008,25.001z"/>\n\t\t<path d="M30.445,20.147l-14.437,9.854L1.555,20.147c-0.461-0.308-1.082-0.183-1.387,0.277c-0.307,0.46-0.182,1.081,0.277,1.387l15.009,10.021C15.623,31.943,15.816,32,16.009,32s0.387-0.057,0.555-0.168l14.991-10.021c0.459-0.308,0.583-0.929,0.277-1.387C31.525,19.965,30.905,19.84,30.445,20.147z"/>\n\t</g>\n</svg>'),Ia=y('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="32px" height="32px" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve">\n\t<g stroke="#fff" fill="#fff">\n\t\t<path d="M26.922,6.263c-1.482,0-2.807,0.651-3.736,1.669l-2.453-1.635c0.095-0.388,0.159-0.788,0.159-1.205c0-2.807-2.283-5.091-5.09-5.091c-2.812,0-5.099,2.284-5.099,5.091c0,1.413,0.578,2.692,1.508,3.617l-1.145,2.395c-0.235-0.033-0.469-0.072-0.712-0.072c-2.809,0-5.094,2.284-5.094,5.092c0,1.511,0.676,2.855,1.726,3.788l-0.964,2.023c-0.3-0.055-0.606-0.093-0.922-0.093c-2.812,0-5.099,2.278-5.099,5.079c0,2.804,2.287,5.084,5.099,5.084c2.813,0,5.102-2.28,5.102-5.084c0-1.409-0.581-2.685-1.515-3.605l1.033-2.168c0.21,0.027,0.417,0.064,0.634,0.064c2.813,0,5.102-2.282,5.102-5.088c0-1.486-0.652-2.813-1.673-3.745l1.09-2.28c0.302,0.056,0.611,0.094,0.93,0.094c1.305,0,2.484-0.509,3.387-1.321l2.72,1.813c-0.029,0.221-0.067,0.439-0.067,0.668c0,2.813,2.279,5.102,5.081,5.102c2.804,0,5.084-2.289,5.084-5.102C32.006,8.547,29.726,6.263,26.922,6.263z M5.1,29.006c-1.157,0-2.099-0.935-2.099-2.084c0-1.146,0.941-2.079,2.099-2.079c1.159,0,2.102,0.933,2.102,2.079C7.202,28.071,6.259,29.006,5.1,29.006z M10.354,18.213c-1.154,0-2.094-0.937-2.094-2.088c0-1.153,0.939-2.092,2.094-2.092c1.159,0,2.102,0.938,2.102,2.092C12.456,17.276,11.513,18.213,10.354,18.213z M15.802,7.194c-1.157,0-2.099-0.943-2.099-2.102c0-1.153,0.941-2.091,2.099-2.091c1.152,0,2.09,0.938,2.09,2.091c0,0.242-0.049,0.47-0.124,0.687c-0.066,0.067-0.128,0.141-0.183,0.222c-0.092,0.138-0.151,0.287-0.192,0.438C17.009,6.897,16.442,7.194,15.802,7.194z M26.922,13.457c-1.147,0-2.081-0.943-2.081-2.102c0-1.153,0.934-2.092,2.081-2.092c1.149,0,2.084,0.938,2.084,2.092C29.006,12.514,28.071,13.457,26.922,13.457z"/>\n\t</g>\n</svg>'),Ma={props:{drawPointImg:{type:String,default:Oa},drawLineImg:{type:String,default:wa},drawPolygonImg:{type:String,default:_a},modifyImg:{type:String,default:xa},measureDistanceImg:{type:String,default:Sa},layerManagerImg:{type:String,default:La},layerOpenImg:{type:String,default:ja},layerRemoveImg:{type:String,default:Ca},layerSettingImg:{type:String,default:ka},pathQueryImg:{type:String,default:Ia},undoIcon:{type:String,default:"fa-undo"},redoIcon:{type:String,default:"fa-repeat"},onSaveBefore:{type:Function,default:function(t){return!0}},contextData:{type:Array,default:function(){return[]}},stencilData:{type:Array,default:function(){return[]}},stencilCfg:{type:Array,default:function(){return[{title:"电站",children:[{name:"配电室",title:"electricity.PeiDianShi",type:"point",img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAACoUlEQVRIS+3WXYiVVRQG4Gebgoj5U+iFBoVCkheWvyOD4iQhoQUjZSqIJCSIGt2JIJRoBMpoPwhBSHllqFCTEUaJ0kVBqWMEKjj9oGkRQt6ZWfDJOucbPDNzzvlm5jDjzay775y997vW3u/7rpWUIpuMLbhV/h60eATvkn5OZOPwA87h90GDLB88DU9jYQC/gWdIiwcZND8++yQKDODVWElaM0TA+3B9GHgIbjurd9XZ2CoZ/Ev6797vvdY8RLpanHlN4OxBXMEY/I9RGIF/cArv4E9cQCRSuSa+Q5pHSe9XT6J+xc1oxxdYj6+xFB/jRazCSOzHl3gFJzAXf+FmnvALpL+7J1AXuORmv+XgTaRmsqdyk9mKdWhFrNmLB0jhB7FvO0KikfSTpOf7C3web2NTGbh06DEcxweYg29woDtwad1H+BXP4S3SZxXcKNJxVg34Q3xfPsyiOsCzy+9ceooFpA2NAp/FQcR1zs8JVqXiUtV/4GW0kWYNBHgbdiK8PA64k7M7qg9m1wL+Dq/jCOnh/gLvQpBpJn7BaHSS1pJNKgCO99+Dw6QJ/QUOckW1HbiIM6TPc6IVAf+ESHw36YmBAFewulIYhRWHsbyKJd07X7GOq7C6r8DZS9iYTzTtpJBXVz8ulNM1hG4fJ63obX+lig/l8qo0kCk4nZtPK2lGfw0k3vVkWa9dBtKt4vG4jB9zmww7nZfPbt+WhwvPkr7qI3AWDLwRU0Ium2WI6h4jRXMIjYZBRDOI5wjwkFp0tPDpSKgTO0iRQI+o3ySCzZWD36Ok13pk3oYwia5oQcxTHaRgdI0oJFftrY39Mwx8H8bbN9FCijY3BJF9GqSMuXpiLo2gfh+GtYZym47laEq5LqdiM243dGzx5nC190iX7gIi+Ckx+FbCVQAAAABJRU5ErkJggg=="},{name:"变电站",title:"electricity.BianDianZhan",type:"point",img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAD80lEQVRIS8WXXYhVVRTHf+fOGefBrh8oqFEjSsbkVVN8KEzIxNGZSGwgR+lBRfTBKRVD+yKyoCxEHHD8AEFRH0xHQaSYGRqd6MHUBzF1RmWKQJs+IKIwfTDPzJX/nbWHzel+9+CGy+Wcvfb+77XW/7/2OgGljSeBmcBkYLQt/Qv4CbgM9BW7XVCEYRJYDTQC04ALQC/wp60dAzwNPA90A63AAeBuvr0LAW8E3gO6bLOzBQ66wA45H9gG7Mplnwv4CWAfMAx4G7hSRGR8E6VjO3AfWJctBdmAFU6FS7+PYoBzAHkzAxhnc78D1ywq38XstV4p0k9pGBpxYHn6NbAX2O3ZvQpsAiYAp4GLnhdao/wuAX4FdpqNW/4m0AQs9D2PA38JXIp52gIsAt4HThYI+WvAZ0A7sMGzleezgcXunQ8sIr1sIG5e4Y6A10vM8VEgtBC7pYrkV45wDliS+cFAHZHkqaSSDbTaDqRNK4FbWQ4mcEluvc2JcB3AU5KaA5a3z3kgyqlYKX36YzlhuBKYQ0VFRWZioL+fNOeIoiPAsZi9nNns5fwL4Ly8dsDngA8Bp9NvAXns57SJMPw8SNUkg9QzUC1OAbf7SHffIH395l2i6B0jpsNXzuXxi/ZCOle+5wpYZVBUH2mTksyhmLfydH/wbCoZ1EpN/x3pzi7SV3r+IYrWmBSdkbxWlJzU7gBTBSymifJirsYHdogtQ9uHYXuQqqkL6mvzcizd3km652YHUVTvGe4A/gY+sXciWYuAlV8l3JHAFQ8X5olUhlcTSxtGDIU3F/ztPgZaT90hilSEfjYzhXspsMyeVR96Beyqk/tXfpUrXQYaj1NV1ZvY1DQ8r7s2OdC85x73/50C/GavRFoR1eX5Y1HykQLHQ30cOOExupow7E40NiRLCPV08b1QqLORa5Tpb3BtGLYFqZr6guRq65Ss2okiVUA3RC41C5965MroWILsicnpMKA8uVGKnNYCipobktMKKxx6NyQnPaiAbAXOmHU5BUQafjdWQMTmN4B5tq/0KJxMAdGIl0xdcQqR77XsGgnDVQS8QCIxWDL7B/ozB48iRcn3VLMFS+ZjwI9AHfC9HUZty9g8l8QDs9Mt5DTrRRjV5T+86zHrJaEFuj9fsQvbbVDutSjQhFc0tF/Wa9EB5WoEFAk1fYUaAeVUTV5JjYDAc7U+yvlbmSo22Pqoqrnw6pJxrc8vQHM5rY/Ai2n2VCDGW5jU7F21Zk93rT+KbvbcItfeVll76wgX2zfnY1ntrb+bCKcm7xtr6J3OcyFKp/rqeKncht7fWFJznzDqp/N9wijkUsLB//sJE/dMKZgFTMrx0SZyFTUeAokvNdkBIopQAAAAAElFTkSuQmCC"}]},{title:"站外",children:[{name:"柱上变压器",title:"electricity.ZhuShangBianYaQi(ZhuanYong)",type:"point",img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAADYklEQVRIS72WaUgUYRjHfzNtHpkJHRp2Y0URklKYgX0oyPpS2H0XoV1UakQUUaaVlSWZIR1EgWUQdlB2EEGtdEEnXWSRZGzZImvnfnBdj40n3yKhdmcc6YFhPrzz/n/P859nnnc02hA+mAQsUluLNbhoVkYzu0Ge90FBPgTXQs9d4NAg06xOW8Gr7kNqE9hGw2ENiv4HODQIpsyEDT7QSyGvocXqr2bgZiteDWwD7MCTFteJBSYD2cBOo3Az4B3AOGAZEAVcA0YAj4EY4CDwGlhlBG4UPAfYCCSpqxhIBfKBM8Ap4ClwByhRSfjlGwU/B9YBV4E3QH/AC3RS6p+BocAA4CzQO1DVRsAJwFH1LkXviPqGq4CBQAUtXX1IwcqBXSrJf/KNgMVSsXixUqkBugM60KTu94FEtb4HcAG7/VVtBCzDQayVew/gvYI1Au8AJ5AD3FSgzUBHIMsqeCGQDMxXQiOB60AIYAMk+U/qvdYD+4G3wD6r4GHAJdU4v7Qkkb5AnYJUKntl/ZFy55ZVsOyXhjkmNoeEhe1pam6O6R4d/c0WHBTicjiCNE2vqXO7peul+u3A8PboatEYK1V3sNlsk9Zk6HHJ48Xi3/Hy1m3O7853ez2eBmAJcK69wEmartuXFBXaogcN+qvmp+pqDi1f6WnweKYDl9sFHBoefi95aVpC/MQJfvWe2+1fy/ILPjR4vTK/LU+uIaFdwh+uP3s6LJCYrO+du8D13eVKAe5aba75gxNHFc7dltPVCPjczrzqZzfsMkQKrYIzE6emFExcsdwIl/ITJfXlx0tkalkeIGnDxiTlzsjaFGmEfHl/Ue2Di5ekYssjc3REVGTZmpLjMp8DxsGlK5w1VVVpwBWrVhMUGuKYk5PdZ0B8nF+ws7KSo5lr3Y319V0CZWjkkBCNRRGRkXkZxceidFur2dFK/0h6pru64pUcEn4bSzYZBf/8Unr06zdrdk5WdLdevVoBv9fWUro11/mhokIGh0yugGEGLGLrNV3fERMf5+wbGxuu6brP8eLFl8oHD/v4fL5cYEtAonrALFi2dQNSYFo6NAbDBTn+yoCPRqFmrf5D15cOT1LBGwwJB0CTM9hUtKVi+Z3eBxsioK4zFH4ELcMU1WRz/VnxPPUTL4lfAO2kWfAPTifsH2tqkEcAAAAASUVORK5CYII="},{name:"断路器",title:"electricity.DuanLuQi",type:"point",img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAzElEQVRIS+2XMQ7CMAxFXzdAXIDLwD2YYGDiEvQKCCYWJu4Bl+ECDIzIyJEslFCSSgQhd2lVJX7+rmP9NpRdU+CsW2fAJTdMk7tB11cDC/+oSSxKki9VLKyNAsM9i//z4DmwB+5G1lifb+bdAFgDpy75nypeAjtg1BUQaM1nSC7PAW+BoPId38HR6nipU00jXe3NlaqOHyc/Ts8K+ADxARIqICNTHMjw20ZAvPMBsDZnoklcX+zQynju3g4kFuC/XWZMcRVDX+0Xpjf4AWKwOh8sXrtNAAAAAElFTkSuQmCC"}]},{title:"线路",children:[{name:"电缆",title:"electricity.DianLan",type:"line",img:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAiIGhlaWdodD0iMzAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6c3ZnPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiA8Zz4KICA8dGl0bGU+TGF5ZXIgMTwvdGl0bGU+CiAgPGxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlLXdpZHRoPSI1IiB4MT0iMiIgeTE9IjIiIHgyPSIyOCIgeTI9IjI4IiBpZD0ic3ZnXzEiIHN0cm9rZT0iIzAwMDBmZiIvPgogPC9nPgo8L3N2Zz4="},{name:"电缆通道",title:"electricity.DianLanTongDao",type:"line",img:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAuMDAwMDAwMDAwMDAwMDA0IiBoZWlnaHQ9IjMwLjAwMDAwMDAwMDAwMDAwNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KIDxnPgogIDx0aXRsZT5MYXllciAxPC90aXRsZT4KICA8bGluZSBmaWxsPSJub25lIiBzdHJva2Utd2lkdGg9IjE1IiBzdHJva2UtZGFzaGFycmF5PSJudWxsIiBzdHJva2UtbGluZWpvaW49Im51bGwiIHN0cm9rZS1saW5lY2FwPSJudWxsIiB4MT0iMiIgeTE9IjIiIHgyPSIyOCIgeTI9IjI4IiBpZD0ic3ZnXzEyIiBzdHJva2U9IiMwMDdmMDAiLz4KICA8bGluZSBmaWxsPSJub25lIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1kYXNoYXJyYXk9Im51bGwiIHN0cm9rZS1saW5lam9pbj0ibnVsbCIgc3Ryb2tlLWxpbmVjYXA9Im51bGwiIHgxPSIyIiB5MT0iMiIgeDI9IjI4IiB5Mj0iMjgiIHN0cm9rZT0iI2ZmZmZmZiIgaWQ9InN2Z18xNCIvPgogIDxsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgc3Ryb2tlPSIjMDA3ZjAwIiBzdHJva2UtZGFzaGFycmF5PSIyLDIiIHN0cm9rZS1saW5lam9pbj0ibnVsbCIgc3Ryb2tlLWxpbmVjYXA9Im51bGwiIHgxPSIyIiB5MT0iMiIgeDI9IjI4IiB5Mj0iMjgiIGlkPSJzdmdfMTUiLz4KIDwvZz4KPC9zdmc+"},{name:"光纤",title:"electricity.GuangXian",type:"line",img:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAiIGhlaWdodD0iMzAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6c3ZnPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiA8Zz4KICA8dGl0bGU+TGF5ZXIgMTwvdGl0bGU+CiAgPGxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxMCIgeDE9IjIiIHkxPSIyIiB4Mj0iMjgiIHkyPSIyOCIgaWQ9InN2Z18xIiBzdHJva2U9IiMwMDdmMDAiLz4KIDwvZz4KPC9zdmc+"}]}]}},barPosition:{type:String,default:null},barTarget:{type:String,default:null}},data:function(){return{initCenter:[114.52901,38.035125],colors:[{color:"red",title:"红色"},{color:"green",title:"绿色"}],icon:"electricity.BianDianZhan",lineStyle:{stroke:{color:"rgb(255,0,0)",width:1}},layers:[],currentEditLayer:null,editbarVisible:!1,currentEditFeature:null,stencilShow:!1}},created:function(){this.initSymbols()},mounted:function(){var t=this;this.$nextTick((function(){t.$refs.selected.mapObject.setActive(!0)}))},methods:{_modifyToggle:function(t){var e=this.currentEditLayer.getSource();!t&&this.$refs.modify.clear(),t&&this.$refs.modify.addFeatures(e.getFeatures())},_handlerStarEdit:function(t){this.currentEditLayer=t,this.editbarVisible=!0,this.stencilShow=!0,this.$emit("startedit",t)},_handlerStopEdit:function(t){var e=this;if(e.currentEditLayer&&!0===e.currentEditLayer.get("isTemp"))return e._giveupSave(),void t(!0);this.$confirm("是否保存当前编辑图层","保存图层",{distinguishCancelAndClose:!0,confirmButtonText:"保存",cancelButtonText:"放弃修改"}).then((function(){e._handlerSaveClick(),e.$refs.save._handlerClick(),e.editbarVisible=!1,e.$refs.editbar.mapObject.deactivateControls(),e.$refs.undoredo.clear(),e.currentEditLayer=null,e.stencilShow=!1,t(!0),e.$emit("stopedit")})).catch((function(n){n instanceof ReferenceError?console.error(n.stack):"cancel"===n?(e._giveupSave(),t(!0)):(t(!1),console.log("取消停止编辑"))}))},_giveupSave:function(){this.editbarVisible=!1,this.$refs.editbar.mapObject.deactivateControls(),this.$refs.undoredo.clear(),this.$refs.selected.mapObject.setActive(!0),this.currentEditLayer=null,this.stencilShow=!1},_handlerDelete:function(){var t=this.$refs.selected.getFeatures().getArray();Array.isArray(t)||(t=[t]);for(var e=t.length-1;e>=0;e--)this.currentEditLayer.getSource().removeFeature(t[e]);this.$refs.selected.clear(),this.$emit("featureDelete",t)},_handlerCopy:function(){var t=this.currentEditLayer.getSource();this.$refs.copypaste.setDestination(t),this.$refs.copypaste.setSources(t)},_onToggleSource:function(t,e){if(t){var n=this.currentEditLayer.getSource();this.$refs[e].setSource(n)}},_selectIcon:function(t,e){this.icon=e,e?this.$refs.drawPoint.setSketchPointStyle({image:{"svg-symbol":{symbolType:e,stroke:{color:"rgb(0,0,255)",width:1}}}}):this.$refs.drawPoint.setSketchPointStyle(null)},_selectLineStyle:function(t,e){switch(e){case"electricity.DianLan":this.lineStyle={stroke:{color:"rgb(0,0,255)",width:2}};break;case"electricity.GuangXian":this.lineStyle={stroke:{color:"rgb(0,255,0)",width:4}};break;case"electricity.DianLanTongDao":this.lineStyle={stroke:[{color:"rgb(0,255,0)",width:20,lineCap:"round"},{color:"rgb(255,255,255)",width:6},{color:"rgb(0,255,0)",width:2,lineDash:[5,5],lineJoin:"square"}]};break;case"linedash":this.lineStyle={stroke:{color:"rgb(255,0,0)",width:2,lineDash:[5,5]}};break;default:this.lineStyle={stroke:{color:"rgb(255,0,0)",width:2}}}},_selectFilter:function(t,e){return null!=this.currentEditLayer&&null!=e?this.currentEditLayer==e:null!=e},_handlerSaveClick:function(){var t=this.currentEditLayer.getSource();this.$refs.save.setSource(t,this.currentEditLayer)},_onSaveBefore:function(t){return this.onSaveBefore(t)},_transformFilter:function(t,e){return"Polygon"===t.getGeometry().getType()},_selectToggleHandler:function(t){this.$refs.translate.mapObject.setActive(t)},_handlerSelect:function(t){this.$emit("select")},_removeLastPointHandler:function(){this.$refs.drawLineString.mapObject.removeLastPoint()},_finishDrawingHandler:function(){this.$refs.drawLineString.mapObject.finishDrawing()},_importReadEnd:function(t){var e=this;t&&("FeatureCollection"===t.type?ye.a.forEach(this.layers,(function(n){n.layerId==e.currentEditLayer.values_.layerId&&(n.features=t.features)})):this.features=t)},_handleUndoClick:function(t){this.$refs.undoredo.undo()},_handleRedoClick:function(t){this.$refs.undoredo.redo()},clearUndoOrRedo:function(){this.$refs.undoredo.clear()},initSymbols:function(){var t=this;return Object(Z.a)(regeneratorRuntime.mark((function e(){var n,i,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,i={},e.next=4,tt().then((function(t){return t.data})).catch((function(t){console.log(t.message)}));case 4:r=e.sent,ye.a.forEach(r,(function(t){var e={};t.TYPEID.indexOf("electricity")>-1&&(e.svg=t.THUMB_SVG,e.symbolName=t.SYMBOLNAME,i[t.TYPEID]=e)})),n.$SvgSymbol.addDefs(i);case 7:case"end":return e.stop()}}),e)})))()}}},Ta=(n(1284),Object(Dt.a)(Ma,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("OLMap",{ref:"map",attrs:{center:t.initCenter,zoomLevel:13,zoom:!1,fitp:!0,scaleLine:!0}},[n("AMapTileLayer"),t._v(" "),t._l(t.layers,(function(t,e){return n("OLVectorLayer",{key:e,attrs:{silentSvg:!1,title:t.layerName,layerName:t.layerName,layerId:t.layerId,guid_:t.guid_,layerType:t.layerType}},[n("OLGeoJsonSource",{attrs:{features:t.features}})],1)})),t._v(" "),n("OLTranslate",{ref:"translate"}),t._v(" "),n("OLCopyPaste",{ref:"copypaste",on:{copy:t._handlerCopy}}),t._v(" "),n("OLZoomLevel"),t._v(" "),n("OLSelect",{ref:"selected",attrs:{filter:t._selectFilter},on:{select:t._handlerSelect}}),t._v(" "),n("OLBar",{attrs:{position:t.barPosition,target:t.barTarget}},[n("OLToggle",{attrs:{title:"图层管理",img:t.layerManagerImg}},[n("OLBar",[n("OLButtonCreateLayer",{attrs:{layers:t.layers}}),t._v(" "),n("OLButtonOpenLayers",{attrs:{img:t.layerOpenImg,layers:t.layers}})],1)],1),t._v(" "),n("OLToggle",{ref:"measure",attrs:{title:"测距",img:t.measureDistanceImg}},[n("OLMeasure")],1),t._v(" "),n("OLToggle",{ref:"topo",attrs:{title:"拓扑分析",img:t.pathQueryImg}},[n("OLBar",[n("OLTopoAnaly")],1)],1),t._v(" "),n("OLButtonStartOrStopEdit",{ref:"btnEdit",attrs:{currentLayer:t.currentEditLayer},on:{start:t._handlerStarEdit,stop:t._handlerStopEdit}}),t._v(" "),n("OLButtonExport",{attrs:{dxfIcon:"/images/Audition.png",currentLayer:t.currentEditLayer,layers:t.layers}}),t._v(" "),n("OLBar",{ref:"editbar",attrs:{toggleOne:!0,visible:t.editbarVisible}},[n("OLButtonZoomEdit",{attrs:{img:t.layerManagerImg,currentFeature:t.currentEditFeature,currentLayer:t.currentEditLayer}}),t._v(" "),n("OLToggle",{attrs:{title:"选中图形",icon:"fa-mouse-pointer"},on:{onToggle:t._selectToggleHandler}},[n("OLBar",[n("OLButton",{attrs:{icon:"fa-trash-o",title:"删除选中"},on:{onClick:t._handlerDelete}}),t._v(" "),n("OLToggleFillAttribute",{attrs:{icon:"fa fa-paint-brush",colors:t.colors}})],1)],1),t._v(" "),n("OLToggle",{attrs:{img:t.modifyImg,title:"修改顶点"},on:{onToggle:t._modifyToggle}},[n("OLModify",{ref:"modify"})],1),t._v(" "),n("OLToggle",{attrs:{title:"变换",icon:"fa-retweet"}},[n("OLTransform",{ref:"transform",attrs:{filter:t._transformFilter}})],1),t._v(" "),n("OLToggle",{attrs:{icon:"fa-angle-double-right",title:"偏移"},on:{onToggle:function(e){return t._onToggleSource(e,"offset")}}},[n("OLOffset",{ref:"offset",attrs:{duplicate:!0}})],1),t._v(" "),n("OLButton",{attrs:{title:"撤销",icon:t.undoIcon},on:{onClick:t._handleUndoClick}}),t._v(" "),n("OLButton",{attrs:{title:"重做",icon:t.redoIcon},on:{onClick:t._handleRedoClick}}),t._v(" "),t.editbarVisible?n("OLUndoRedo",{ref:"undoredo"}):t._e(),t._v(" "),n("OLButtonSave",{ref:"save",attrs:{saveBefore:t._onSaveBefore},on:{onClick:t._handlerSaveClick}}),t._v(" "),n("OLButtonImport",{attrs:{icon:"fa-upload",title:"导入数据"},on:{readend:t._importReadEnd}})],1)],1),t._v(" "),n("OLContextMenu",{attrs:{menus:t.contextData}}),t._v(" "),n("OLOverview",[n("BMapTileLayer")],1),t._v(" "),n("OLLayerSwitcher",{attrs:{info:!0}}),t._v(" "),n("OLStencil",{ref:"stencil",attrs:{visiable:t.stencilShow,stencilLayer:t.currentEditLayer}})],2)}),[],!1,null,null,null).exports),Aa={OLMap:zt,OLTileLayer:le,GoogleTileLayer:Kt,AMapTileLayer:Qt,BMapTileLayer:se,OLVectorLayer:ve,OLHeatmapLayer:_e,OLVectorSource:Pe,OLGeoJsonSource:Fe,OLFeature:$e,OLSearchFeature:dn,OLButton:gn,OLTextButton:vn,OLToggle:wn,OLToggleSnap:Ln,OLBar:kn,OLLayerSwitcher:An,OLLegend:Pn,OLLegendItem:Dn,OLOverview:zn,OLOverlay:Rn,OLBarUndoRedo:or,OLToggleFillAttribute:lr,OLButtonSave:ur,OLButtonExport:vr,OLButtonStartOrStopEdit:Cr,OLButtonImport:Ir,OLButtonCreateLayer:Br,OLButtonOpenLayers:Zr,OLZoomLevel:Jr,OLContextMenu:Xr,OLStencil:Qr,OLButtonZoomEdit:aa,OLTopoAnaly:sa,OLSelect:Xn,OLMeasure:ti,OLDraw:vi,OLModify:_i,OLTranslate:Li,OLSnap:Ci,OLOffset:Ti,OLTransform:Fi,OLCopyPaste:Di,OLFocusMap:zi,OLDistanceSearch:Yi,OLUndoRedo:qi,OLFillAttribute:er,OLDelete:rr,OLPopup:pa,OLPopupFeature:fa,OLPlacemark:ya,OLMapShowView:va,OLMapEditView:Ta,OLReadFile:tn},Ea=function t(e){t.installed||(Object.keys(Aa).forEach((function(t){e.component(t,Aa[t])})),e.prototype.$SvgSymbol=gt,e.prototype.$FontSymbol=bt,e.prototype.$Read=Ke,e.prototype.$GeoJSON2Svg=ln,e.prototype.$svg2base64=y)};"undefined"!=typeof window&&window.Vue&&Ea(window.Vue);e.default=Object(i.a)({version:"4.3.0",install:Ea},Aa)},591:function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_filter__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(24),core_js_modules_es_array_filter__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_filter__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(117),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(118),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_2__),ol_Overlay__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(732),ol_source_Vector__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(425),jquery__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(1277),jquery__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_5__);__webpack_exports__.a={name:"OLContextMenu",props:{menus:{type:Array,default:function(){return[]}}},data:function(){return{menuData:this.menus,events:{},features:[],curCoordinate:[]}},mounted:function(){this.$nextTick((function(){this.initContext(),this.registerEvents()}))},methods:{initContext:function(){var t=this,e=this.$parent.mapObject,n=new ol_Overlay__WEBPACK_IMPORTED_MODULE_3__.a({element:document.getElementsByClassName("ol-context-menu")[0],positioning:"center-center"});n.setMap(e),jquery__WEBPACK_IMPORTED_MODULE_5___default()(e.getViewport()).on("contextmenu",(function(i){var r=e.getEventPixel(i.originalEvent),a=e.getEventCoordinate(i.originalEvent);t.curCoordinate=a,i.preventDefault(),n.setPosition(a);var o=e.forEachFeatureAtPixel(r,(function(t,e){return t}));t.features=o,t.$el.style.display="block"})),jquery__WEBPACK_IMPORTED_MODULE_5___default()(e.getViewport()).on("click",(function(t){t.preventDefault(),n.setPosition(void 0)})),this.$el.addEventListener("click",(function(e){t.handleMenuItemClick(e),this.style.display="none"}))},registerEvents:function registerEvents(){var _this=this;this.menuData&&_this.menuData.forEach((function(item){item&&item.onClick&&(_this.events[item.id]="string"==typeof item.onClick?eval("("+item.onClick+")"):item.onClick)}))},handleMenuItemClick:function(t){var e=t.target.getAttribute("data-id"),n=this.getLayer(),i=this.events[e];i&&"function"==typeof i&&i.call(this,t,this.features,n)},getLayer:function(){var t,e=this;return this.$parent.mapObject.getLayers().forEach((function(n){n.getSource()instanceof ol_source_Vector__WEBPACK_IMPORTED_MODULE_4__.a&&(_.filter(n.getSource().getFeatures(),(function(t){if(e.features&&e.features.id_)return e.features.id_==t.id_})).length>0&&(t=n))})),t}}}},703:function(t,e,n){},709:function(t,e,n){},710:function(t,e,n){},711:function(t,e,n){},712:function(t,e,n){},713:function(t,e,n){},714:function(t,e,n){},715:function(t,e,n){},717:function(t,e,n){},718:function(t,e,n){},719:function(t,e,n){},720:function(t,e,n){},721:function(t,e,n){}}]);